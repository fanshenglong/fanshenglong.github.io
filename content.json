{"pages":[{"title":"","text":"ä¸ªäººç®€ä»‹ è¯•ç€ç‚¹å‡»â€œæ˜¾ç¤ºä¸€è¨€â€ â€”å‡ºè‡ªã€Šxxxã€‹ function showHitokoto (event) { // event.target.classList.add('is-loading'); $.ajax({ type: 'GET', url: 'https://v1.hitokoto.cn/', success: function (data) { $('.hitokoto').text(data.hitokoto); $('.hitokotoFrom').text(data.from); // event.target.classList.remove('is-loading'); } }); } showHitokoto(); ä¸ªäººä¿¡æ¯ è½¯ä»¶å·¥ç¨‹ä¸“ä¸š ä»äº‹JAVAåç«¯å¼€å‘ ç ç•œä¸€æš çƒ­çˆ±ç”Ÿæ´» åšä¸ªå¥½äºº åšå®¢ä¿¡æ¯ ç½‘ç«™ç”±Hexoæ­å»ºï¼Œé‡‡ç”¨çš„Icarusä¸»é¢˜ å’ŒAmazingä¸»é¢˜ è¿½æ±‚å°½å¯èƒ½çš„ç®€æ´ï¼Œæ¸…æ™°ï¼Œæ˜“ç”¨ã€‚ è®°å½•å·¥ä½œç”Ÿæ´»ä¸­çš„ç‚¹æ»´äº‹ã€‚ æ—¶é—´è½´è®°å½•","link":"/about/index.html"},{"title":"","text":"å”è‰ºæ˜• ææ² æä¸€æ¡ gakki å›¾ç‰‡æœé›†äºäº’è”ç½‘ï¼Œä¾µæƒè¯·ç•™è¨€ï¼Œé©¬ä¸Šå¤„ç†ğŸ˜Šã€‚","link":"/album/index.html"},{"title":"å¤§ä½¬ä»¬","text":"ç”³è¯·å‹é“¾é¡»çŸ¥ åŸåˆ™ä¸Šåªå’ŒæŠ€æœ¯ç±»åšå®¢äº¤æ¢ï¼Œä½†ä¸åŒ…æ‹¬å«æœ‰å’Œè‰²æƒ…ã€æš´åŠ›ã€æ”¿æ²»æ•æ„Ÿçš„ç½‘ç«™ã€‚ ä¸å’Œå‰½çªƒã€ä¾µæƒã€æ— è¯šä¿¡çš„ç½‘ç«™äº¤æ¢ï¼Œä¼˜å…ˆå’Œå…·æœ‰åŸåˆ›ä½œå“çš„ç½‘ç«™äº¤æ¢ã€‚ ç”³è¯·è¯·æä¾›ï¼šç«™ç‚¹åç§°ã€ç«™ç‚¹é“¾æ¥ã€ç«™ç‚¹æè¿°ã€logoæˆ–å¤´åƒï¼ˆä¸è¦è®¾ç½®é˜²ç›—é“¾ï¼‰ã€‚ æ’åä¸åˆ†å…ˆåï¼Œåˆ·æ–°åé‡æ’ï¼Œæ›´æ–°ä¿¡æ¯åè¯·ç•™è¨€å‘ŠçŸ¥ã€‚ ä¼šå®šæœŸæ¸…ç†å¾ˆä¹…å¾ˆä¹…ä¸æ›´æ–°çš„ã€ä¸ç¬¦åˆè¦æ±‚çš„å‹é“¾ï¼Œä¸å†å¦è¡Œé€šçŸ¥ã€‚ æœ¬ç«™ä¸å­˜å‚¨å‹é“¾å›¾ç‰‡ï¼Œå¦‚æœå‹é“¾å›¾ç‰‡æ¢äº†æ— æ³•æ›´æ–°ã€‚å›¾ç‰‡è£‚äº†çš„ä¼šæ›¿æ¢æˆé»˜è®¤å›¾ï¼Œéœ€è¦æ›´æ¢çš„è¯·ç•™è¨€å‘ŠçŸ¥ã€‚ æœ¬ç«™å‹é“¾ä¿¡æ¯å¦‚ä¸‹ï¼Œç”³è¯·å‹é“¾å‰è¯·å…ˆæ·»åŠ æœ¬ç«™ä¿¡æ¯ï¼š urlï¼šç½‘å€åœ°å€ avatarï¼šå¤´åƒå›¾ç‰‡é“¾æ¥ nameï¼šæ˜µç§° blogï¼šç½‘å€åç§° descï¼šä¸€å¥è¯æè¿°ï¼Œæè¿°ä¸€ä¸‹ è‡ªå·± æˆ–è€… ç«™ç‚¹ æˆ–è€… å–œæ¬¢çš„è¯(å¤ªé•¿ä¼šå±•ç¤ºä¸å…¨) colorï¼šæ ·å¼é¢œè‰²,é»˜è®¤ç°è‰²() ç‚¹å‡»å±•å¼€ä»£ç  >folded12345678{ \"url\": \"https://fanshenglong.github.io\", \"avatar\": \"https://fanshenglong.github.io/images/avatar.jpg\", \"name\": \"fanshenglong\", \"blog\": \"fansl\", \"desc\": \"çƒ­çˆ±ç”Ÿæ´»ï¼Œçƒ­çˆ±å¼€æºã€‚\", \"color\": \"#66CCFF\"}","link":"/friend/index.html"},{"title":"","text":"&nbsp;&nbsp;å¬å¬éŸ³ä¹ éŸ³ä¹æ’­æ”¾å™¨ç”±mePlayeræä¾›ï¼Œå¸ƒå±€å‚ç…§ç½‘å‹åšå®¢æ‰€ä½œï¼Œæ„Ÿè°¢ä½œè€…çš„è¾›å‹¤ä»˜å‡ºã€‚æ›´å¤šéŸ³ä¹åˆ†äº«è¯·æŸ¥çœ‹æ­Œå•ã€‚ &nbsp;&nbsp;çœ‹çœ‹è§†é¢‘ ->ç‚¹å‡»ä»¥ä¸‹æ¡ç›®å¼€å§‹æ’­æ”¾è§†é¢‘,å‘ä¸‹æ»‘åŠ¨æŸ¥çœ‹æ›´å¤š","link":"/media/index.html"},{"title":"","text":"æ¥è€Œä¸å¾€éç¤¼ä¹Ÿç•…æ‰€æ¬²è¨€ï¼Œæœ‰ç•™å¿…åº”","link":"/message/index.html"},{"title":"éŸ³ä¹æ­Œå•æ”¶è—","text":"--- æ¸©é¦¨æç¤ºï¼šé€‰æ‹©å–œæ¬¢çš„éŸ³ä¹åŒå‡»æ’­æ”¾ï¼Œç”±äºç‰ˆæƒåŸå› éƒ¨åˆ†ä¸èƒ½æ’­æ”¾ã€‚å¦‚æœå–œæ¬¢æ­Œå•æ”¶è—ä¸€ä¸‹ï¼Œå»ç½‘æ˜“äº‘éƒ½èƒ½æ’­æ”¾å“Ÿï¼","link":"/music/index.html"},{"title":"","text":"ç¢ç¢å¿µ tipsï¼šgithubç™»å½•åæŒ‰æ—¶é—´æ­£åºæŸ¥çœ‹ã€å¯ç‚¹èµåŠ â¤ï¸ã€æœ¬æ’ä»¶åœ°å€..ã€Œ+99æ¬¡æŸ¥çœ‹ã€ ç¢ç¢å¿µåŠ è½½ä¸­ï¼Œè¯·ç¨ç­‰... $.getScript(\"/js/gitalk_self.min.js\", function () { var gitalk = new Gitalk({ clientID: '547655d4ccec493dad48', clientSecret: '92207d66ca2ea4fb5b99d571c84da708f894f88a', id: '666666', repo: 'issue_database', owner: 'fansl', admin: \"fansl\", createIssueManually: true, distractionFreeMode: false }); gitalk.render('comment-container1'); });","link":"/self-talking/index.html"}],"posts":[{"title":"Hello World","text":"å—¨ï¼Œè¯·å‡†ç¡®æ— è¯¯åœ°è¾“å…¥å¯†ç æŸ¥çœ‹å“Ÿï¼ 04b96cf03f1b5d00286d72390b6bf2e0817acbfddb7147d2fcc01912c7f5c0f9713c9c317ba53b9347fde83c930f8c77af411014f8ec84eef7465f6027f6e563b20763efbf9fac1db105face649d36b82b8e5a28894e0322accb07eba0f38491487fddc38b18732e21e4d5a09a208486db90f1b471e152ae582639c98996b3d9545b516ad74403d379a378e897878b9754f5f3c9a9c1cbf034ea3b155b6217c7c2a8ce65fc5458e94d70325ea68e520f7a7ed29b19c24e71d2dd5a163ab5e832849afad0abe9784c4fd18fabc279182b8af54ef67d705222ff90b349331f6dd1ec831f38c55784c3eaa91ce5b4a0c9a95b4266599f6a585f00bc84ead7b4ed5b194183eed780bf7bd818d1b408ce1a9de0ba8e623484f02131805386fc2dca0f711b3acda6b8fbaad70f40297fc2d61765dad86de7eaffc25a2889a43a69ef1f5d3dee32f35783a2d780ea5da52762675e3325a5f4dee82541127c686d47ee2db59fb8f0bdd90eb21e8e80147bcc58ffd18c21aad8210a07aa3c89d3a683b406eda3bbb7f23d4ecc20c5e3557e7bdbdb4c398a4eabadacdb463d11127cbacc66973021d5a393ecddf0ab48fbb7cb3af1ebd14e512a18c8efbf5078725aa46959ea4d882da1cb78000b82049e77ad1f0e8e47e534b89d6fad32e797355b63d8792c9a012fba49f5841eeb51dffe4a18be880def829c7c16c7efb2f11c92432dbcf9de755b3574c9cd7b09adcb8beabcfa36e020181ef874b2632803752f1b7b158bfaafba643fec8139a7cae21de737609954146f954d48832d3fdef43f535ad52ffe6fb894a3dd9a3e89ef3ab0b46ec11c6f4bfc3e37cc7ba4ebe06d244906e98518c2fae0546905a5e71fae3b47d55f731a58aa2a7573e8b128f0bb4916136f8d4dac285cdc82b004ab2bfd2fe070e51f3e698e9951d6fcf4cd86c3dc85b2cf7be0086a0193eb79b4aa7902b43368e32091c9ac3176f16e8974f17ed3c48279ab1e906ad9a799fc2e345f6560b1677d71db74dabce987f7d652b6d0a8c1f8a355c1372946957b8392ca9a471addf7d9a13863e840952bb0d0f59200852c2432214c430362e370220bdb95d0c33112b640ee82574e2cac5079d1190ccd43c0e9e630d73c233ccbeb05d4fd12ff9b878355345b3e9fc5d20a13ae82e4f9f2c7379704891124911f5962d2a2d5822406fcb4dc9014c7a73df34b38a07418d129cb0ce0996ce4450aa11ceb7c1cdab744f419a9fac0a7cddcd33531fefeb5b507be19923eccfa136a9c071e149f88069d33f5e1a19e1585d165c108bd383322a02ca8e9306f724dbfc7a68de47e7e456839f31d8c4c66fe56a4e972406a6d4be47c41ee93a43af54fb2f83f6a63066ee05189d5c305fd11616da3a1f9263cc412ce52a13043d124a09690f182bc041f5be34c9bdde5d942d32f9556b4dedff5f4a706932c979358cdfdc12fdadb332fafd94b7a063548b8537da2fca391b4d7b756e5d67d50c7e775655f21a7d9ee2ee72945be50458b000d4bf8c25546e78907f46881dc9c3624da70a59a04b30c8f68fedeb5c429970234b4b8b48b854b779ff3815eda7c31ce31cfa2e32130f3314a1326c223c15e3a828e45a9ae109e39f07fa5dd32c6511931a9c482587c5c673ca33e8af79532d23f14eb0f78655c4f7aab54764c0488e4758efd6f64a64dadffc4c33a4a2321358b23f859830e57d4460e37f8da1c8cd0f7516a268a871473cd0376045ed07f6b5a016bac5f5a6c567bf35d1de4b82ae89d18153e95eb3b07215e13f4f84b6493bb27ccdf627e0d82a8d6d51e5c01217d16c3c94ff9099c37498940138dc45168515cc975004c86ce5fed210a0017e121fab3a21f6daf71f3d5455821d03c7615f7af620c9824ce3c4dc9b50c97fb48f9332b3fbdae0d5a21d0b11e6c024ed452d3e320bb725202d1129855da710174e52e81c0c0f40d63bc1f9f2e0e389fe41cbdf577caf8a0c8d0400606172e50431ce5e71a5a735580001f00f42ae68d3e4f043f3b3bea34d893e4d0278c1612fcd8cc633d28769b776822921b20c7aa2b4eaa14f4b79f8254019b5f29781630fdbad4fe228ce80b352a758c56d60a7f38d28fc1869971ef07145f6832cdb9bf5f96f21357133eccb54a2c3f451afa4d255c797d87f8929b26dc53e42b5e3f5307e602acc878d3bc05a783aae624b64bc39407d08a56ad1d5caa58a7dc489e7a7b35a3243f4beedb1879e0c0d10ebda5a3c4b47660f1de349862d5e3f52060c45cf90535987b8397389cd7d145b992642c4b566375542c7857fa5235d73913bfafdd9bdc14a825b3259d1d6f3cb00990da35abdf9cb056f756e2fedfe2d23f35cc65e24438ed8d7c5ea440e5d034229b2a3395e28de7cc1a24c68454d0d235d36a0b564d99172e95b714335564c7e6c03a0a2f2fa420dfa2ab8c65d5fedee2d06e138a35320dc5f6040dfabafeb06671dc0c0e21634486ff9b4b277eae8208068e21092cde276bb2ec2de3a3d28adb23758996e58bfc7e8aff215f7425202dc8dc0211390e6bc139dee1ce2a68cfb7e150263a58000fbb6eb66bb6809f63cc179e6ed1b8c70262ba950bf5f837aa868e1b72dfdcc561225ea155c76d267f99afe8947ec32ddd683cb068c578c97b323e9036660e0057367e217cabc735d0d72ac7f621b79d0501d02cd8704c92f3a8bef0c5876be9f6b9187a4baeead75161b57bca18e3ad5ff722c7fe245ae907b95a3b5675b9b54b8a1ab307ff1e348ed039b8ba5a2f3dae2d1693d5bc3fdbc4d8bc72793402de10dba195e1d876aa5dbacff40518bf64228184fe2e452488fefbf7c0ebacaec1abdb662f02baf07dfbf6d0dc245c8b9487975337722106351141b055e5771711e1a0d65d96965f9f22d25ae1cf32f58867a49d8fbb065ad3c683a16e38c397b7ec1a3b7053f316c2ac0b4cc60af525469acc19b64e9715cd33ff97407e35c55f470233a2dcd6cd5e866c0b9ab498c10afd3c088b3785e5c33d1d3942d974b2963969d15d5c7526aa634d2cdf8ab75e5d894034e3e2b56b96eec10a693ec56ffa8711cc1853e853057019690eb8f2a8bd9dbc5ef3f43b1958982127215885bcba701972691251737d7344f2901222aaed7a409eb0d6c9bca05c6691c9580dcc92795349cf8d93c2ffdef490c83d5d084ee520d32e02c9d4263842b884434c612cb754b5b1340ad4149720ce392c32fb044047b828fa5e792df64a7d3715a27242e432e1d6b18905ec1a89ce3706e4c8094b041b77fbb29530d96c2b65f8541bb7b2b971864d88d8c044dbba12470d0dd726ce276b951b8056da273c08e125fb04de997306fe79b129d9def2a16e7434f39eef0eb355da2ac0c50651fad8edf7ae63c7d5fd9001e655ba1fdcc4711faceadf6c24e9585eeb3485b28b3da029799bc7cedf790516255c083f53305a54c5c6a134c7b84a124c89c3c8ef9fc513d3e2a21ee6207fbd560b6088865a699b688b539ce3c020bdf03d9b585f697695bd0b94f1a3e2ba531a3dd41353a7a3667d036e5dc243f78831df21a5a69d9ff987a7591cb64ccd52469a8e09a73acbbb63d00a9f55477473f92c18914ad2ed2de933dc558cd3b3621f8df4f9e1332a89f9173e98e8903492a807aff44e2d9d45fa181b95e09b5f9bd00650db7ee982eb76bda4c556302cad1356d8a3fe604946b2c9929d14fb43eec79e4294fcc2afb800f1fb98f86e26b8eca0aca51bee18024afc608a3d7d54d393b01acb4a75837c54cc9141f7662186a9e75e012cafaca26a50e2c6e0f6cf4ed724c215e4f2d58da76f5b7d197125eeab64a9aecf78fa3f197047ccdd69c64cf74d0e3fc58ecef92868a8564a58747d1e3f233f761909530d0337a45b7e64845738ee48a6db82dc686b2637a29de6ee840a9561aca0a6cc808e985fb15fef98644cb863eb484acca27aaf39d364fd963e2ba46f05f367d840ad7dfc3d312f3f69c3b78259c22bcf9b23be9d3b252788f5c66fcb49351f7b2329155020bc7cb53691866de01f6c558a17bc53bb7b0da10a709c8b6cdfbd25c208109896b51556a9eb6c813deaa3018258faf2385e6eea6c0e7805818e0c6b13c3c80819f60f561441cbbd008c2146ebfbb75282eaea6c6091e9241d5a4d2e54df41343857a2bbb4d9a1033c1a3659b6c450ed9267c6856f44d0e0fb7485f24238701987cabc47fddfc9e766c69ed24b23c8fa5de64d095efc77368438be4e13e84b1d7e299a0cae3a60dac6bc4e0fe6fdd456ec881a10a4b1d100efef53424693278b3175dabce0e61c99d90a602e2603bc1ea99b842cf5a3046a1eed0681b356f069d9fc2b1b33befdc088ec8f8f31b47ca1ef36ebfbf0be3f004ad9b00b5d13411fd94928a1a3a13088dd875af8177924aa8ac9e596e07d2eed3982ce3fa0ec357091ab84480bf8d2463d9b836f2294e8191e58c53eb8b0ea46bbd46e45f6e9fd04961b45c53e9a66f5ace153bddd932f36bd036da46f41a55790fff2622fd470f64d93de22a226b3efe84d3b0914610b7efa7910963468d1cf0ec365167dc1797633440fcf050ae04a74ad5cd6d3533f7f932e0b45fae8727657c42be48e25a88d6eb0e5f9a9bf3ac64c5bb1f2a87b0f01789569bcf9f047af0ceac4ec0a642cc1b566f0f51029638c462a1aad737f8801a36b07aa10518ee010054795a702e38c293566c8ab31315752e09dcf3c7d653066c9f63f769dd79b4009b39583ef1f70c487f453deaabcd4ba9dc438b4aa273bcd6e986fea3ef563d57118e6e1aef055965ed78e3bd11d5fc504abfaffaf3b831ca732f16c2b5528043381bdbab6fca5ba2000900b7e497a1d156025211bb17560763a79132a6ebeeadcc81928ba6ed0eddec444ad2357ab3c7ccf0edd15e7d5ef08056bd37a7f9f408ccbac2067abcb219280440849d7bf1a9852522a703139245553e9bac6d9721e98bd0e920b95b125f89cce5c","link":"/2019/09/19/helloworld/"},{"title":"hexoåˆ›å»ºä¸€ç¯‡æ–°æ–‡ç« æˆ–è€…æ–°çš„é¡µé¢","text":"ä½ å¯ä»¥æ‰§è¡Œhexo new [layout] &lt;title&gt;å‘½ä»¤æ¥åˆ›å»ºä¸€ç¯‡æ–°æ–‡ç« æˆ–è€…æ–°çš„é¡µé¢ æ‚¨å¯ä»¥åœ¨å‘½ä»¤ä¸­æŒ‡å®šæ–‡ç« çš„å¸ƒå±€ï¼ˆlayoutï¼‰ï¼Œé»˜è®¤ä¸º postï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹ _config.yml ä¸­çš„ default_layout å‚æ•°æ¥æŒ‡å®šé»˜è®¤å¸ƒå±€ã€‚ å¸ƒå±€(layout)Hexo æœ‰ä¸‰ç§é»˜è®¤å¸ƒå±€ï¼špostã€page å’Œ draftã€‚åœ¨åˆ›å»ºè€…ä¸‰ç§ä¸åŒç±»å‹çš„æ–‡ä»¶æ—¶ï¼Œå®ƒä»¬å°†ä¼šè¢«ä¿å­˜åˆ°ä¸åŒçš„è·¯å¾„ï¼›è€Œæ‚¨è‡ªå®šä¹‰çš„å…¶ä»–å¸ƒå±€å’Œ post ç›¸åŒï¼Œéƒ½å°†å‚¨å­˜åˆ° source/_posts æ–‡ä»¶å¤¹ã€‚ å¸ƒå±€ è·¯å¾„ post source/_posts page source draft source/_drafts å…¶ä»–å‚æ•° å‚æ•° æè¿° -p, â€“path è‡ªå®šä¹‰æ–°æ–‡ç« çš„è·¯å¾„ -r, â€“replace å¦‚æœå­˜åœ¨åŒåæ–‡ç« ï¼Œå°†å…¶æ›¿æ¢ -s, â€“slug æ–‡ç« çš„ Slugï¼Œä½œä¸ºæ–°æ–‡ç« çš„æ–‡ä»¶åå’Œå‘å¸ƒåçš„ URL é»˜è®¤æƒ…å†µä¸‹ï¼ŒHexo ä¼šä½¿ç”¨æ–‡ç« çš„æ ‡é¢˜æ¥å†³å®šæ–‡ç« æ–‡ä»¶çš„è·¯å¾„ã€‚å¯¹äºç‹¬ç«‹é¡µé¢æ¥è¯´ï¼ŒHexo ä¼šåˆ›å»ºä¸€ä¸ªä»¥æ ‡é¢˜ä¸ºåå­—çš„ç›®å½•ï¼Œå¹¶åœ¨ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ª index.md æ–‡ä»¶ã€‚ä½ å¯ä»¥ä½¿ç”¨ --path å‚æ•°æ¥è¦†ç›–ä¸Šè¿°è¡Œä¸ºã€è‡ªè¡Œå†³å®šæ–‡ä»¶çš„ç›®å½•ï¼š hexo new page â€“path about/me â€œAbout meâ€ ä»¥ä¸Šå‘½ä»¤ä¼šåˆ›å»ºä¸€ä¸ª source/about/me.md æ–‡ä»¶ï¼ŒåŒæ—¶ Front Matter ä¸­çš„ title ä¸º &quot;About me&quot;æ³¨æ„ï¼title æ˜¯å¿…é¡»æŒ‡å®šçš„ï¼å¦‚æœä½ è¿™ä¹ˆåšå¹¶ä¸èƒ½è¾¾åˆ°ä½ çš„ç›®çš„ï¼š hexo new page â€“path about/me æ­¤æ—¶ Hexo ä¼šåˆ›å»º source/_posts/about/me.mdï¼ŒåŒæ—¶ me.md çš„ Front Matter ä¸­çš„ title ä¸º &quot;page&quot;ã€‚è¿™æ˜¯å› ä¸ºåœ¨ä¸Šè¿°å‘½ä»¤ä¸­ï¼Œhexo-cli å°† page è§†ä¸ºæŒ‡å®šæ–‡ç« çš„æ ‡é¢˜ã€å¹¶é‡‡ç”¨é»˜è®¤çš„ layoutã€‚ å‚è€ƒæ–‡ç« : hexo-åŸºæœ¬æ“ä½œ-å†™ä½œ hexo-å¼€å§‹ä½¿ç”¨-å‘½ä»¤","link":"/2020/05/13/hexo/"},{"title":"äº«å…ƒæ¨¡å¼","text":"äº«å…ƒæ¨¡å¼æ˜¯è®¾è®¡æ¨¡å¼ä¸­å°‘æ•°å‡ ä¸ªä»¥æé«˜ç³»ç»Ÿæ€§èƒ½ä¸ºç›®çš„çš„æ¨¡å¼ä¹‹ä¸€ã€‚å®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šå¦‚æœåœ¨ä¸€ä¸ªç³»ç»Ÿä¸­å­˜åœ¨å¤šä¸ªç›¸åŒçš„å¯¹è±¡ï¼Œé‚£ä¹ˆåªéœ€å…±äº«ä¸€ä»½å¯¹è±¡çš„æ‹·è´ï¼Œè€Œä¸å¿…ä¸ºæ¯ä¸€æ¬¡ä½¿ç”¨éƒ½åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚åœ¨äº«å…ƒæ¨¡å¼ä¸­ï¼Œç”±äºéœ€è¦æ„é€ å’Œç»´æŠ¤è¿™äº›å¯ä»¥å…±äº«çš„å¯¹è±¡ï¼Œå› æ­¤ï¼Œå¸¸å¸¸å‡ºç°ä¸€ä¸ªå·¥å‚ç±»ï¼Œç”¨äºç»´æŠ¤å’Œåˆ›å»ºå¯¹è±¡ã€‚äº«å…ƒæ¨¡å¼å¯¹æ€§èƒ½çš„æå‡çš„ä¸»è¦å¸®åŠ©æœ‰ä¸¤ç‚¹ï¼š å¯ä»¥èŠ‚çœé‡å¤åˆ›å»ºå¯¹è±¡çš„å¼€é”€ï¼Œå› ä¸ºè¢«äº«å…ƒæ¨¡å¼ç»´æŠ¤çš„ç›¸åŒå¯¹è±¡åªä¼šè¢«åˆ›å»ºä¸€æ¬¡ï¼Œå½“åˆ›å»ºå¯¹è±¡æ¯”è¾ƒè€—æ—¶æ—¶ï¼Œä¾¿å¯ä»¥èŠ‚çœå¤§é‡æ—¶é—´ã€‚ ç”±äºåˆ›å»ºå¯¹è±¡çš„æ•°é‡å‡å°‘ï¼Œæ‰€ä»¥å¯¹ç³»ç»Ÿå†…å­˜çš„éœ€æ±‚ä¹Ÿå‡å°‘ï¼Œè¿™å°†æ˜¯çš„GCçš„å‹åŠ›ä¹Ÿå“åº”åœ°é™ä½ï¼Œè¿›è€Œä½¿å¾—ç³»ç»Ÿæ‹¥æœ‰ä¸€ä¸ªæ›´å¥åº·çš„å†…å­˜ç»“æ„å’Œæ›´å¿«çš„ååº”é€Ÿåº¦ã€‚ äº«å…ƒæ¨¡å¼çš„ä¸»è¦è§’è‰²æœ‰äº«å…ƒå·¥å‚ã€æŠ½è±¡äº«å…ƒã€å…·ä½“äº«å…ƒå’Œä¸»å‡½æ•°å‡ éƒ¨åˆ†ç»„æˆã€‚ äº«å…ƒæ¨¡å¼è§’è‰² è§’è‰² ä½œç”¨ äº«å…ƒå·¥å‚ ç”¨äºåˆ›å»ºå…·ä½“äº«å…ƒç±»ï¼Œç»´æŠ¤ç›¸åŒçš„äº«å…ƒå¯¹è±¡ã€‚å®ƒä¿è¯ç›¸åŒçš„äº«å…ƒå¯¹è±¡å¯ä»¥è¢«ç³»ç»Ÿå…±äº«ã€‚å³ï¼Œå…¶å†…éƒ¨ä½¿ç”¨äº†ç±»ä¼¼å•ä¾‹æ¨¡å¼çš„ç®—æ³•ï¼Œå½“è¯·æ±‚å¯¹è±¡å·²ç»å­˜åœ¨æ—¶ï¼Œç›´æ¥è¿”å›å¯¹è±¡ï¼Œä¸å­˜åœ¨æ—¶å†åˆ›å»ºå¯¹è±¡ã€‚ æŠ½è±¡äº«å…ƒ å®šä¹‰éœ€å…±äº«çš„å¯¹è±¡çš„ä¸šåŠ¡æ¥å£ã€‚äº«å…ƒç±»è¢«åˆ›å»ºå‡ºæ¥æ€»æ˜¯ä¸ºäº†å®ç°æŸäº›ç‰¹å®šçš„ä¸šåŠ¡é€»è¾‘ï¼Œè€ŒæŠ½è±¡äº«å…ƒä¾¿å®šä¹‰è¿™äº›é€»è¾‘çš„è¯­ä¹‰è¡Œä¸ºã€‚ å…·ä½“äº«å…ƒç±» å®ç°æŠ½è±¡äº«å…ƒç±»çš„æ¥å£ï¼Œå®Œæˆä¸€äº›å…·ä½“çš„é€»è¾‘ Main ä½¿ç”¨äº«å…ƒæ¨¡å¼çš„ç»„ä»¶ï¼Œé€šè¿‡äº«å…ƒå·¥å‚è·å–äº«å…ƒå¯¹è±¡ äº«å…ƒæ¨¡å¼çš„ç»“æ„å¦‚å›¾äº«å…ƒå·¥å‚æ˜¯äº«å…ƒæ¨¡å¼çš„æ ¸å¿ƒï¼Œå®ƒéœ€è¦ç¡®ä¿ç³»ç»Ÿå¯ä»¥å…±äº«ç›¸åŒçš„å¯¹è±¡ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œäº«å…ƒå·¥å‚ä¼šç»´æŠ¤ä¸€ä¸ªå¯¹è±¡åˆ—è¡¨ï¼Œå½“ä»»ä½•ç»„ä»¶å°è¯•è·å–äº«å…ƒç±»æ—¶ï¼Œå¦‚æœè¯·æ±‚çš„äº«å…ƒç±»å·²ç»è¢«åˆ›å»ºï¼Œåˆ™ç›´æ¥è¿”å›å·²æœ‰çš„äº«å…ƒç±»ï¼›è‹¥æ²¡æœ‰ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„äº«å…ƒå¯¹è±¡ï¼Œå¹¶å°†å®ƒåŠ å…¥åˆ°ç»´æŠ¤é˜Ÿåˆ—ä¸­ã€‚ æ³¨æ„ï¼šäº«å…ƒæ¨¡å¼æ˜¯ä¸ºæ•°ä¸å¤šçš„ï¼Œåªä¸ºæå‡ç³»ç»Ÿæ€§èƒ½è€Œç”Ÿçš„è®¾è®¡æ¨¡å¼ã€‚å®ƒçš„ä¸»è¦ä½œç”¨å°±æ˜¯å¤ç”¨å¤§å¯¹è±¡ï¼ˆé‡é‡çº§å¯¹è±¡ï¼‰ï¼Œä»¥èŠ‚çœå†…å­˜ç©ºé—´å’Œå¯¹è±¡åˆ›å»ºæ—¶é—´ã€‚ äº«å…ƒæ¨¡å¼çš„ä¸€ä¸ªå…¸å‹åº”ç”¨æ˜¯åœ¨SAASç³»ç»Ÿä¸­ã€‚SAASå³Software As A Service,æ˜¯ç›®å‰æ¯”è¾ƒæµè¡Œçš„ä¸€ç§è½¯ä»¶åº”ç”¨æ¨¡å¼ã€‚ä»¥ä¸€ä¸ªäººäº‹ç®¡ç†ç³»ç»Ÿçš„SAASè½¯ä»¶ä¸ºä¾‹ï¼Œå‡è®¾å…¬å¸ç”²ã€ä¹™ã€ä¸™å‡ä¸ºè¿™ä¸ªSAASç³»ç»Ÿçš„ç”¨æˆ·ï¼Œåˆ™å®šä¹‰æ¯ä¸ªå…¬å¸ä¸ºè¿™å¥—ç³»ç»Ÿçš„ä¸€ä¸ªç§Ÿæˆ·ã€‚æ¯ä¸ªå…¬å¸ï¼ˆç§Ÿæˆ·ï¼‰åˆå„æœ‰100ä¸ªå‘˜å·¥ã€‚å¦‚æœè¿™äº›å…¬å¸çš„æ‰€æœ‰å‘˜å·¥éƒ½å¯ä»¥ç™»é™†è¿™å¥—ç³»ç»ŸæŸ¥çœ‹è‡ªå·±çš„æ”¶å…¥æƒ…å†µï¼Œå¹¶ä¸”ä¸ºäº†ç³»ç»Ÿå®‰å…¨ï¼Œæ¯ä¸ªå…¬å¸éƒ½æ‹¥æœ‰è‡ªå·±ç‹¬ç«‹çš„æ•°æ®åº“ã€‚ä¸ºäº†ä½¿ç³»ç»Ÿçš„è®¾è®¡æœ€ä¸ºåˆç†ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¾¿å¯ä»¥ä½¿ç”¨äº«å…ƒæ¨¡å¼ä¸ºæ¯ä¸ªç§Ÿæˆ·åˆ†åˆ«æä¾›å·¥èµ„æŸ¥è¯¢æ¥å£ï¼Œè€Œæ¯ä¸ªå…¬å¸ä¸‹çš„æ‰€æœ‰å‘˜å·¥å¯ä»¥å…±äº«ä¸€ä¸ªæŸ¥è¯¢ï¼ˆå› ä¸ºä¸€ä¸ªç§Ÿæˆ·ä¸‹æ‰€æœ‰çš„å‘˜å·¥æ•°æ®éƒ½å­˜åœ¨ä¸€ä¸ªæ•°æ®åº“ä¸­ï¼Œä»–ä»¬å…±äº«æ•°æ®åº“é“¾æ¥ï¼‰ã€‚è¿™æ ·ï¼Œç³»ç»Ÿåªéœ€è¦3ä¸ªå…±äº«å®ä¾‹ï¼Œå°±è¶³ä»¥åº”ä»˜300ä¸ªå‘˜å·¥æŸ¥è¯¢è¯·æ±‚äº†ã€‚ReportManagerFactoryä¸ºäº«å…ƒå·¥å‚ï¼Œè´Ÿè´£åˆ›å»ºå…·ä½“çš„æŠ¥è¡¨å·¥å…·ï¼Œå®ƒç¡®ä¿æ¯ä¸ªå…¬å¸ä¸‹çš„æ‰€æœ‰å‘˜å·¥éƒ½å…±äº«ä¸€ä¸ªå…·ä½“çš„äº«å…ƒå®ä¾‹ï¼ˆFinancialReportManageræˆ–è€…EmployeeReportManagerï¼‰ã€‚è¿™æ ·ï¼Œå½“å…¬å¸ç”²çš„ä¸¤ä¸ªå‘˜å·¥ç™»å½•ï¼Œè¿›è¡Œè´¢åŠ¡æŸ¥è¯¢æ—¶ï¼Œç³»ç»Ÿä¸å¿…ä¸ºä¸¤ä¸ªå‘˜å·¥éƒ½åˆ›å»ºFinancialReportManager,è€Œå¯ä»¥è®©ä»–ä»¬å…±äº«ä¸€ä¸ªFinancialReportManagerå®ä¾‹ã€‚é€šè¿‡è¿™ä¸ªå®ä¾‹ï¼Œè¿˜å¯ä»¥è¿›ä¸€æ­¥äº†è§£äº«å…ƒå·¥å‚å’Œå¯¹è±¡æ± çš„ä¸€ä¸ªé‡è¦åŒºåˆ«ã€‚åœ¨ä¸€ä¸ªå¯¹è±¡æ± ä¸­ï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½æ˜¯ç­‰ä»·çš„ï¼Œä»»æ„ä¸¤ä¸ªå¯¹è±¡åœ¨ä»»ä½•ä½¿ç”¨åœºæ™¯ä¸­éƒ½å¯ä»¥è¢«å¯¹è±¡æ± ä¸­çš„å…¶ä»–å¯¹è±¡ä»£æ›¿ã€‚è€Œåœ¨äº«å…ƒæ¨¡å¼ä¸­ï¼Œäº«å…ƒå·¥å‚æ‰€ç»´æŠ¤çš„æ‰€æœ‰å¯¹è±¡éƒ½æ˜¯ä¸åŒçš„ï¼Œä»»ä½•ä¸¤ä¸ªå¯¹è±¡é—´ä¸èƒ½ç›¸äº’ä»£æ›¿ã€‚å¦‚æœ¬ä¾‹ä¸­ï¼Œä¸ºå…¬å¸ç”²åˆ›å»ºçš„FinancialReportManagerAå’Œä¸ºå…¬å¸ä¹™åˆ›å»ºçš„FinancialReportManagerBåˆ†åˆ«å¯¹åº”äº†åå°å„è‡ªä¸åŒçš„æ•°æ®åº“ï¼Œå› æ­¤ï¼Œä¸¤è€…æ˜¯ä¸å¯äº’ç›¸æ›¿ä»£çš„ã€‚ æ³¨æ„ï¼šäº«å…ƒæ¨¡å¼å’Œå¯¹è±¡æ± çš„æœ€å¤§ä¸åŒåœ¨äºï¼šäº«å…ƒå¯¹è±¡æ˜¯ä¸å¯ç›¸äº’æ›¿ä»£çš„ï¼Œå®ƒä»¬å„è‡ªéƒ½æœ‰å„è‡ªçš„å«ä¹‰å’Œç”¨é€”ï¼›è€Œå¯¹è±¡æ± çš„å¯¹è±¡éƒ½æ˜¯ç­‰ä»·çš„ï¼Œå¦‚æ•°æ®åº“è¿æ¥æ± ä¸­çš„æ•°æ®åº“é“¾æ¥ã€‚ æœ¬ä¾‹ä¸­çš„äº«å…ƒå¯¹è±¡æ¥å£çš„å®ç°å¦‚ä¸‹ï¼Œå®ƒç”¨äºåˆ›å»ºä¸€ä¸ªæŠ¥è¡¨ã€‚å³ï¼Œæ‰€æœ‰çš„æŠ¥è¡¨ç”Ÿæˆç±»å°†ä½œä¸ºäº«å…ƒå¯¹è±¡åœ¨ä¸€ä¸ªå…¬å¸ä¸­å…±äº«ã€‚ 123public interface IReportManager{ String createReport();} ä»¥ä¸‹æ˜¯ä¸¤ä¸ªæŠ¥è¡¨ç”Ÿæˆçš„å®ä¾‹ï¼Œåˆ†åˆ«å¯¹åº”å‘˜å·¥è´¢åŠ¡æ”¶å…¥æŠ¥è¡¨å’Œå‘˜å·¥ä¸ªäººä¿¡æ¯æŠ¥è¡¨ã€‚ä»–ä»¬éƒ½æ˜¯å…·ä½“çš„äº«å…ƒç±»ã€‚ 1234567891011121314151617181920public class FinancialReportManager implements IReportManager{//è´¢åŠ¡æŠ¥è¡¨ protected String tenantId = null;//ç§Ÿæˆ·ID public FinancialReportManager(String tenantId){ this.tenantId = tenantId; } @Override public String createReport(){ return \" this is a financial report\"; } }public class EmployeeReportManager implements IReportManager{//å‘˜å·¥æŠ¥è¡¨ protected String tenantId = null;//ç§Ÿæˆ·ID public FinancialReportManager(String tenantId){ this.tenantId = tenantId; } @Override public String createReport(){ return \" this is an employee report\"; } } æœ€ä¸ºæ ¸å¿ƒçš„äº«å…ƒå·¥å‚ç±»å®ç°å¦‚ä¸‹ï¼Œå®ƒä¹Ÿæ˜¯äº«å…ƒæ¨¡å¼çš„ç²¾é«“æ‰€åœ¨ã€‚å®ƒç¡®ä¿åŒä¸€ä¸ªå…¬å¸ï¼ˆç§Ÿæˆ·ï¼‰ä½¿ç”¨ç›¸åŒçš„å¯¹è±¡äº§ç”ŸæŠ¥è¡¨ã€‚è¿™æ˜¯ç›¸å½“æœ‰æ„ä¹‰çš„ï¼Œå¦åˆ™ç³»ç»Ÿå¯èƒ½ä¼šä¸ºæ¯ä¸ªå‘˜å·¥ç”Ÿæˆå„è‡ªçš„æŠ¥è¡¨å¯¹è±¡ï¼Œå¯¼è‡´ç³»ç»Ÿå¼€é”€æ¿€å¢ã€‚ 1234567891011121314151617181920public class ReportManagerFactory{ Map&lt;String,IReportManager&gt; financialReportManager= new HashMap&lt;String,IReportManager&gt;(); Map&lt;String,IReportManager&gt; employeeReportManager= new HashMap&lt;String,IReportManager&gt;(); IReportManager getFinancialManager(String tenantId){ IReportManager r = financialReportManager.get(tenantId); if(r==null){ r = new FinancialReportManager(tenantId); financialReportManager.put(tenantId,r); } return r; } IReportManager getEmployeeManager(String tenantId){ IReportManager r = employeeReportManager.get(tenantId); if(r==null){ r = new EmployeeReportManager(tenantId); employeeReportManager.put(tenantId,r); } return r; }} äº«å…ƒæ¨¡å¼ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š 12345public static void main(String[] args) { ReportMangerFactory rmf = new ReportMangerFactory(); IReportManager rm = rmf.getFinancialReportManger(\"A\"); System.out.println(rm.createReport());} ReportMangerFactoryä½œä¸ºäº«å…ƒå·¥å‚ï¼Œä»¥ç§Ÿå®¢çš„IDä¸ºç´¢å¼•ï¼Œç»´æŠ¤äº†ä¸€ä¸ªäº«å…ƒå¯¹è±¡çš„é›†åˆï¼Œå®ƒç¡®ä¿ç›¸åŒç§Ÿå®¢çš„è¯·æ±‚éƒ½è¿”å›åŒä¸€ä¸ªäº«å…ƒå®ä¾‹ï¼Œç¡®ä¿äº«å…ƒå¯¹è±¡çš„æœ‰æ•ˆå¤ç”¨ã€‚ å‚è€ƒæ–‡ç« : Javaç¨‹åºæ€§èƒ½ä¼˜åŒ–","link":"/2020/06/05/flyweight/"},{"title":"ä»£ç†æ¨¡å¼","text":"ä»£ç†æ¨¡å¼ä¹Ÿæ˜¯ä¸€ç§å¾ˆå¸¸è§çš„è®¾è®¡æ¨¡å¼ã€‚å®ƒä½¿ç”¨ä»£ç†å¯¹è±¡å®Œæˆç”¨æˆ·è¯·æ±‚ï¼Œå±è”½ç”¨æˆ·å¯¹çœŸå®å¯¹è±¡çš„è®¿é—®ã€‚å°±å¦‚åŒç°å®ä¸­çš„ä»£ç†ä¸€æ ·ï¼Œä»£ç†äººè¢«æˆæƒæ‰§è¡Œå½“äº‹äººçš„ä¸€äº›äº‹å®œï¼Œè€Œæ— éœ€å½“äº‹äººå‡ºé¢ï¼Œä»ç¬¬ä¸‰æ–¹çš„è§’åº¦çœ‹ï¼Œä¼¼ä¹å½“äº‹äººå¹¶ä¸å­˜åœ¨ï¼Œå› ä¸ºä»–åªå’Œä»£ç†äººé€šä¿¡ã€‚è€Œäº‹å®ä¸Šï¼Œä»£ç†äººæ˜¯è¦æœ‰å½“äº‹äººçš„æˆæƒï¼Œå¹¶ä¸”åœ¨æ ¸å¿ƒé—®é¢˜ä¸Šè¿˜éœ€è¦è¯·ç¤ºå½“äº‹äººã€‚åœ¨ç°å®ä¸­ï¼Œä½¿ç”¨ä»£ç†çš„æƒ…å†µå¾ˆæ™®éï¼Œè€Œä¸”åŸå› ä¹Ÿå¾ˆå¤šã€‚æ¯”å¦‚ï¼Œå½“äº‹äººå› ä¸ºæŸäº›éšç§ä¸æ–¹ä¾¿å‡ºé¢ï¼Œæˆ–è€…å½“äº‹äººä¸å…·å¤‡æŸäº›ç›¸å…³çš„ä¸“ä¸šæŠ€èƒ½ï¼Œè€Œéœ€è¦ä¸€ä¸ªèŒä¸šäººå‘˜æ¥å®Œæˆä¸€äº›ä¸“ä¸šçš„æ“ä½œï¼Œä¹Ÿå¯èƒ½ç”±äºå½“äº‹äººæ²¡æœ‰æ—¶é—´å¤„ç†äº‹åŠ¡ï¼Œè€Œè˜ç”¨ä»£ç†äººå‡ºé¢ã€‚åœ¨è½¯ä»¶è®¾è®¡ä¸­ï¼Œä½¿ç”¨ä»£ç†æ¨¡å¼çš„æ„å›¾ä¹Ÿå¾ˆå¤šï¼Œæ¯”å¦‚å› ä¸ºå®‰å…¨åŸå› ï¼Œéœ€è¦å±è”½å®¢æˆ·ç«¯ç›´æ¥è®¿é—®çœŸå®å¯¹è±¡ï¼›æˆ–è€…åœ¨è¿œç¨‹è°ƒç”¨ä¸­ï¼Œéœ€è¦ä½¿ç”¨ä»£ç†ç±»å¤„ç†è¿œç¨‹æ–¹æ³•è°ƒç”¨çš„æŠ€æœ¯ç»†èŠ‚ï¼›ä¹Ÿå¯èƒ½æ˜¯ä¸ºäº†æå‡ç³»ç»Ÿæ€§èƒ½ï¼Œå¯¹çœŸå®å¯¹è±¡è¿›è¡Œå°è£…ï¼Œä»è€Œè¾¾åˆ°å»¶è¿ŸåŠ è½½çš„ç›®çš„ã€‚ ä»£ç†æ¨¡å¼çš„ç»“æ„ä»£ç†æ¨¡å¼çš„ä¸»è¦å‚ä¸è€…æœ‰4ä¸ªã€‚ä»£ç†æ¨¡å¼è§’è‰² è§’è‰² ä½œç”¨ ä¸»é¢˜æ¥å£ å®šä¹‰ä»£ç†ç±»å’ŒçœŸå®ä¸»é¢˜çš„å…¬å…±å¯¹å¤–æ–¹æ³•ï¼Œä¹Ÿæ˜¯ä»£ç†ç±»ä»£ç†çœŸå®ä¸»é¢˜çš„æ–¹æ³• çœŸå®ä¸»é¢˜ çœŸæ­£å®ç°ä¸šåŠ¡é€»è¾‘çš„ç±» ä»£ç†ç±» ç”¨æ¥ä»£ç†å’Œå°è£…çœŸå®ä¸»é¢˜ Main å®¢æˆ·ç«¯ï¼Œä½¿ç”¨ä»£ç†ç±»å’Œä¸»é¢˜æ¥å£å®Œæˆä¸€äº›å·¥ä½œ ä»¥ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹æ¥é˜è¿°ä½¿ç”¨ä»£ç†æ¨¡å¼å®ç°å»¶è¿ŸåŠ è½½çš„æ–¹æ³•åŠå…¶æ„ä¹‰ã€‚å‡è®¾æŸå®¢æˆ·ç«¯è½¯ä»¶ï¼Œæœ‰æ ¹æ®ç”¨æˆ·è¯·æ±‚ï¼Œå»æ•°æ®åº“æŸ¥è¯¢æ•°æ®çš„åŠŸèƒ½ã€‚åœ¨æŸ¥è¯¢æ•°æ®å‰ï¼Œéœ€è¦è·å¾—æ•°æ®åº“è¿æ¥ï¼Œè½¯ä»¶å¼€å¯æ—¶ï¼Œåˆå§‹åŒ–ç³»ç»Ÿçš„æ‰€æœ‰ç±»ï¼Œæ­¤æ—¶å°è¯•è·å–æ•°æ®åº“è¿æ¥ã€‚å½“ç³»ç»Ÿæœ‰å¤§é‡çš„ç±»ä¼¼æ“ä½œå­˜åœ¨æ—¶ï¼ˆæ¯”å¦‚xmlè§£æç­‰ï¼‰ï¼Œæ‰€æœ‰è¿™äº›åˆå§‹åŒ–æ“ä½œçš„å åŠ ï¼Œä¼šä½¿å¾—ç³»ç»Ÿçš„å¯åŠ¨é€Ÿåº¦å˜å¾—éå¸¸ç¼“æ…¢ã€‚ä¸ºæ­¤ï¼Œä½¿ç”¨ä»£ç†æ¨¡å¼ã€ä»£ç†ç±»ï¼Œå°è£…å¯¹æ•°æ®åº“æŸ¥è¯¢ä¸­çš„åˆå§‹åŒ–æ“ä½œï¼Œå½“ç³»ç»Ÿå¯åŠ¨æ—¶ï¼Œåˆå§‹åŒ–è¿™ä¸ªä»£ç†ç±»ï¼Œè€ŒéçœŸå®çš„æ•°æ®åº“æŸ¥è¯¢ç±»ï¼Œè€Œä»£ç†ç±»ä»€ä¹ˆéƒ½æ²¡æœ‰åšï¼Œå› æ­¤ï¼Œå®ƒçš„æ„é€ æ˜¯ç›¸å½“è¿…é€Ÿçš„ã€‚åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶ï¼Œå°†æ¶ˆè€—èµ„æºæœ€å¤šçš„æ–¹æ³•éƒ½ä½¿ç”¨ä»£ç†æ¨¡å¼åˆ†ç¦»ï¼Œå°±å¯ä»¥åŠ å¿«ç³»ç»Ÿçš„å¯åŠ¨é€Ÿåº¦ï¼Œå‡å°‘ç”¨æˆ·çš„ç­‰å¾…æ—¶é—´ã€‚è€Œåœ¨ç”¨æˆ·çœŸæ­£åšæŸ¥è¯¢æ“ä½œæ—¶ï¼Œå†ç”±ä»£ç†ç±»ï¼Œå•ç‹¬å»åŠ è½½çœŸå®çš„æ•°æ®åº“æŸ¥è¯¢ç±»ï¼Œå®Œæˆç”¨æˆ·çš„è¯·æ±‚ã€‚è¿™ä¸ªè¿‡ç¨‹å°±æ˜¯ä½¿ç”¨ä»£ç†æ¨¡å¼å®ç°äº†å»¶è¿ŸåŠ è½½ã€‚ æ³¨æ„ï¼šä»£ç†æ¨¡å¼å¯ä»¥ç”¨äºå¤šç§åœºåˆï¼Œå¦‚ç”¨äºè¿œç¨‹è°ƒç”¨çš„ç½‘ç»œä»£ç†ï¼Œè€ƒè™‘å®‰å…¨å› ç´ çš„å®‰å…¨ä»£ç†ç­‰ã€‚å»¶è¿ŸåŠ è½½åªæ˜¯ä»£ç†æ¨¡å¼çš„ä¸€ç§åº”ç”¨åœºæ™¯ã€‚ å»¶è¿ŸåŠ è½½çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šå¦‚æœå½“å‰å¹¶æ²¡æœ‰ä½¿ç”¨è¿™ä¸ªç»„ä»¶ï¼Œåˆ™ä¸éœ€è¦çœŸæ­£åœ°åˆå§‹åŒ–å®ƒï¼Œä½¿ç”¨ä¸€ä¸ªä»£ç†å¯¹è±¡æ›¿ä»£å®ƒçš„åŸæœ‰çš„ä½ç½®ï¼Œåªè¦åœ¨çœŸæ­£éœ€è¦ä½¿ç”¨çš„æ—¶å€™ï¼Œæ‰å¯¹å®ƒè¿›è¡ŒåŠ è½½ã€‚ä½¿ç”¨ä»£ç†æ¨¡å¼çš„å»¶è¿ŸåŠ è½½æ—¶éå¸¸æœ‰æ„ä¹‰çš„ï¼Œé¦–å…ˆï¼Œå®ƒå¯ä»¥åœ¨æ—¶é—´è½´ä¸Šåˆ†æ•£ç³»ç»Ÿå‹åŠ›ï¼Œå°¤å…¶åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶ï¼Œä¸å¿…å®Œæˆæ‰€æœ‰çš„åˆå§‹åŒ–å·¥ä½œï¼Œä»è€ŒåŠ é€Ÿå¯åŠ¨æ—¶é—´ï¼›å…¶æ¬¡ï¼Œå¯¹å¾ˆå¤šçœŸå®ä¸»é¢˜è€Œè¨€ï¼Œåœ¨è½¯ä»¶å¯åŠ¨ç›´åˆ°è¢«å…³é—­çš„æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œå¯èƒ½æ ¹æœ¬ä¸ä¼šè¢«è°ƒç”¨ï¼Œåˆå§‹åŒ–è¿™äº›æ•°æ®æ— ç–‘æ˜¯ä¸€ç§èµ„æºæµªè´¹ã€‚ç³»ç»Ÿæ˜¾ç¤ºäº†ä½¿ç”¨ä»£ç†ç±»å°è£…æ•°æ®åº“æŸ¥è¯¢ç±»åï¼Œç³»ç»Ÿçš„å¯åŠ¨è¿‡ç¨‹ã€‚ä¸Šå›¾æ˜¾ç¤ºäº†ä½¿ç”¨ä»£ç†ç±»å°è£…æ•°æ®åº“æŸ¥è¯¢ç±»åï¼Œç³»ç»Ÿçš„å¯åŠ¨è¿‡ç¨‹ã€‚è‹¥ç³»ç»Ÿä¸ä½¿ç”¨ä»£ç†æ¨¡å¼ï¼Œåˆ™åœ¨å¯åŠ¨æ—¶å°±è¦åˆå§‹åŒ–DBQueryå¯¹è±¡ï¼Œè€Œä½¿ç”¨ä»£ç†æ¨¡å¼åï¼Œå¯åŠ¨æ—¶åªéœ€è¦åˆå§‹åŒ–ä¸€ä¸ªè½»é‡çº§çš„å¯¹è±¡DBQueryProxy.ç³»ç»Ÿçš„æ¥å£å¦‚ä¸‹å›¾IDBQueryæ˜¯ä¸»é¢˜æ¥å£ï¼Œå®šä¹‰ä»£ç†ç±»å’ŒçœŸå®ç±»éœ€è¦å¯¹å¤–æä¾›çš„æœåŠ¡ï¼Œåœ¨æœ¬ä¾‹ä¸­å®šä¹‰äº†å®ç°æ•°æ®åº“æŸ¥è¯¢çš„å…¬å…±æ–¹æ³•request()å‡½æ•°ã€‚DBQueryæ˜¯çœŸå®ä¸»é¢˜ï¼Œè´Ÿè´£å®é™…çš„ä¸šåŠ¡æ“ä½œï¼ŒDBQueryProxyæ˜¯DBQueryçš„ä»£ç†ç±»ã€‚ ä»£ç†æ¨¡å¼çš„å®ç°å’Œä½¿ç”¨åŸºäºä»¥ä¸Šè®¾è®¡ï¼ŒIDBQueryçš„å®ç°å¦‚ä¸‹ï¼Œå®ƒåªæœ‰ä¸€ä¸ªrequest()æ–¹æ³• 123public interface IDBQuery{ String request();} DBQueryå®ç°å¦‚ä¸‹ï¼Œå®ƒæ˜¯ä¸€ä¸ªé‡é‡çº§å¯¹è±¡ï¼Œæ„é€ ä¼šæ¯”è¾ƒæ…¢ï¼š 12345678910111213public class DBQuery implements IDBQuery{ public DBQuery(){ try{ Thread.sleep(1000);//æ¨¡æ‹Ÿé“¾æ¥æ•°æ®åº“ç­‰è€—æ—¶æ“ä½œ }catch(InterruptedException e){ e.printStackTrace(); } } @Override public String request(){ return \"request string\"; }} ä»£ç†ç±»DBQueryProxyæ˜¯è½»é‡çº§å¯¹è±¡ï¼Œåˆ›å»ºå¾ˆå¿«ï¼Œç”¨äºæ›¿ä»£DBQueryçš„ä½ç½®ï¼š 123456789101112public class DBQueryProxy implements IDBQuery{ private DBQuery real = null; @Override public String request(){ //çœŸæ­£éœ€è¦çš„æ—¶å€™ï¼Œæ‰åˆ›å»ºçœŸå®å¯¹è±¡,åˆ›å»ºè¿‡ç¨‹å¯èƒ½å¾ˆæ…¢ if(null == real){ real = new DBQuery(); } //åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œè¿™é‡Œè¿”å›ä¸€ä¸ªè™šå‡ç±»ï¼Œç±»ä¼¼äºFutureæ¨¡å¼ return real.request(); } } æœ€åï¼Œä¸»å‡½æ•°å¦‚ä¸‹ï¼Œå®ƒå¼•ç”¨IDBQueryæ¥å£ï¼Œæ¯”ä½¿ç”¨ä»£ç†ç±»å·¥ä½œï¼š 123456public class Main{ public static void main(String args[]){ IDBQuery q = new DBQueryProxy();//ä½¿ç”¨ä»£ç† q.request();//åœ¨çœŸæ­£ä½¿ç”¨æ—¶æ‰åˆ›å»ºçœŸå®å¯¹è±¡ }} æ³¨æ„ï¼šå°†ä»£ç†æ¨¡å¼ç”¨äºå®ç°å»¶è¿ŸåŠ è½½ï¼Œå¯ä»¥æœ‰æ•ˆåœ°æå‡ç³»ç»Ÿçš„å¯åŠ¨é€Ÿåº¦ï¼Œå¯¹æ”¹å–„ç”¨æˆ·ä½“éªŒæœ‰å¾ˆå¤§çš„å¸®åŠ©ã€‚ åŠ¨æ€ä»£ç†ä»‹ç»åŠ¨æ€ä»£ç†æ˜¯æŒ‡åœ¨è¿è¡Œæ—¶ï¼ŒåŠ¨æ€ç”Ÿæˆä»£ç†ç±»ã€‚å³ï¼Œä»£ç†ç±»çš„å­—èŠ‚ç å°†åœ¨è¿è¡Œæ—¶ç”Ÿæˆå¹¶è½½å…¥å½“å‰çš„ClassLoader.ä¸é™æ€ä»£ç†ç±»ç›¸æ¯”ï¼ŒåŠ¨æ€ç±»æœ‰è¯¸å¤šå¥½å¤„ã€‚ ä¸éœ€è¦ä¸ºçœŸå®ä¸»é¢˜æ–¹æ³•å†™ä¸€ä¸ªå½¢å¼ä¸Šå®Œå…¨ä¸€æ ·çš„å°è£…ç±»ï¼Œå‡å¦‚ä¸»é¢˜æ¥å£ä¸­çš„æ–¹æ³•å¾ˆå¤šï¼Œä¸ºæ¯ä¸€ä¸ªæ¥å£å†™ä¸€ä¸ªä»£ç†æ–¹æ³•ä¹Ÿæ˜¯éå¸¸çƒ¦äººçš„äº‹ï¼Œå¦‚æœæ¥å£æœ‰å˜åŠ¨ï¼Œåˆ™çœŸå®ä¸»é¢˜å’Œä»£ç†ç±»éƒ½è¦ä¿®æ”¹ï¼Œä¸åˆ©äºç³»ç»Ÿç»´æŠ¤ï¼› ä½¿ç”¨ä¸€äº›åŠ¨æ€ä»£ç†çš„ç”Ÿæˆæ–¹æ³•ç”šè‡³å¯ä»¥åœ¨è¿è¡Œæ—¶æŒ‡å®šä»£ç†ç±»çš„æ‰§è¡Œé€»è¾‘ï¼Œä»è€Œå¤§å¤§æå‡ç³»ç»Ÿçµæ´»æ€§ã€‚ æ³¨æ„ï¼šåŠ¨æ€ä»£ç†ä½¿ç”¨å­—èŠ‚ç åŠ¨æ€ç”ŸæˆåŠ è½½æŠ€æœ¯ï¼Œåœ¨è¿è¡Œæ—¶ç”Ÿæˆå¹¶åŠ è½½ç±»ã€‚ ç”ŸæˆåŠ¨æ€ä»£ç†ç±»çš„æ–¹æ³•å¾ˆå¤šï¼Œå¦‚ï¼ŒJDKè‡ªå¸¦çš„åŠ¨æ€ä»£ç†ã€CGLIBã€Javassistæˆ–è€…ASMåº“ã€‚JDKçš„åŠ¨æ€ä»£ç†ä½¿ç”¨ç®€å•ï¼Œå®ƒå†…ç½®äºJDKä¸­ï¼Œå› æ­¤ä¸éœ€è¦å¼•å…¥ç¬¬ä¸‰æ–¹JaråŒ…ï¼Œä½†ç›¸å¯¹åŠŸèƒ½è¾ƒå¼±ã€‚CGLIBå’ŒJavassistéƒ½æ˜¯é«˜çº§çš„å­—èŠ‚ç ç”Ÿæˆåº“ï¼Œæ€»ä½“æ€§èƒ½æ¯”JDKè‡ªå¸¦çš„åŠ¨æ€ä»£ç†å¥½ï¼Œè€Œä¸”åŠŸèƒ½ååˆ†å¼ºå¤§ã€‚ASMæ˜¯ä½çº§çš„å­—èŠ‚ç ç”Ÿæˆå·¥å…·ï¼Œä½¿ç”¨ASMä»¥åŠè¿‘ä¹äºåœ¨ä½¿ç”¨Java bytecodeç¼–ç¨‹ï¼Œå¯¹å¼€å‘äººå‘˜è¦æ±‚æœ€é«˜ï¼Œå½“ç„¶ï¼Œä¹Ÿæ˜¯æ€§èƒ½æœ€å¥½çš„ä¸€ç§åŠ¨æ€ä»£ç†ç”Ÿæˆå·¥å…·ã€‚ä½†ASMçš„ä½¿ç”¨è¿‡äºç¹çï¼Œè€Œä¸”æ€§èƒ½ä¹Ÿæ²¡æœ‰æ•°é‡çº§çš„æå‡ï¼ŒäºCGLIBç­‰é«˜çº§å­—èŠ‚ç ç”Ÿæˆå·¥å…·ç›¸æ¯”ï¼ŒASMç¨‹åºçš„å¯ç»´æŠ¤æ€§ä¹Ÿè¾ƒå·®ï¼Œå¦‚æœä¸æ˜¯å¯¹æ€§èƒ½æœ‰è‹›åˆ»è¦æ±‚çš„åœºåˆï¼Œè¿˜æ˜¯æ¨èä½¿ç”¨CGLIBæˆ–è€…Javassist. åŠ¨æ€ä»£ç†å®ç°ä»¥ä¸Šä¾‹ä¸­çš„DBQueryProxyä¸ºä¾‹ï¼Œä½¿ç”¨åŠ¨æ€ä»£ç†ç”ŸæˆåŠ¨æ€ç±»ï¼Œæ›¿ä»£ä¸Šä¾‹ä¸­çš„DBQueryProxyã€‚é¦–å…ˆï¼Œä½¿ç”¨JDKçš„åŠ¨æ€ä»£ç†ç”Ÿæˆä»£ç†å¯¹è±¡ã€‚JDKçš„åŠ¨æ€ä»£ç†éœ€è¦å®ç°ä¸€ä¸ªå¤„ç†æ–¹æ³•è°ƒç”¨Handler,ç”¨äºå®ç°ä»£ç†æ–¹æ³•çš„å†…éƒ¨é€»è¾‘ã€‚ 123456789public class JdkDbQueryHandler implements InvocationHandler{ IDBQuery real = null; public Object invoke(Object proxy,Method method,Object[] args) throws Throwable{ if (null == real){ real = new DBQuery();//å¦‚æœç¬¬ä¸€æ¬¡è°ƒç”¨ï¼Œç”ŸæˆçœŸå®çš„å¯¹è±¡ } return real.request();//ä½¿ç”¨çœŸå®ä¸»é¢˜å®Œæˆå®é™…æ“ä½œ }} ä»¥ä¸Šä»£ç å®ç°äº†ä¸€ä¸ªHandler,å¯ä»¥çœ‹åˆ°ï¼Œå®ƒçš„å†…éƒ¨é€»è¾‘å’ŒDBQueryProxyæ˜¯ç±»ä¼¼çš„ã€‚åœ¨è°ƒç”¨çœŸå®ä¸»é¢˜çš„æ–¹æ³•å‰ï¼Œå…ˆå°è¯•ç”ŸæˆçœŸå®ä¸»é¢˜å¯¹è±¡ã€‚æ¥ç€ï¼Œéœ€è¦ä½¿ç”¨è¿™ä¸ªHandlerç”ŸæˆåŠ¨æ€ä»£ç†å¯¹è±¡ï¼š 1234567public static IDBQuery createJdkProxy(){ IDBQuery jdkProxy = (IDBQuery) Proxy.newProxyInstance( ClassLoader.getSystemClassLoader(), new Class[]{IDBQuery.class}, new JdkDbQueryHandler()); return jdkProxy; } ä»¥ä¸Šä»£ç ç”Ÿæˆä¸€ä¸ªå®ç°äº†IDBQueryæ¥å£çš„ä»£ç†ç±»ï¼Œä»£ç†ç±»çš„å†…éƒ¨é€»è¾‘æœ‰jdkDbQueryHandlerå†³å®šã€‚ç”Ÿæˆä»£ç†ç±»åï¼Œæœ‰newProxyInstance()æ–¹æ³•è¿”å›è¯¥ä»£ç†ç±»çš„ä¸€ä¸ªå®ä¾‹ã€‚è‡³æ­¤ï¼Œä¸€ä¸ªå®Œæ•´çš„JDåŠ¨æ€ä»£ç†å°±å®Œæˆäº†ã€‚CGLIBå’ŒJavassistçš„åŠ¨æ€ä»£ç†çš„ä½¿ç”¨å’ŒJDKçš„åŠ¨æ€ä»£ç†éå¸¸ç±»ä¼¼ã€‚ä¸‹é¢ï¼Œå°è¯•ç”¨CGLIBç”ŸæˆåŠ¨æ€ä»£ç†ã€‚CGLIBä¹Ÿéœ€è¦å®ç°ä¸€ä¸ªå¤„ç†ä»£ç†é€»è¾‘çš„åˆ‡å…¥ç±»ï¼š 12345678910public class CglibDbQueryInterceptor implements MethodInterceptor{ IDBQuery real = null; @Override public Object intercept(Object arg0,Method arg1,Object[] arg2,MethodProxy arg3 )throws Throwable{ if (real == null){ real = new DBQuery(); } return real.request(); }} åœ¨è¿™ä¸ªåˆ‡å…¥å¯¹è±¡çš„åŸºç¡€ä¸Šï¼Œå¯ä»¥ç”ŸæˆåŠ¨æ€ä»£ç†ï¼š 12345678public static IDBQuery createCglibProxy(){ Enhancer enhancer = new Enhancer(); enhancer.setCallback(new CglibDbQueryInterceptor());//æŒ‡å®šåˆ‡å…¥å™¨ï¼Œå®šä¹‰ä»£ç†ç±»é€»è¾‘ enhancer.setInterfaces(new Class[]{IDBQuery.class});//æŒ‡å®šå®ç°çš„æ¥å£ IDBQuery cglibProxy = (IDBQuery)enhancer.create();//ç”Ÿæˆä»£ç†ç±»çš„å®ä¾‹ return cglibProxy; } ä½¿ç”¨Javassistç”ŸæˆåŠ¨æ€ä»£ç†å¯ä»¥ä½¿ç”¨ä¸¤ç§æ–¹å¼ï¼šä¸€ç§æ˜¯ä½¿ç”¨ä»£ç†å·¥å‚åˆ›å»ºï¼Œå¦ä¸€ç§é€šè¿‡ä½¿ç”¨åŠ¨æ€ä»£ç†åˆ›å»ºã€‚ä½¿ç”¨ä»£ç†å·¥å‚åˆ›å»ºæ—¶ï¼Œæ–¹æ³•ä¸CGLIBç±»ä¼¼ï¼Œä¹Ÿéœ€è¦å®ç°ä¸€ä¸ªç”¨äºä»£ç†é€»è¾‘å¤„ç†çš„Handler: 123456789public class JavassistDynDbQueryHandler implements MethodHandler{ IDBQuery real = null; public Object invoke(Object arg0,Method arg1,Method arg2,Object[] arg3) throws Throwable{ if(null == real){ real = new DBQuery(); } return real.request(); } } ä»¥è¿™ä¸ªHandlerä¸ºåŸºç¡€ï¼Œåˆ›å»ºåŠ¨æ€Javassistä»£ç†ï¼š 123456789public static IDBQuery createJavassitDynProxy throws Exception{ ProxyFactory proxyFactory = new ProxyFactory(); proxyFactory.setInterfaces(new Class[]{DBQuery.class});//æŒ‡å®šæ¥å£ Class proxyClass = proxyFactory.createClass(); IDBQuery javassistProxy = (IDBQuery)proxyClass.newInstance();//è®¾ç½®handlerå¤„ç†å™¨ ((ProxyObejct)javassistProxy).setHandler(new JavassistDynDbQueryHandler()); return javassistProxy;} Javassistä½¿ç”¨åŠ¨æ€Javaä»£ç åˆ›å»ºä»£ç†çš„è¿‡ç¨‹å’Œå‰æ–‡çš„æ–¹æ³•ç•¥æœ‰ä¸åŒã€‚Javassistå†…éƒ¨å¯ä»¥é€šè¿‡åŠ¨æ€Javaä»£ç ï¼Œç”Ÿæˆå­—èŠ‚ç ã€‚è¿™ç§æ–¹å¼åˆ›å»ºçš„åŠ¨æ€ä»£ç†å¯ä»¥éå¸¸çµæ´»ï¼Œç”šè‡³å¯ä»¥åœ¨è¿è¡Œæ—¶ç”Ÿæˆä¸šåŠ¡é€»è¾‘ã€‚ 1234567891011121314151617181920public static IDBQuery createJavassistBytecodeDynamicProxy() throws Exception { ClassPool mPool = new ClassPool(true); //å®šä¹‰ç±»å CtClass mCtc = mPool.makeClass(IDBQuery.class.getName()+\"JavassistBytecodeProxy\"); //éœ€è¦å®ç°çš„æ¥å£ mCtc.addInterface(mPool.get(IDBQuery.class.getName())); //æ·»åŠ æ„é€ å‡½æ•° mCtc.addConstructor(CtNewConstructor.defaultConstructor(mCtc)); //æ·»åŠ ç±»çš„å­—æ®µä¿¡æ¯ï¼Œä½¿ç”¨åŠ¨æ€javaä»£ç  mCtc.addField(CtField.make(\"public \" + IDBQuery.class.getName() + \" real;\",mCtc)); String dbqueryname = DBQuery.class.getName(); //æ·»åŠ æ–¹æ³•ï¼Œè¿™é‡Œä½¿ç”¨åŠ¨æ€Javaä»£ç æŒ‡å®šå†…éƒ¨é€»è¾‘ mCtc.addMethod(CtNewMethod.make(\"public String request() {if (real == null){\" + \"real = new \"+dbqueryname+\"();} return real.request();}\",mCtc)); //åŸºäºä»¥ä¸Šä¿¡æ¯ï¼Œç”ŸæˆåŠ¨æ€ç±» Class pc = mCtc.toClass(); //ç”ŸæˆåŠ¨æ€ç±»çš„å®ä¾‹ IDBQuery bytecodeProxy = (IDBQuery) pc.newInstance(); return bytecodeProxy; } åœ¨ä»¥ä¸Šä»£ç ä¸­ï¼Œä½¿ç”¨CtField.make()æ–¹æ³•å’ŒCtNewMethod.make()æ–¹æ³•åœ¨è¿è¡Œæ—¶ç”Ÿæˆäº†ä»£ç†ç±»çš„å­—æ®µå’Œæ–¹æ³•ã€‚è¿™äº›é€»è¾‘æœ‰Javassistçš„CtClasså¯¹è±¡å¤„ç†ï¼Œå°†Javaä»£ç è½¬æ¢ä¸ºå¯¹åº”çš„å­—èŠ‚ç ï¼Œå¹¶ç”ŸæˆåŠ¨æ€ä»£ç†ç±»çš„å®ä¾‹ã€‚ æ³¨æ„ï¼šä¸é™æ€ä»£ç†ç›¸æ¯”ï¼ŒåŠ¨æ€ä»£ç†å¯ä»¥å¾ˆå¤§å¹…åº¦åœ°å‡å°‘ä»£ç è¡Œæ•°ï¼Œå¹¶æå‡ç³»ç»Ÿçš„çµæ´»æ€§ã€‚ åœ¨Javaä¸­ï¼ŒåŠ¨æ€ä»£ç†ç±»çš„ç”Ÿæˆä¸»è¦æ¶‰åŠå¯¹ClassLoaderçš„ä½¿ç”¨ã€‚è¿™é‡Œä»¥CGLIBä¸ºä¾‹ï¼Œç®€è¦é˜è¿°åŠ¨æ€ç±»çš„åŠ è½½è¿‡ç¨‹ã€‚ä½¿ç”¨CGLIBç”ŸæˆåŠ¨æ€ä»£ç†ï¼Œé¦–å…ˆéœ€è¦ç”ŸæˆEnhancerç±»å®ä¾‹ï¼Œå¹¶æŒ‡å®šç”¨äºå¤„ç†ä»£ç†ä¸šåŠ¡çš„å›è°ƒç±»ã€‚åœ¨Enhancer.create()æ–¹æ³•ä¸­ï¼Œä¼šä½¿ç”¨DefaultGeneratorStrategy.Generate()æ–¹æ³•ç”ŸæˆåŠ¨æ€ä»£ç†ç±»çš„å­—èŠ‚ç ï¼Œå¹¶ä¿å­˜åœ¨byteæ•°ç»„ä¸­ã€‚æ¥ç€ä½¿ç”¨ReflectUtils.defineClass()æ–¹æ³•ï¼Œé€šè¿‡åå°„ï¼Œè°ƒç”¨ClassLoader.defineClass()æ–¹æ³•ï¼Œå°†å­—èŠ‚ç å°è£…åˆ°ClassLoaderä¸­ï¼Œå®Œæˆç±»çš„åŠ è½½ã€‚æœ€åä½¿ç”¨RelfectUtils.newInstance()æ–¹æ³•ï¼Œé€šè¿‡å‘å°„ï¼Œç”ŸæˆåŠ¨æ€ç±»çš„å®ä¾‹ï¼Œå¹¶è¿”å›è¯¥å®ä¾‹ã€‚æ— è®ºä½¿ç”¨ä½•ç§æ–¹æ³•ç”ŸæˆåŠ¨æ€ä»£ç†ï¼Œè™½ç„¶å®ç°ç»†èŠ‚ä¸åŒï¼Œä½†ä¸»è¦é€»è¾‘éƒ½ç›¸ä¼¼ï¼š æ ¹æ®æŒ‡å®šçš„å›è°ƒç±»ç”ŸæˆClasså­—èŠ‚ç -&gt;é€šè¿‡defineClass()å°†å­—èŠ‚ç å®šä¹‰ä¸ºç±»-&gt;ä½¿ç”¨åå°„æœºåˆ¶ç”Ÿæˆè¯¥ç±»çš„å®ä¾‹ æ³¨æ„ï¼šå°±åŠ¨æ€ä»£ç†çš„æ–¹æ³•è°ƒç”¨æ€§èƒ½è€Œè¨€ï¼ŒCGLIBå’ŒJavassistçš„åŸºæœ¬åŠ¨æ€ä»£ç çš„ä»£ç†éƒ½ä¼˜äºJDKè‡ªå¸¦çš„åŠ¨æ€ä»£ç†ã€‚æ­¤å¤–ï¼ŒJDKçš„åŠ¨æ€ä»£ç†è¦å°±ä»£ç†ç±»å’ŒçœŸå®ä¸»é¢˜éƒ½å®ç°åŒä¸€ä¸ªæ¥å£ï¼Œè€ŒCGLIBå’ŒJavassistæ²¡æœ‰å¼ºåˆ¶è¦æ±‚ã€‚ å‚è€ƒæ–‡ç« : Javaç¨‹åºæ€§èƒ½ä¼˜åŒ–","link":"/2020/05/15/proxy/"},{"title":"å•ä¾‹æ¨¡å¼","text":"å•ä¾‹æ¨¡å¼æ˜¯è®¾è®¡æ¨¡å¼ä¸­ä½¿ç”¨æœ€ä¸ºæ™®éçš„æ¨¡å¼ä¹‹ä¸€ã€‚æ˜¯ä¸€ç§å¯¹è±¡åˆ›å»ºæ¨¡å¼ï¼Œç”¨äºç”Ÿäº§ä¸€ä¸ªå¯¹è±¡çš„å…·ä½“å®ä¾‹ï¼Œå®ƒå¯ä»¥ç¡®ä¿ç³»ç»Ÿä¸­ä¸€ä¸ªç±»åªäº§ç”Ÿåœºä¸€ä¸ªå®ä¾‹ã€‚åœ¨Javaè¯­è¨€ä¸­ï¼Œè¿™æ ·çš„è¡Œä¸ºèƒ½å¸¦æ¥çš„ä¸¤å¤§å¥½å¤„ï¼šï¼ˆ1ï¼‰å‡å°‘é¢‘ç¹ä½¿ç”¨çš„å¯¹è±¡çš„åˆ›å»ºæ—¶é—´ï¼ŒèŠ‚çœç³»ç»Ÿå¼€é”€ã€‚ï¼ˆ2ï¼‰newæ“ä½œå‡å°‘-&gt;ç³»ç»Ÿå†…å­˜ä½¿ç”¨é¢‘ç‡é™ä½ï¼Œå‡è½»GCå‹åŠ›ï¼Œç¼©çŸ­GCåœé¡¿æ—¶é—´ã€‚å› æ­¤å¯¹äºç³»ç»Ÿçš„å…³é”®ç»„ä»¶å’Œé¢‘ç¹ä½¿ç”¨çš„å¯¹è±¡ï¼Œä½¿ç”¨å•ä¾‹æ¨¡å¼ä¾¿å¯ä»¥æœ‰æ•ˆçš„æ”¹å–„ç³»ç»Ÿçš„æ€§èƒ½ã€‚ å•ä¾‹çš„å‚ä¸è€…åªæœ‰å•ä¾‹ç±»å’Œä½¿ç”¨è€…ä¸¤ä¸ªè§’è‰²ã€‚å•ä¾‹æ¨¡å¼è§’è‰² è§’è‰² ä½œç”¨ å•ä¾‹ç±» æä¾›å•ä¾‹çš„å·¥å‚ï¼Œè¿”å›å•ä¾‹ ä½¿ç”¨è€… è·å–å¹¶ä½¿ç”¨å•ä¾‹ç±» å•ä¾‹æ¨¡å¼çš„æ ¸å¿ƒåœ¨äºé€šè¿‡ä¸€ä¸ªæ¥å£è¿”å›å”¯ä¸€çš„å¯¹è±¡å®ä¾‹ã€‚ä¾‹å¦‚ä¸‹é¢çš„å•ä¾‹å®ç°ï¼š ç‚¹å‡»å±•å¼€ä»£ç  >folded123456789public class Singleton{ private Singleton(){ System.out.println(\"Singleton is create\"); // åˆ›å»ºå•ä¾‹çš„è¿‡ç¨‹å¯èƒ½ä¼šæ¯”è¾ƒæ…¢ } private static Singleton instance = new Singleton(); public static Singleton getInstance(){ return instance; }} æ³¨æ„,é¦–å…ˆå•ä¾‹ç±»å¿…é¡»è¦æœ‰ä¸€ä¸ªprivateè®¿é—®çº§åˆ«çš„æ„é€ å‡½æ•°ï¼Œç¡®ä¿å•ä¾‹ä¸ä¼šåœ¨ç³»ç»Ÿä¸­çš„å…¶ä»–ä»£ç å†…è¢«å®ä¾‹åŒ–ï¼›å…¶æ¬¡ï¼Œinstanceæˆå‘˜å˜é‡å’ŒgetInstance()æ–¹æ³•å¿…é¡»æ˜¯staticçš„ã€‚ è¿™ç§å•ä¾‹çš„å®ç°æ–¹å¼éå¸¸ç®€å•ï¼Œè€Œä¸”ååˆ†å¯é ã€‚å®ƒçš„å”¯ä¸€çš„ä¸è¶³æ˜¯æ— æ³•å¯¹instanceå®ä¾‹åšå»¶è¿ŸåŠ è½½ã€‚å‡å¦‚å•ä¾‹çš„åˆ›å»ºè¿‡ç¨‹å¾ˆæ…¢ï¼Œè€Œç”±äºinstanceæˆå‘˜å˜é‡æ˜¯staticå®šä¹‰çš„ï¼Œå› æ­¤åœ¨JVMåŠ è½½å•ä¾‹ç±»æ—¶ï¼Œå•ä¾‹å¯¹è±¡å°±ä¼šè¢«åˆ›å»ºï¼Œå¦‚æœæ­¤æ—¶ï¼Œè¿™ä¸ªå•ä¾‹ç±»åœ¨ç³»ç»Ÿä¸­æ‰®æ¼”å…¶ä»–è§’è‰²ï¼Œé‚£ä¹ˆåœ¨ä»»ä½•ä½¿ç”¨è¿™ä¸ªå•ä¾‹ç±»çš„åœ°æ–¹éƒ½ä¼šåˆå§‹åŒ–è¿™ä¸ªå•ä¾‹å˜é‡ï¼Œè€Œä¸ç®¡æ˜¯å¦ä¼šè¢«ç”¨åˆ°ã€‚æ¯”å¦‚å•ä¾‹ç±»ä½œä¸ºStringå·¥å‚ï¼Œç”¨äºåˆ›å»ºä¸€äº›å­—ç¬¦ä¸²ï¼ˆè¯¥ç±»å³ç”¨äºåˆ›å»ºå•ä¾‹Singletonï¼Œæœ‰ç”¨äºåˆ›å»ºStringå¯¹è±¡ï¼‰ï¼š ç‚¹å‡»å±•å¼€ä»£ç  >folded12345678910111213public class Singleton{ private Singleton(){ System.out.println(\"Singleton is create\"); // åˆ›å»ºå•ä¾‹çš„è¿‡ç¨‹å¯èƒ½ä¼šæ¯”è¾ƒæ…¢ } private static Singleton instance = new Singleton(); public static Singleton getInstance(){ return instance; } public static void createString(){ // è¿™æ˜¯æ¨¡æ‹Ÿå•ä¾‹ç±»æ‰®æ¼”å…¶ä»–è§’è‰² System.out.println(\"createString in Singleton\"); }} å½“ä½¿ç”¨Singleton.createString()æ‰§è¡Œä»»åŠ¡æ—¶ï¼Œç¨‹åºè¾“å‡ºï¼š 12Singleton is create createString in Singleton å¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶æ­¤æ—¶å¹¶æ²¡æœ‰ä½¿ç”¨å•ä¾‹ç±»ï¼Œä½†å®ƒè¿˜æ˜¯è¢«åˆ›å»ºå‡ºæ¥äº†ï¼Œè¿™ä¹Ÿè®¸æ˜¯å¼€å‘äººå‘˜ä¸æƒ³çœ‹åˆ°çš„ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¹¶ä»¥æ­¤æé«˜ç³»ç»Ÿåœ¨ç›¸å…³å‡½æ•°è°ƒç”¨æ—¶çš„ååº”é€Ÿåº¦ï¼Œå°±éœ€è¦å¼•å…¥å»¶è¿ŸåŠ è½½æœºåˆ¶ã€‚ ç‚¹å‡»å±•å¼€ä»£ç  >folded123456789101112public class LazySingleton{ private LazySingleton(){ System.out.println(\"LazySingleton is create\"); //åˆ›å»ºå•ä¾‹çš„è¿‡ç¨‹å¯èƒ½ä¼šæ¯”è¾ƒæ…¢ } private static LazySingleton instance = null; public static synchronized LazySingleton getInstance(){ if(instance == null){ instance = new LazySingleton(); } return instance; }} é¦–å…ˆï¼Œå¯¹äºé™æ€æˆå‘˜å˜é‡instanceåˆå§‹å€¼èµ‹äºˆnullï¼Œç¡®ä¿ç³»ç»Ÿå¯åŠ¨æ—¶æ²¡æœ‰é¢å¤–çš„è´Ÿè½½ï¼›å…¶æ¬¡ï¼Œåœ¨getInstance()å·¥å‚æ–¹æ³•ä¸­ï¼Œåˆ¤æ–­å½“å‰å•ä¾‹æ˜¯å¦å·²ç»å­˜åœ¨ï¼Œè‹¥å­˜åœ¨åˆ™è¿”å›ï¼Œä¸å­˜åœ¨åˆ™å»ºç«‹å•ä¾‹ã€‚è¿™é‡Œå°¤å…¶è¿˜è¦æ³¨æ„ï¼ŒgetInstance()æ–¹æ³•å¿…é¡»æ˜¯åŒæ­¥çš„ï¼Œå¦åˆ™åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œå½“çº¿ç¨‹1åœ¨æ–°å»ºå•ä¾‹æ—¶ï¼Œå®Œæˆèµ‹å€¼æ“ä½œå‰ï¼Œçº¿ç¨‹2å¯èƒ½åˆ¤æ–­instanceä¸ºnullï¼Œæ•…çº¿ç¨‹2å°†å¯åŠ¨æ–°å»ºå•ä¾‹çš„ç¨‹åºï¼Œè€Œå¯¼è‡´å¤šä¸ªå®ä¾‹è¢«åˆ›å»ºï¼Œæ•…åŒæ­¥å…³é”®å­—æ˜¯å¿…é¡»çš„ã€‚ ä½¿ç”¨ä¸Šä¾‹ä¸­çš„å•ä¾‹å®ç°ï¼Œè™½ç„¶å®ç°äº†å»¶è¿ŸåŠ è½½åŠŸèƒ½ï¼Œä½†å’Œç¬¬ä¸€ç§æ–¹æ³•ç›¸æ¯”ï¼Œå®ƒå¼•å…¥äº†åŒæ­¥å…³é”®å­—ï¼Œå› æ­¤åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ï¼Œå®ƒçš„æ—¶è€—è¦è¿œè¿œå¤§äºç¬¬ä¸€ç§å•ä¾‹æ¨¡å¼ã€‚ ä»¥ä¸‹æµ‹è¯•ä»£ç å°±è¯´æ˜äº†è¿™ä¸ªé—®é¢˜ï¼š ç‚¹å‡»å±•å¼€ä»£ç  >folded12345678@Overridepublic void run(){ for(int i=0;i&lt;100000;i++){ Singleton.getInstance(); // LazySingleton.getInstance(); System.out.println(\"spend:\"+(System.currentTimeMillis()-beginTime)); }} å¼€å¯5ä¸ªçº¿ç¨‹åŒæ—¶å®Œæˆä»¥ä¸Šä»£ç çš„è¿è¡Œï¼Œä½¿ç”¨ç¬¬ä¸€ç§ç±»å‹çš„å•ä¾‹è€—æ—¶1ms,è€ŒLazySingletonå´ç›¸å¯¹è€—æ—¶çº¦300msã€‚æ€§èƒ½è‡³å°‘ç›¸å·®2ä¸ªæ•°é‡çº§ã€‚ æ³¨æ„ï¼Œæµ‹è¯•æ•°æ®ç»å¯¹å€¼ä¸å¿…å¤ªè¿‡å…³æ³¨ï¼Œåªå…³æ³¨ç›¸å¯¹è€—æ—¶å³å¯ã€‚ ä¸ºäº†ä½¿ç”¨å»¶è¿ŸåŠ è½½å¼•å…¥çš„åŒæ­¥å…³é”®å­—åè€Œé™ä½äº†ç³»ç»Ÿæ€§èƒ½ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬å¸Œæœ›çœ‹åˆ°çš„ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯¹å…¶è¿›è¡Œæ”¹è¿›ï¼š ç‚¹å‡»å±•å¼€ä»£ç  >folded1234567891011public class StaticSingleton{ private StaticSingleton(){ System.out.println(\"StaticSingleton is create\"); //åˆ›å»ºå•ä¾‹çš„è¿‡ç¨‹å¯èƒ½ä¼šæ¯”è¾ƒæ…¢ } private static class SingletonHolder{ private static StaticSingleton instance = new StaticSingleton(); } public static StaticSingleton getInstance(){ return SingletonHolder.instance; }} åœ¨è¿™ä¸ªå®ç°ä¸­ï¼Œå•ä¾‹æ¨¡å¼ä½¿ç”¨å†…éƒ¨ç±»æ¥ç»´æŠ¤å•ä¾‹å®ä¾‹ï¼Œå½“StaticSingletonè¢«åŠ è½½æ—¶ï¼Œå…¶å†…éƒ¨ç±»å¹¶ä¸ä¼šè¢«åˆå§‹åŒ–ï¼Œæ•…å¯ä»¥ç¡®ä¿å½“StaticSingletonè¢«è½½å…¥JVMæ—¶ï¼Œä¸ä¼šåˆå§‹åŒ–å•ä¾‹ç±»ï¼Œè€Œå½“getInstance()æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œæ‰ä¼šåŠ è½½SingletonHolderï¼Œä»è€Œåˆå§‹åŒ–instanceã€‚åŒæ—¶ï¼Œç”±äºå®ä¾‹çš„å»ºç«‹æ˜¯åœ¨ç±»åŠ è½½æ—¶å®Œæˆï¼Œæ•…å¤©ç”Ÿå¯¹å¤šçº¿ç¨‹å‹å¥½ï¼ŒgetInstance()æ–¹æ³•ä¸éœ€è¦ä½¿ç”¨åŒæ­¥å…³é”®å­—ã€‚å› æ­¤ï¼Œè¿™ç§å®ç°æ–¹å¼åŒæ—¶å…¼å¤‡ä»¥ä¸Šä¸¤ç§å®ç°ä¼˜ç‚¹ã€‚ ä½¿ç”¨å†…éƒ¨ç±»çš„æ–¹å¼å®ç°å•ä¾‹ï¼Œæ—¢å¯ä»¥åšåˆ°å»¶è¿ŸåŠ è½½ï¼Œä¹Ÿä¸å¿…ä½¿ç”¨åŒæ­¥å…³é”®å­—ï¼Œæ˜¯ä¸€ç§æ¯”è¾ƒå®Œå–„çš„å®ç° é€šå¸¸æƒ…å†µä¸‹ï¼Œç”¨ä»¥ä¸Šå®ç°çš„å•ä¾‹å·²ç»å¯ä»¥ç¡®ä¿åœ¨ç³»ç»Ÿä¸­åªå­˜åœ¨å”¯ä¸€å®ä¾‹äº†ã€‚ä½†ä»ç„¶æœ‰ä¾‹å¤–æƒ…å†µï¼Œå¯èƒ½å¯¼è‡´ç³»ç»Ÿç”Ÿæˆå¾ˆå¤šä¸ªå®ä¾‹ï¼Œæ¯”å¦‚ï¼Œåœ¨ä»£ç ä¸­ï¼Œé€šè¿‡åå°„æœºåˆ¶ï¼Œå¼ºè¡Œè°ƒç”¨å•ä¾‹ç±»çš„ç§æœ‰æ„é€ å‡½æ•°ï¼Œç”Ÿæˆå¤šä¸ªå•ä¾‹ã€‚ ä¸€ä¸ªå¯ä»¥åºåˆ—åŒ–çš„å•ä¾‹ ç‚¹å‡»å±•å¼€ä»£ç  >folded123456789101112131415161718public class SerSingleton implements java.io.Serializable{ String name; private SerSingleton(){ System.out.println(\"SerSingleton is create\"); //åˆ›å»ºå•ä¾‹çš„è¿‡ç¨‹å¯èƒ½ä¼šæ¯”è¾ƒæ…¢ name = \"SerSingleton\"; } private static SerSingleton instance = new SerSingleton(); public static SerSingleton getInstance(){ return instance; } public static void createSting(){ System.out.println(\"createString in Singleton\"); } private Object readResolve(){ // é˜»æ­¢ç”Ÿæˆæ–°çš„å®ä¾‹ï¼Œæ€»æ˜¯è¿”å›å½“å‰å¯¹è±¡ return instance; }} æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š ç‚¹å‡»å±•å¼€ä»£ç  >folded1234567891011121314151617@Testpublic void test() throws Exception{ SerSingleton s1 = null; SerSingleton s = SerSingleton.getInstance(); //å…ˆå°†å®ä¾‹åºåˆ—åŒ–åˆ°æ–‡ä»¶ FileOutputSteam fos = new FileOutputStream(\"SerSingleton.txt\"); ObjectOutputStream oos = new ObjectOutputStream(fos); oos.writeObject(s); oos.flush; oos.close; // ä»æ–‡ä»¶è¯»å‡ºåŸæœ‰çš„å•ä¾‹ç±» FileInputStream fis = new FileInputStream(\"SerSingleton.txt\"); ObjectInputStream ois = new ObjectInputStream(fis); s1 = (SerSingleton)ois.readObject(); Assert.assertEquals(s,s1);} ä½¿ç”¨ä¸€æ®µæµ‹è¯•å•ä¾‹çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œå½“å»æ‰SerSingletonä»£ç ä¸­çš„readResolve()æ–¹æ³•æ—¶ï¼ŒæŠ›å‡ºå¼‚å¸¸ï¼Œså’Œs1ä¸æ˜¯åŒä¸€å®ä¾‹,ååºåˆ—åŒ–åï¼Œç”Ÿæˆå¤šä¸ªå¯¹è±¡å®ä¾‹ã€‚æ·»åŠ readResolve()æ–¹æ³•åï¼Œç¨‹åºæœªæŠ¥å¼‚å¸¸ã€‚è¯´æ˜ï¼Œå³ä¾¿æ˜¯ååºåˆ—åŒ–ï¼Œä»ç„¶ä¿æŒäº†å•ä¾‹çš„ç‰¹æ€§ã€‚å®ç°äº†ç§æœ‰çš„readResolve()æ–¹æ³•åï¼ŒreadObject()å·²ç»å½¢åŒè™šè®¾ï¼Œå®ƒç›´æ¥ä½¿ç”¨readResolve()æ–¹æ³•æ›¿æ¢äº†åŸæœ¬çš„è¿”å›å€¼ï¼Œä»è€Œåœ¨å½¢å¼ä¸Šæ„é€ äº†å•ä¾‹ã€‚ åºåˆ—åŒ–å’Œååºåˆ—åŒ–å¯èƒ½ä¼šç ´åå•ä¾‹ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå¯¹å•ä¾‹è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„åœºæ™¯ä¸å¤šè§ï¼Œå¦‚æœå­˜åœ¨å°±éœ€è¦å¤šåŠ æ³¨æ„ã€‚ å‚è€ƒæ–‡ç« : Javaç¨‹åºæ€§èƒ½ä¼˜åŒ–","link":"/2020/05/13/singleton/"},{"title":"linuxæŸ¥è¯¢ç«¯å£å ç”¨","text":"éƒ¨ç½²æœåŠ¡æ—¶ç»å¸¸ä½¿ç”¨åˆ°çš„linuxå‘½ä»¤ ç‚¹å‡»å±•å¼€ä»£ç  >unfolded123456# æŸ¥è¯¢ç«¯å£å ç”¨netstat -lnpt |grep 5672# æŸ¥çœ‹è¿›ç¨‹çš„è¯¦ç»†ä¿¡æ¯ xxxxè¡¨ç¤ºPIDps xxxx # ä¸­æ­¢è¿›ç¨‹,xxxxè¡¨ç¤ºPIDkill -9 xxxx","link":"/2020/05/07/linux-code-1/"},{"title":"linuxç«¯å£æ”¾è¡Œ","text":"é…ç½®æŸä¸ªæœåŠ¡ç«¯å£æ—¶ï¼ŒæŸ¥è¯¢ç«¯å£æ˜¯å¦å¼€å‘ç­‰ä¸€äº›ç›¸å…³æ“ä½œ ç‚¹å‡»å±•å¼€ä»£ç  >unfolded12345678910111213141516# å¼€æ”¾xxxxç«¯å£ firewall-cmd --zone=public --add-port=xxxx/tcp --permanent # è®¾ç½®ç”Ÿæ•ˆ firewall-cmd --reload# å…³é—­xxxxç«¯å£ firewall-cmd --zone=public --remove-port=xxxx/tcp --permanent# æŸ¥çœ‹é˜²ç«å¢™æ‰€æœ‰å¼€æ”¾çš„ç«¯å£ firewall-cmd --zone=public --list-ports# å…³é—­é˜²ç«å¢™ systemctl stop firewalld.service# æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€ firewall-cmd --state# æŸ¥è¯¢xxxxç«¯å£æ˜¯å¦å¼€å¯æˆåŠŸ firewall-cmd --query-port=xxxx/tcp # æŸ¥çœ‹ç›‘å¬çš„ç«¯å£ netstat -lnpt","link":"/2020/05/07/linux-code/"},{"title":"JavaåŸºç¡€-æ³¨è§£","text":"æ³¨è§£çš„ä½œç”¨ï¼Ÿ è½¬è½½äºï¼šhttps://www.pdai.tech/md/interview/x-interview.html#13-%E6%B3%A8%E8%A7%A3è‘—ä½œæƒå½’https://pdai.techæ‰€æœ‰ã€‚ é“¾æ¥ï¼šhttps://www.pdai.tech/md/interview/x-interview.html æ³¨è§£æ˜¯ JDK1.5 ç‰ˆæœ¬å¼€å§‹å¼•å…¥çš„ä¸€ä¸ªç‰¹æ€§ï¼Œç”¨äºå¯¹ä»£ç è¿›è¡Œè¯´æ˜ï¼Œå¯ä»¥å¯¹åŒ…ã€ç±»ã€æ¥å£ã€å­—æ®µã€æ–¹æ³•å‚æ•°ã€å±€éƒ¨å˜é‡ç­‰è¿›è¡Œæ³¨è§£ã€‚å®ƒä¸»è¦çš„ä½œç”¨æœ‰ä»¥ä¸‹å››æ–¹é¢ï¼š ç”Ÿæˆæ–‡æ¡£ï¼Œé€šè¿‡ä»£ç é‡Œæ ‡è¯†çš„å…ƒæ•°æ®ç”Ÿæˆ javadoc æ–‡æ¡£ã€‚ ç¼–è¯‘æ£€æŸ¥ï¼Œé€šè¿‡ä»£ç é‡Œæ ‡è¯†çš„å…ƒæ•°æ®è®©ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æœŸé—´è¿›è¡Œæ£€æŸ¥éªŒè¯ã€‚ ç¼–è¯‘æ—¶åŠ¨æ€å¤„ç†ï¼Œç¼–è¯‘æ—¶é€šè¿‡ä»£ç é‡Œæ ‡è¯†çš„å…ƒæ•°æ®åŠ¨æ€å¤„ç†ï¼Œä¾‹å¦‚åŠ¨æ€ç”Ÿæˆä»£ç ã€‚ è¿è¡Œæ—¶åŠ¨æ€å¤„ç†ï¼Œè¿è¡Œæ—¶é€šè¿‡ä»£ç é‡Œæ ‡è¯†çš„å…ƒæ•°æ®åŠ¨æ€å¤„ç†ï¼Œä¾‹å¦‚ä½¿ç”¨åå°„æ³¨å…¥å®ä¾‹ã€‚ æ³¨è§£çš„å¸¸è§åˆ†ç±»ï¼ŸJava è‡ªå¸¦çš„æ ‡å‡†æ³¨è§£ åŒ…æ‹¬@Overrideã€@Deprecatedå’Œ@SuppressWarningsï¼Œåˆ†åˆ«ç”¨äºæ ‡æ˜é‡å†™æŸä¸ªæ–¹æ³•ã€æ ‡æ˜æŸä¸ªç±»æˆ–æ–¹æ³•è¿‡æ—¶ã€æ ‡æ˜è¦å¿½ç•¥çš„è­¦å‘Šï¼Œç”¨è¿™äº›æ³¨è§£æ ‡æ˜åç¼–è¯‘å™¨å°±ä¼šè¿›è¡Œæ£€æŸ¥ã€‚ å…ƒæ³¨è§£ å…ƒæ³¨è§£æ˜¯ç”¨äºå®šä¹‰æ³¨è§£çš„æ³¨è§£ï¼ŒåŒ…æ‹¬@Retentionã€@Targetã€@Inheritedã€@Documented @Retentionç”¨äºæ ‡æ˜æ³¨è§£è¢«ä¿ç•™çš„é˜¶æ®µ @Targetç”¨äºæ ‡æ˜æ³¨è§£ä½¿ç”¨çš„èŒƒå›´ @Inheritedç”¨äºæ ‡æ˜æ³¨è§£å¯ç»§æ‰¿ @Documentedç”¨äºæ ‡æ˜æ˜¯å¦ç”Ÿæˆ javadoc æ–‡æ¡£ è‡ªå®šä¹‰æ³¨è§£ å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚å®šä¹‰æ³¨è§£ï¼Œå¹¶å¯ç”¨å…ƒæ³¨è§£å¯¹è‡ªå®šä¹‰æ³¨è§£è¿›è¡Œæ³¨è§£ã€‚ è½¬è½½é¢è¯•","link":"/2022/07/21/zvn4dc/"},{"title":"JavaåŸºç¡€-æ³›å‹","text":"ä¸ºä»€ä¹ˆéœ€è¦æ³›å‹ï¼Ÿ è½¬è½½äºï¼šhttps://www.pdai.tech/md/interview/x-interview.html#12-%E6%B3%9B%E5%9E%8Bè‘—ä½œæƒå½’https://pdai.techæ‰€æœ‰ã€‚ é“¾æ¥ï¼šhttps://www.pdai.tech/md/interview/x-interview.html 1.é€‚ç”¨äºå¤šç§æ•°æ®ç±»å‹æ‰§è¡Œç›¸åŒçš„ä»£ç 1234567891011121314private static int add(int a, int b) { System.out.println(a + \"+\" + b + \"=\" + (a + b)); return a + b;}private static float add(float a, float b) { System.out.println(a + \"+\" + b + \"=\" + (a + b)); return a + b;}private static double add(double a, double b) { System.out.println(a + \"+\" + b + \"=\" + (a + b)); return a + b;} å¦‚æœæ²¡æœ‰æ³›å‹ï¼Œè¦å®ç°ä¸åŒç±»å‹çš„åŠ æ³•ï¼Œæ¯ç§ç±»å‹éƒ½éœ€è¦é‡è½½ä¸€ä¸ª add æ–¹æ³•ï¼›é€šè¿‡æ³›å‹ï¼Œæˆ‘ä»¬å¯ä»¥å¤ç”¨ä¸ºä¸€ä¸ªæ–¹æ³•ï¼š 1234private static &lt;T extends Number&gt; double add(T a, T b) { System.out.println(a + \"+\" + b + \"=\" + (a.doubleValue() + b.doubleValue())); return a.doubleValue() + b.doubleValue();} 2.æ³›å‹ä¸­çš„ç±»å‹åœ¨ä½¿ç”¨æ—¶æŒ‡å®šï¼Œä¸éœ€è¦å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼ˆç±»å‹å®‰å…¨ï¼Œç¼–è¯‘å™¨ä¼šæ£€æŸ¥ç±»å‹ï¼‰çœ‹ä¸‹è¿™ä¸ªä¾‹å­ï¼š 1234List list = new ArrayList();list.add(\"xxString\");list.add(100d);list.add(new Person()); æˆ‘ä»¬åœ¨ä½¿ç”¨ä¸Šè¿° list ä¸­ï¼Œlist ä¸­çš„å…ƒç´ éƒ½æ˜¯ Object ç±»å‹ï¼ˆæ— æ³•çº¦æŸå…¶ä¸­çš„ç±»å‹ï¼‰ï¼Œæ‰€ä»¥åœ¨å–å‡ºé›†åˆå…ƒç´ æ—¶éœ€è¦äººä¸ºçš„å¼ºåˆ¶ç±»å‹è½¬åŒ–åˆ°å…·ä½“çš„ç›®æ ‡ç±»å‹ï¼Œä¸”å¾ˆå®¹æ˜“å‡ºç° java.lang.ClassCastException å¼‚å¸¸ã€‚å¼•å…¥æ³›å‹ï¼Œå®ƒå°†æä¾›ç±»å‹çš„çº¦æŸï¼Œæä¾›ç¼–è¯‘å‰çš„æ£€æŸ¥ï¼š 123List&lt;String&gt; list = new ArrayList&lt;String&gt;();// listä¸­åªèƒ½æ”¾String, ä¸èƒ½æ”¾å…¶å®ƒç±»å‹çš„å…ƒç´  æ³›å‹ç±»å¦‚ä½•å®šä¹‰ä½¿ç”¨ï¼Ÿä»ä¸€ä¸ªç®€å•çš„æ³›å‹ç±»çœ‹èµ·ï¼š12345678910111213141516class Point&lt;T&gt;{ // æ­¤å¤„å¯ä»¥éšä¾¿å†™æ ‡è¯†ç¬¦å·ï¼ŒTæ˜¯typeçš„ç®€ç§° private T var ; // varçš„ç±»å‹ç”±TæŒ‡å®šï¼Œå³ï¼šç”±å¤–éƒ¨æŒ‡å®š public T getVar(){ // è¿”å›å€¼çš„ç±»å‹ç”±å¤–éƒ¨å†³å®š return var ; } public void setVar(T var){ // è®¾ç½®çš„ç±»å‹ä¹Ÿç”±å¤–éƒ¨å†³å®š this.var = var ; }}public class GenericsDemo06{ public static void main(String args[]){ Point&lt;String&gt; p = new Point&lt;String&gt;() ; // é‡Œé¢çš„varç±»å‹ä¸ºStringç±»å‹ p.setVar(\"it\") ; // è®¾ç½®å­—ç¬¦ä¸² System.out.println(p.getVar().length()) ; // å–å¾—å­—ç¬¦ä¸²çš„é•¿åº¦ }} å¤šå…ƒæ³›å‹123456789101112131415161718192021222324252627class Notepad&lt;K,V&gt;{ // æ­¤å¤„æŒ‡å®šäº†ä¸¤ä¸ªæ³›å‹ç±»å‹ private K key ; // æ­¤å˜é‡çš„ç±»å‹ç”±å¤–éƒ¨å†³å®š private V value ; // æ­¤å˜é‡çš„ç±»å‹ç”±å¤–éƒ¨å†³å®š public K getKey(){ return this.key ; } public V getValue(){ return this.value ; } public void setKey(K key){ this.key = key ; } public void setValue(V value){ this.value = value ; }}public class GenericsDemo09{ public static void main(String args[]){ Notepad&lt;String,Integer&gt; t = null ; // å®šä¹‰ä¸¤ä¸ªæ³›å‹ç±»å‹çš„å¯¹è±¡ t = new Notepad&lt;String,Integer&gt;() ; // é‡Œé¢çš„keyä¸ºStringï¼Œvalueä¸ºInteger t.setKey(\"æ±¤å§†\") ; // è®¾ç½®ç¬¬ä¸€ä¸ªå†…å®¹ t.setValue(20) ; // è®¾ç½®ç¬¬äºŒä¸ªå†…å®¹ System.out.print(\"å§“åï¼›\" + t.getKey()) ; // å–å¾—ä¿¡æ¯ System.out.print(\"ï¼Œå¹´é¾„ï¼›\" + t.getValue()) ; // å–å¾—ä¿¡æ¯ }} æ³›å‹æ¥å£å¦‚ä½•å®šä¹‰ä½¿ç”¨ï¼Ÿç®€å•çš„æ³›å‹æ¥å£12345678910111213141516171819202122interface Info&lt;T&gt;{ // åœ¨æ¥å£ä¸Šå®šä¹‰æ³›å‹ public T getVar() ; // å®šä¹‰æŠ½è±¡æ–¹æ³•ï¼ŒæŠ½è±¡æ–¹æ³•çš„è¿”å›å€¼å°±æ˜¯æ³›å‹ç±»å‹}class InfoImpl&lt;T&gt; implements Info&lt;T&gt;{ // å®šä¹‰æ³›å‹æ¥å£çš„å­ç±» private T var ; // å®šä¹‰å±æ€§ public InfoImpl(T var){ // é€šè¿‡æ„é€ æ–¹æ³•è®¾ç½®å±æ€§å†…å®¹ this.setVar(var) ; } public void setVar(T var){ this.var = var ; } public T getVar(){ return this.var ; }}public class GenericsDemo24{ public static void main(String arsg[]){ Info&lt;String&gt; i = null; // å£°æ˜æ¥å£å¯¹è±¡ i = new InfoImpl&lt;String&gt;(\"æ±¤å§†\") ; // é€šè¿‡å­ç±»å®ä¾‹åŒ–å¯¹è±¡ System.out.println(\"å†…å®¹ï¼š\" + i.getVar()) ; }} æ³›å‹æ–¹æ³•å¦‚ä½•å®šä¹‰ä½¿ç”¨ï¼Ÿæ³›å‹æ–¹æ³•ï¼Œæ˜¯åœ¨è°ƒç”¨æ–¹æ³•çš„æ—¶å€™æŒ‡æ˜æ³›å‹çš„å…·ä½“ç±»å‹ å®šä¹‰æ³›å‹æ–¹æ³•è¯­æ³•æ ¼å¼ è°ƒç”¨æ³›å‹æ–¹æ³•è¯­æ³•æ ¼å¼ è¯´æ˜ä¸€ä¸‹ï¼Œå®šä¹‰æ³›å‹æ–¹æ³•æ—¶ï¼Œå¿…é¡»åœ¨è¿”å›å€¼å‰è¾¹åŠ ä¸€ä¸ª&lt;T&gt;ï¼Œæ¥å£°æ˜è¿™æ˜¯ä¸€ä¸ªæ³›å‹æ–¹æ³•ï¼ŒæŒæœ‰ä¸€ä¸ªæ³›å‹Tï¼Œç„¶åæ‰å¯ä»¥ç”¨æ³›å‹Tä½œä¸ºæ–¹æ³•çš„è¿”å›å€¼ã€‚Class&lt;T&gt;çš„ä½œç”¨å°±æ˜¯æŒ‡æ˜æ³›å‹çš„å…·ä½“ç±»å‹ï¼Œè€ŒClass&lt;T&gt;ç±»å‹çš„å˜é‡ cï¼Œå¯ä»¥ç”¨æ¥åˆ›å»ºæ³›å‹ç±»çš„å¯¹è±¡ã€‚ä¸ºä»€ä¹ˆè¦ç”¨å˜é‡cæ¥åˆ›å»ºå¯¹è±¡å‘¢ï¼Ÿæ—¢ç„¶æ˜¯æ³›å‹æ–¹æ³•ï¼Œå°±ä»£è¡¨ç€æˆ‘ä»¬ä¸çŸ¥é“å…·ä½“çš„ç±»å‹æ˜¯ä»€ä¹ˆï¼Œä¹Ÿä¸çŸ¥é“æ„é€ æ–¹æ³•å¦‚ä½•ï¼Œå› æ­¤æ²¡æœ‰åŠæ³•å»newä¸€ä¸ªå¯¹è±¡ï¼Œä½†å¯ä»¥åˆ©ç”¨å˜é‡cçš„newInstanceæ–¹æ³•å»åˆ›å»ºå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯åˆ©ç”¨åå°„åˆ›å»ºå¯¹è±¡ã€‚æ³›å‹æ–¹æ³•è¦æ±‚çš„å‚æ•°æ˜¯Class&lt;T&gt;ç±»å‹ï¼Œè€ŒClass.forName()æ–¹æ³•çš„è¿”å›å€¼ä¹Ÿæ˜¯Class&lt;T&gt;ï¼Œå› æ­¤å¯ä»¥ç”¨Class.forName()ä½œä¸ºå‚æ•°ã€‚å…¶ä¸­ï¼ŒforName()æ–¹æ³•ä¸­çš„å‚æ•°æ˜¯ä½•ç§ç±»å‹ï¼Œè¿”å›çš„Class&lt;T&gt;å°±æ˜¯ä½•ç§ç±»å‹ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼ŒforName()æ–¹æ³•ä¸­ä¼ å…¥çš„æ˜¯Userç±»çš„å®Œæ•´è·¯å¾„ï¼Œå› æ­¤è¿”å›çš„æ˜¯Class&lt;User&gt;ç±»å‹çš„å¯¹è±¡ï¼Œå› æ­¤è°ƒç”¨æ³›å‹æ–¹æ³•æ—¶ï¼Œå˜é‡cçš„ç±»å‹å°±æ˜¯Class&lt;User&gt;ï¼Œå› æ­¤æ³›å‹æ–¹æ³•ä¸­çš„æ³›å‹Tå°±è¢«æŒ‡æ˜ä¸ºUserï¼Œå› æ­¤å˜é‡objçš„ç±»å‹ä¸ºUserã€‚å½“ç„¶ï¼Œæ³›å‹æ–¹æ³•ä¸æ˜¯ä»…ä»…å¯ä»¥æœ‰ä¸€ä¸ªå‚æ•°Class&lt;T&gt;ï¼Œå¯ä»¥æ ¹æ®éœ€è¦æ·»åŠ å…¶ä»–å‚æ•°ã€‚ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ³›å‹æ–¹æ³•å‘¢ï¼Ÿå› ä¸ºæ³›å‹ç±»è¦åœ¨å®ä¾‹åŒ–çš„æ—¶å€™å°±æŒ‡æ˜ç±»å‹ï¼Œå¦‚æœæƒ³æ¢ä¸€ç§ç±»å‹ï¼Œä¸å¾—ä¸é‡æ–°newä¸€æ¬¡ï¼Œå¯èƒ½ä¸å¤Ÿçµæ´»ï¼›è€Œæ³›å‹æ–¹æ³•å¯ä»¥åœ¨è°ƒç”¨çš„æ—¶å€™æŒ‡æ˜ç±»å‹ï¼Œæ›´åŠ çµæ´»ã€‚ æ³›å‹çš„ä¸Šé™å’Œä¸‹é™ï¼Ÿåœ¨ä½¿ç”¨æ³›å‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºä¼ å…¥çš„æ³›å‹ç±»å‹å®å‚è¿›è¡Œä¸Šä¸‹è¾¹ç•Œçš„é™åˆ¶ï¼Œå¦‚ï¼šç±»å‹å®å‚åªå‡†ä¼ å…¥æŸç§ç±»å‹çš„çˆ¶ç±»æˆ–æŸç§ç±»å‹çš„å­ç±»ã€‚ ä¸Šé™1234567891011121314151617class Info&lt;T extends Number&gt;{ // æ­¤å¤„æ³›å‹åªèƒ½æ˜¯æ•°å­—ç±»å‹ private T var ; // å®šä¹‰æ³›å‹å˜é‡ public void setVar(T var){ this.var = var ; } public T getVar(){ return this.var ; } public String toString(){ // ç›´æ¥æ‰“å° return this.var.toString() ; }}public class demo1{ public static void main(String args[]){ Info&lt;Integer&gt; i1 = new Info&lt;Integer&gt;() ; // å£°æ˜Integerçš„æ³›å‹å¯¹è±¡ }} ä¸‹é™12345678910111213141516171819202122232425class Info&lt;T&gt;{ private T var ; // å®šä¹‰æ³›å‹å˜é‡ public void setVar(T var){ this.var = var ; } public T getVar(){ return this.var ; } public String toString(){ // ç›´æ¥æ‰“å° return this.var.toString() ; }}public class GenericsDemo21{ public static void main(String args[]){ Info&lt;String&gt; i1 = new Info&lt;String&gt;() ; // å£°æ˜Stringçš„æ³›å‹å¯¹è±¡ Info&lt;Object&gt; i2 = new Info&lt;Object&gt;() ; // å£°æ˜Objectçš„æ³›å‹å¯¹è±¡ i1.setVar(\"hello\") ; i2.setVar(new Object()) ; fun(i1) ; fun(i2) ; } public static void fun(Info&lt;? super String&gt; temp){ // åªèƒ½æ¥æ”¶Stringæˆ–Objectç±»å‹çš„æ³›å‹ï¼ŒStringç±»çš„çˆ¶ç±»åªæœ‰Objectç±» System.out.print(temp + \", \") ; }} å¦‚ä½•ç†è§£ Java ä¸­çš„æ³›å‹æ˜¯ä¼ªæ³›å‹ï¼Ÿæ³›å‹ä¸­ç±»å‹æ“¦é™¤ Java æ³›å‹è¿™ä¸ªç‰¹æ€§æ˜¯ä» JDK 1.5 æ‰å¼€å§‹åŠ å…¥çš„ï¼Œå› æ­¤ä¸ºäº†å…¼å®¹ä¹‹å‰çš„ç‰ˆæœ¬ï¼ŒJava æ³›å‹çš„å®ç°é‡‡å–äº†â€œä¼ªæ³›å‹â€çš„ç­–ç•¥ï¼Œå³ Java åœ¨è¯­æ³•ä¸Šæ”¯æŒæ³›å‹ï¼Œä½†æ˜¯åœ¨ç¼–è¯‘é˜¶æ®µä¼šè¿›è¡Œæ‰€è°“çš„â€œç±»å‹æ“¦é™¤â€ï¼ˆType Erasureï¼‰ï¼Œå°†æ‰€æœ‰çš„æ³›å‹è¡¨ç¤ºï¼ˆå°–æ‹¬å·ä¸­çš„å†…å®¹ï¼‰éƒ½æ›¿æ¢ä¸ºå…·ä½“çš„ç±»å‹ï¼ˆå…¶å¯¹åº”çš„åŸç”Ÿæ€ç±»å‹ï¼‰ï¼Œå°±åƒå®Œå…¨æ²¡æœ‰æ³›å‹ä¸€æ ·ã€‚ è½¬è½½é¢è¯•","link":"/2022/07/21/nbzv8i/"},{"title":"JavaåŸºç¡€-è¯­æ³•åŸºç¡€","text":"é¢å‘å¯¹è±¡ç‰¹æ€§? è½¬è½½äºï¼šhttps://www.pdai.tech/md/interview/x-interview.html#11-%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80è‘—ä½œæƒå½’https://pdai.techæ‰€æœ‰ã€‚ é“¾æ¥ï¼šhttps://www.pdai.tech/md/interview/x-interview.html å°è£…åˆ©ç”¨æŠ½è±¡æ•°æ®ç±»å‹å°†æ•°æ®å’ŒåŸºäºæ•°æ®çš„æ“ä½œå°è£…åœ¨ä¸€èµ·ï¼Œä½¿å…¶æ„æˆä¸€ä¸ªä¸å¯åˆ†å‰²çš„ç‹¬ç«‹å®ä½“ã€‚æ•°æ®è¢«ä¿æŠ¤åœ¨æŠ½è±¡æ•°æ®ç±»å‹çš„å†…éƒ¨ï¼Œå°½å¯èƒ½åœ°éšè—å†…éƒ¨çš„ç»†èŠ‚ï¼Œåªä¿ç•™ä¸€äº›å¯¹å¤–æ¥å£ä½¿ä¹‹ä¸å¤–éƒ¨å‘ç”Ÿè”ç³»ã€‚ç”¨æˆ·æ— éœ€çŸ¥é“å¯¹è±¡å†…éƒ¨çš„ç»†èŠ‚ï¼Œä½†å¯ä»¥é€šè¿‡å¯¹è±¡å¯¹å¤–æä¾›çš„æ¥å£æ¥è®¿é—®è¯¥å¯¹è±¡ã€‚ä¼˜ç‚¹: å‡å°‘è€¦åˆ: å¯ä»¥ç‹¬ç«‹åœ°å¼€å‘ã€æµ‹è¯•ã€ä¼˜åŒ–ã€ä½¿ç”¨ã€ç†è§£å’Œä¿®æ”¹ å‡è½»ç»´æŠ¤çš„è´Ÿæ‹…: å¯ä»¥æ›´å®¹æ˜“è¢«ç¨‹åºå‘˜ç†è§£ï¼Œå¹¶ä¸”åœ¨è°ƒè¯•çš„æ—¶å€™å¯ä»¥ä¸å½±å“å…¶ä»–æ¨¡å— æœ‰æ•ˆåœ°è°ƒèŠ‚æ€§èƒ½: å¯ä»¥é€šè¿‡å‰–æç¡®å®šå“ªäº›æ¨¡å—å½±å“äº†ç³»ç»Ÿçš„æ€§èƒ½ æé«˜è½¯ä»¶çš„å¯é‡ç”¨æ€§ é™ä½äº†æ„å»ºå¤§å‹ç³»ç»Ÿçš„é£é™©: å³ä½¿æ•´ä¸ªç³»ç»Ÿä¸å¯ç”¨ï¼Œä½†æ˜¯è¿™äº›ç‹¬ç«‹çš„æ¨¡å—å´æœ‰å¯èƒ½æ˜¯å¯ç”¨çš„ ä»¥ä¸‹ Person ç±»å°è£… nameã€genderã€age ç­‰å±æ€§ï¼Œå¤–ç•Œåªèƒ½é€šè¿‡ get() æ–¹æ³•è·å–ä¸€ä¸ª Person å¯¹è±¡çš„ name å±æ€§å’Œ gender å±æ€§ï¼Œè€Œæ— æ³•è·å– age å±æ€§ï¼Œä½†æ˜¯ age å±æ€§å¯ä»¥ä¾› work() æ–¹æ³•ä½¿ç”¨ã€‚æ³¨æ„åˆ° gender å±æ€§ä½¿ç”¨ int æ•°æ®ç±»å‹è¿›è¡Œå­˜å‚¨ï¼Œå°è£…ä½¿å¾—ç”¨æˆ·æ³¨æ„ä¸åˆ°è¿™ç§å®ç°ç»†èŠ‚ã€‚å¹¶ä¸”åœ¨éœ€è¦ä¿®æ”¹ gender å±æ€§ä½¿ç”¨çš„æ•°æ®ç±»å‹æ—¶ï¼Œä¹Ÿå¯ä»¥åœ¨ä¸å½±å“å®¢æˆ·ç«¯ä»£ç çš„æƒ…å†µä¸‹è¿›è¡Œã€‚ 12345678910111213141516171819202122public class Person { private String name; private int gender; private int age; public String getName() { return name; } public String getGender() { return gender == 0 ? \"man\" : \"woman\"; } public void work() { if (18 &lt;= age &amp;&amp; age &lt;= 50) { System.out.println(name + \" is working very hard!\"); } else { System.out.println(name + \" can't work any more!\"); } }} ç»§æ‰¿ç»§æ‰¿å®ç°äº† IS-A å…³ç³»ï¼Œä¾‹å¦‚ Cat å’Œ Animal å°±æ˜¯ä¸€ç§ IS-A å…³ç³»ï¼Œå› æ­¤ Cat å¯ä»¥ç»§æ‰¿è‡ª Animalï¼Œä»è€Œè·å¾— Animal é private çš„å±æ€§å’Œæ–¹æ³•ã€‚ç»§æ‰¿åº”è¯¥éµå¾ªé‡Œæ°æ›¿æ¢åŸåˆ™ï¼Œå­ç±»å¯¹è±¡å¿…é¡»èƒ½å¤Ÿæ›¿æ¢æ‰æ‰€æœ‰çˆ¶ç±»å¯¹è±¡ã€‚Cat å¯ä»¥å½“åš Animal æ¥ä½¿ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥ä½¿ç”¨ Animal å¼•ç”¨ Cat å¯¹è±¡ã€‚çˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡ç§°ä¸º å‘ä¸Šè½¬å‹ ã€‚ 1Animal animal = new Cat(); å¤šæ€å¤šæ€åˆ†ä¸ºç¼–è¯‘æ—¶å¤šæ€å’Œè¿è¡Œæ—¶å¤šæ€: ç¼–è¯‘æ—¶å¤šæ€ä¸»è¦æŒ‡æ–¹æ³•çš„é‡è½½ è¿è¡Œæ—¶å¤šæ€æŒ‡ç¨‹åºä¸­å®šä¹‰çš„å¯¹è±¡å¼•ç”¨æ‰€æŒ‡å‘çš„å…·ä½“ç±»å‹åœ¨è¿è¡ŒæœŸé—´æ‰ç¡®å®š è¿è¡Œæ—¶å¤šæ€æœ‰ä¸‰ä¸ªæ¡ä»¶: ç»§æ‰¿ è¦†ç›–(é‡å†™) å‘ä¸Šè½¬å‹ ä¸‹é¢çš„ä»£ç ä¸­ï¼Œä¹å™¨ç±»(Instrument)æœ‰ä¸¤ä¸ªå­ç±»: Wind å’Œ Percussionï¼Œå®ƒä»¬éƒ½è¦†ç›–äº†çˆ¶ç±»çš„ play() æ–¹æ³•ï¼Œå¹¶ä¸”åœ¨ main() æ–¹æ³•ä¸­ä½¿ç”¨çˆ¶ç±» Instrument æ¥å¼•ç”¨ Wind å’Œ Percussion å¯¹è±¡ã€‚åœ¨ Instrument å¼•ç”¨è°ƒç”¨ play() æ–¹æ³•æ—¶ï¼Œä¼šæ‰§è¡Œå®é™…å¼•ç”¨å¯¹è±¡æ‰€åœ¨ç±»çš„ play() æ–¹æ³•ï¼Œè€Œä¸æ˜¯ Instrument ç±»çš„æ–¹æ³•ã€‚ 12345678910111213141516171819202122232425262728public class Instrument { public void play() { System.out.println(\"Instrument is playing...\"); }}public class Wind extends Instrument { public void play() { System.out.println(\"Wind is playing...\"); }}public class Percussion extends Instrument { public void play() { System.out.println(\"Percussion is playing...\"); }}public class Music { public static void main(String[] args) { List&lt;Instrument&gt; instruments = new ArrayList&lt;&gt;(); instruments.add(new Wind()); instruments.add(new Percussion()); for(Instrument instrument : instruments) { instrument.play(); } }} a = a + b ä¸ a += b çš„åŒºåˆ«+= éšå¼çš„å°†åŠ æ“ä½œçš„ç»“æœç±»å‹å¼ºåˆ¶è½¬æ¢ä¸ºæŒæœ‰ç»“æœçš„ç±»å‹ã€‚å¦‚æœä¸¤ä¸ªæ•´å‹ç›¸åŠ ï¼Œå¦‚ byteã€short æˆ–è€… intï¼Œé¦–å…ˆä¼šå°†å®ƒä»¬æå‡åˆ° int ç±»å‹ï¼Œç„¶ååœ¨æ‰§è¡ŒåŠ æ³•æ“ä½œã€‚ 1234byte a = 127;byte b = 127;b = a + b; // error : cannot convert from int to byteb += a; // ok (å› ä¸º a+b æ“ä½œä¼šå°† aã€b æå‡ä¸º int ç±»å‹ï¼Œæ‰€ä»¥å°† int ç±»å‹èµ‹å€¼ç»™ byte å°±ä¼šç¼–è¯‘å‡ºé”™) 3*0.1 == 0.3 å°†ä¼šè¿”å›ä»€ä¹ˆ? true è¿˜æ˜¯ false?falseï¼Œå› ä¸ºæœ‰äº›æµ®ç‚¹æ•°ä¸èƒ½å®Œå…¨ç²¾ç¡®çš„è¡¨ç¤ºå‡ºæ¥ã€‚ èƒ½åœ¨ Switch ä¸­ä½¿ç”¨ String å—?ä» Java 7 å¼€å§‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ switch case ä¸­ä½¿ç”¨å­—ç¬¦ä¸²ï¼Œä½†è¿™ä»…ä»…æ˜¯ä¸€ä¸ªè¯­æ³•ç³–ã€‚å†…éƒ¨å®ç°åœ¨ switch ä¸­ä½¿ç”¨å­—ç¬¦ä¸²çš„ hash codeã€‚ å¯¹ equals()å’Œ hashCode()çš„ç†è§£? ä¸ºä»€ä¹ˆåœ¨é‡å†™ equals æ–¹æ³•çš„æ—¶å€™éœ€è¦é‡å†™ hashCode æ–¹æ³•? å› ä¸ºæœ‰å¼ºåˆ¶çš„è§„èŒƒæŒ‡å®šéœ€è¦åŒæ—¶é‡å†™ hashcode ä¸ equals æ˜¯æ–¹æ³•ï¼Œè®¸å¤šå®¹å™¨ç±»ï¼Œå¦‚ HashMapã€HashSet éƒ½ä¾èµ–äº hashcode ä¸ equals çš„è§„å®šã€‚ æœ‰æ²¡æœ‰å¯èƒ½ä¸¤ä¸ªä¸ç›¸ç­‰çš„å¯¹è±¡æœ‰ç›¸åŒçš„ hashcode? æœ‰å¯èƒ½ï¼Œä¸¤ä¸ªä¸ç›¸ç­‰çš„å¯¹è±¡å¯èƒ½ä¼šæœ‰ç›¸åŒçš„ hashcode å€¼ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨ hashmap ä¸­ä¼šæœ‰å†²çªã€‚ç›¸ç­‰ hashcode å€¼çš„è§„å®šåªæ˜¯è¯´å¦‚æœä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰ï¼Œå¿…é¡»æœ‰ç›¸åŒçš„ hashcode å€¼ï¼Œä½†æ˜¯æ²¡æœ‰å…³äºä¸ç›¸ç­‰å¯¹è±¡çš„ä»»ä½•è§„å®šã€‚ ä¸¤ä¸ªç›¸åŒçš„å¯¹è±¡ä¼šæœ‰ä¸åŒçš„ hash code å—? ä¸èƒ½ï¼Œæ ¹æ® hash code çš„è§„å®šï¼Œè¿™æ˜¯ä¸å¯èƒ½çš„ã€‚ finalã€finalize å’Œ finally çš„ä¸åŒä¹‹å¤„? final æ˜¯ä¸€ä¸ªä¿®é¥°ç¬¦ï¼Œå¯ä»¥ä¿®é¥°å˜é‡ã€æ–¹æ³•å’Œç±»ã€‚å¦‚æœ final ä¿®é¥°å˜é‡ï¼Œæ„å‘³ç€è¯¥å˜é‡çš„å€¼åœ¨åˆå§‹åŒ–åä¸èƒ½è¢«æ”¹å˜ã€‚ Java æŠ€æœ¯å…è®¸ä½¿ç”¨ finalize() æ–¹æ³•åœ¨åƒåœ¾æ”¶é›†å™¨å°†å¯¹è±¡ä»å†…å­˜ä¸­æ¸…é™¤å‡ºå»ä¹‹å‰åšå¿…è¦çš„æ¸…ç†å·¥ä½œã€‚è¿™ä¸ªæ–¹æ³•æ˜¯ç”±åƒåœ¾æ”¶é›†å™¨åœ¨ç¡®å®šè¿™ä¸ªå¯¹è±¡æ²¡æœ‰è¢«å¼•ç”¨æ—¶å¯¹è¿™ä¸ªå¯¹è±¡è°ƒç”¨çš„ï¼Œä½†æ˜¯ä»€ä¹ˆæ—¶å€™è°ƒç”¨ finalize æ²¡æœ‰ä¿è¯ã€‚ finally æ˜¯ä¸€ä¸ªå…³é”®å­—ï¼Œä¸ try å’Œ catch ä¸€èµ·ç”¨äºå¼‚å¸¸çš„å¤„ç†ã€‚finally å—ä¸€å®šä¼šè¢«æ‰§è¡Œï¼Œæ— è®ºåœ¨ try å—ä¸­æ˜¯å¦æœ‰å‘ç”Ÿå¼‚å¸¸ã€‚ Stringã€StringBuffer ä¸ StringBuilder çš„åŒºåˆ«ï¼Ÿç¬¬ä¸€ç‚¹: å¯å˜å’Œé€‚ç”¨èŒƒå›´ã€‚String å¯¹è±¡æ˜¯ä¸å¯å˜çš„ï¼Œè€Œ StringBuffer å’Œ StringBuilder æ˜¯å¯å˜å­—ç¬¦åºåˆ—ã€‚æ¯æ¬¡å¯¹ String çš„æ“ä½œç›¸å½“äºç”Ÿæˆä¸€ä¸ªæ–°çš„ String å¯¹è±¡ï¼Œè€Œå¯¹ StringBuffer å’Œ StringBuilder çš„æ“ä½œæ˜¯å¯¹å¯¹è±¡æœ¬èº«çš„æ“ä½œï¼Œè€Œä¸ä¼šç”Ÿæˆæ–°çš„å¯¹è±¡ï¼Œæ‰€ä»¥å¯¹äºé¢‘ç¹æ”¹å˜å†…å®¹çš„å­—ç¬¦ä¸²é¿å…ä½¿ç”¨ Stringï¼Œå› ä¸ºé¢‘ç¹çš„ç”Ÿæˆå¯¹è±¡å°†ä¼šå¯¹ç³»ç»Ÿæ€§èƒ½äº§ç”Ÿå½±å“ã€‚ç¬¬äºŒç‚¹: çº¿ç¨‹å®‰å…¨ã€‚String ç”±äºæœ‰ final ä¿®é¥°ï¼Œæ˜¯ immutable çš„ï¼Œå®‰å…¨æ€§æ˜¯ç®€å•è€Œçº¯ç²¹çš„ã€‚StringBuilder å’Œ StringBuffer çš„åŒºåˆ«åœ¨äº StringBuilder ä¸ä¿è¯åŒæ­¥ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœéœ€è¦çº¿ç¨‹å®‰å…¨éœ€è¦ä½¿ç”¨ StringBufferï¼Œä¸éœ€è¦åŒæ­¥çš„ StringBuilder æ•ˆç‡æ›´é«˜ã€‚ æ¥å£ä¸æŠ½è±¡ç±»çš„åŒºåˆ«ï¼Ÿ ä¸€ä¸ªå­ç±»åªèƒ½ç»§æ‰¿ä¸€ä¸ªæŠ½è±¡ç±», ä½†èƒ½å®ç°å¤šä¸ªæ¥å£ æŠ½è±¡ç±»å¯ä»¥æœ‰æ„é€ æ–¹æ³•, æ¥å£æ²¡æœ‰æ„é€ æ–¹æ³• æŠ½è±¡ç±»å¯ä»¥æœ‰æ™®é€šæˆå‘˜å˜é‡, æ¥å£æ²¡æœ‰æ™®é€šæˆå‘˜å˜é‡ æŠ½è±¡ç±»å’Œæ¥å£éƒ½å¯æœ‰é™æ€æˆå‘˜å˜é‡, æŠ½è±¡ç±»ä¸­é™æ€æˆå‘˜å˜é‡è®¿é—®ç±»å‹ä»»æ„ï¼Œæ¥å£åªèƒ½ public static final(é»˜è®¤) æŠ½è±¡ç±»å¯ä»¥æ²¡æœ‰æŠ½è±¡æ–¹æ³•, æŠ½è±¡ç±»å¯ä»¥æœ‰æ™®é€šæ–¹æ³•ï¼›æ¥å£åœ¨ JDK8 ä¹‹å‰éƒ½æ˜¯æŠ½è±¡æ–¹æ³•ï¼Œåœ¨ JDK8 å¯ä»¥æœ‰ default æ–¹æ³•ï¼Œåœ¨ JDK9 ä¸­å…è®¸æœ‰ç§æœ‰æ™®é€šæ–¹æ³• æŠ½è±¡ç±»å¯ä»¥æœ‰é™æ€æ–¹æ³•ï¼›æ¥å£åœ¨ JDK8 ä¹‹å‰ä¸èƒ½æœ‰é™æ€æ–¹æ³•ï¼Œåœ¨ JDK8 ä¸­å¯ä»¥æœ‰é™æ€æ–¹æ³•ï¼Œä¸”åªèƒ½è¢«æ¥å£ç±»ç›´æ¥è°ƒç”¨ï¼ˆä¸èƒ½è¢«å®ç°ç±»çš„å¯¹è±¡è°ƒç”¨ï¼‰ æŠ½è±¡ç±»ä¸­çš„æ–¹æ³•å¯ä»¥æ˜¯ publicã€protected; æ¥å£æ–¹æ³•åœ¨ JDK8 ä¹‹å‰åªæœ‰ public abstractï¼Œåœ¨ JDK8 å¯ä»¥æœ‰ default æ–¹æ³•ï¼Œåœ¨ JDK9 ä¸­å…è®¸æœ‰ private æ–¹æ³• this() &amp; super()åœ¨æ„é€ æ–¹æ³•ä¸­çš„åŒºåˆ«ï¼Ÿ è°ƒç”¨ super()å¿…é¡»å†™åœ¨å­ç±»æ„é€ æ–¹æ³•çš„ç¬¬ä¸€è¡Œ, å¦åˆ™ç¼–è¯‘ä¸é€šè¿‡ super ä»å­ç±»è°ƒç”¨çˆ¶ç±»æ„é€ , this åœ¨åŒä¸€ç±»ä¸­è°ƒç”¨å…¶ä»–æ„é€ å‡éœ€è¦æ”¾åœ¨ç¬¬ä¸€è¡Œ å°½ç®¡å¯ä»¥ç”¨ this è°ƒç”¨ä¸€ä¸ªæ„é€ å™¨, å´ä¸èƒ½è°ƒç”¨ 2 ä¸ª this å’Œ super ä¸èƒ½å‡ºç°åœ¨åŒä¸€ä¸ªæ„é€ å™¨ä¸­, å¦åˆ™ç¼–è¯‘ä¸é€šè¿‡ this()ã€super()éƒ½æŒ‡çš„å¯¹è±¡,ä¸å¯ä»¥åœ¨ static ç¯å¢ƒä¸­ä½¿ç”¨ æœ¬è´¨ this æŒ‡å‘æœ¬å¯¹è±¡çš„æŒ‡é’ˆã€‚super æ˜¯ä¸€ä¸ªå…³é”®å­— Java ç§»ä½è¿ç®—ç¬¦ï¼Ÿjava ä¸­æœ‰ä¸‰ç§ç§»ä½è¿ç®—ç¬¦ &lt;&lt; :å·¦ç§»è¿ç®—ç¬¦,x &lt;&lt; 1,ç›¸å½“äº x ä¹˜ä»¥ 2(ä¸æº¢å‡ºçš„æƒ…å†µä¸‹),ä½ä½è¡¥ 0 &gt;&gt; :å¸¦ç¬¦å·å³ç§»,x &gt;&gt; 1,ç›¸å½“äº x é™¤ä»¥ 2,æ­£æ•°é«˜ä½è¡¥ 0,è´Ÿæ•°é«˜ä½è¡¥ 1 &gt;&gt;&gt; :æ— ç¬¦å·å³ç§»,å¿½ç•¥ç¬¦å·ä½,ç©ºä½éƒ½ä»¥ 0 è¡¥é½ è½¬è½½é¢è¯•","link":"/2022/07/20/gpdsgr/"},{"title":"linuxå‘½ä»¤","text":"ä¸€äº›æœ‰ç”¨çš„ linux å‘½ä»¤ ç³»ç»Ÿ 123456789uname -a # æŸ¥çœ‹å†…æ ¸ã€æ“ä½œç³»ç»Ÿã€cpuä¿¡æ¯head -n 1 /etc/issue # æŸ¥çœ‹æ“ä½œç³»ç»Ÿç‰ˆæœ¬cat /proc/cpuinfo # æŸ¥çœ‹cpuä¿¡æ¯hostname # æŸ¥çœ‹è®¡ç®—æœºålspci -tv # åˆ—å‡ºæ‰€æœ‰PCIè®¾å¤‡ï¼ˆéœ€è¦yum install pciutilsï¼‰lsusb -tv # åˆ—å‡ºæ‰€æœ‰USBè®¾å¤‡lsmod # åˆ—å‡ºåŠ è½½çš„å†…æ ¸æ¨¡å—env # æŸ¥çœ‹ç¯å¢ƒå˜é‡lspci | grep Ethernet # æŸ¥çœ‹ç½‘å¡å‹å· èµ„æº 1234567free -m # æŸ¥çœ‹å†…å­˜ä½¿ç”¨é‡å’Œäº¤æ¢åŒºä½¿ç”¨é‡df -h # æŸ¥çœ‹å„åˆ†åŒºä½¿ç”¨æƒ…å†µdu -sh &lt;ç›®å½•å&gt; # æŸ¥çœ‹æŒ‡å®šç›®å½•çš„å¤§å°grep MemTotal /proc/meminfo # æŸ¥çœ‹å†…å­˜æ€»é‡grep MemFree /proc/meminfo # æŸ¥çœ‹ç©ºé—²å†…å­˜é‡uptime # æŸ¥çœ‹ç³»ç»Ÿè¿è¡Œæ—¶é—´ã€ç”¨æˆ·æ•°ã€è´Ÿè½½cat /proc/loadavg # æŸ¥çœ‹ç³»ç»Ÿè´Ÿè½½ ç£ç›˜å’Œåˆ†åŒº 12345mount | column -t # æŸ¥çœ‹æŒ‚æ¥çš„åˆ†åŒºçŠ¶æ€fdisk -l # æŸ¥çœ‹æ‰€æœ‰åˆ†åŒºswapon -s # æŸ¥çœ‹æ‰€æœ‰äº¤æ¢åˆ†åŒºhdparm -i /dev/hda # æŸ¥çœ‹ç£ç›˜å‚æ•°(ä»…é€‚ç”¨äºIDEè®¾å¤‡)dmesg | grep IDE # æŸ¥çœ‹å¯åŠ¨æ—¶IDEè®¾å¤‡æ£€æµ‹çŠ¶å†µ ç½‘ç»œ 123456ifconfig # æŸ¥çœ‹æ‰€æœ‰ç½‘ç»œæ¥å£çš„å±æ€§iptables -L # æŸ¥çœ‹é˜²ç«å¢™è®¾ç½®route -n # æŸ¥çœ‹è·¯ç”±è¡¨netstat -lntp # æŸ¥çœ‹æ‰€æœ‰ç›‘å¬ç«¯å£netstat -antp # æŸ¥çœ‹æ‰€æœ‰å·²ç»å»ºç«‹çš„è¿æ¥netstat -s # æŸ¥çœ‹ç½‘ç»œç»Ÿè®¡ä¿¡æ¯ è¿›ç¨‹ 12ps -ef # æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹top # å®æ—¶æ˜¾ç¤ºè¿›ç¨‹çŠ¶æ€ ç¨‹åº 1pm -qa # æŸ¥çœ‹æ‰€æœ‰å®‰è£…çš„è½¯ä»¶åŒ… æœåŠ¡ 12chkconfig --list # åˆ—å‡ºæ‰€æœ‰ç³»ç»ŸæœåŠ¡chkconfig --list | grep on # åˆ—å‡ºæ‰€æœ‰å¯åŠ¨çš„ç³»ç»ŸæœåŠ¡","link":"/2020/04/28/fotwg6/"},{"title":"åšå®¢ç¬¬ä¸€æœŸ","text":"è¯¥åšå®¢æ¨¡ç‰ˆæ¡ˆä¾‹æ¥è‡ª @èš‚èšé‡‘æœä½“éªŒæŠ€æœ¯éƒ¨ æ’å…¥å¸¦é“¾æ¥çš„æ ‡é¢˜ï¼ˆctrl+Kï¼‰Best Year in Musicè¿™å¹…å¯è§†åŒ–ä½œå“å±•ç¤ºäº† 1960 å¹´ä»¥æ¥ï¼ŒBillboard å†å¹´æ¦œå•çš„å‰äº”åéŸ³ä¹çš„å˜åŒ–æƒ…å†µï¼Œæ•ˆæœå‘ˆç°è®¾è®¡æ„Ÿåè¶³ï¼Œè¿˜å¯ä»¥åœ¨è†å¬éŸ³ä¹çš„åŒæ—¶å›é¡¾éŸ³ä¹çš„å˜è¿å²ã€‚æ’å…¥å›¾ç‰‡ï¼Œç‚¹å‡»å›¾ç‰‡ï¼Œè®¾ç½®å›¾ç‰‡å¤§å°å€¼å¾—ä¸€æçš„æ˜¯ï¼Œä½œè€…æ­£æ˜¯å¤§åé¼é¼çš„æ•°æ®æ–°é—»ç«™ç‚¹ The Puddingã€‚ä½œä¸ºå¯è§†åŒ–æ–°é—»åª’ä½“ä¸­çš„å§£å§£è€…ï¼ŒThe Pudding æ“…é•¿å¯¹é‚£äº›å…¼å…·ä¿¡æ¯é‡å’Œå¨±ä¹åº¦çš„äº‰è®®æ€§è¯é¢˜è¿›è¡Œå¯è§†åŒ–å‘ˆç°ï¼Œæ¥ä½¿å¾—å¤æ‚çš„è§‚ç‚¹å˜å¾—æ›´å®¹æ˜“è¢«å…¬ä¼—ç†è§£ã€‚è¯¥å›¢é˜Ÿè™½ç„¶ä»…ç”±æ•°åå…¨èŒè®°è€…å’Œå·¥ç¨‹å¸ˆç»„æˆï¼Œä½†æˆ˜æ–—åŠ›å¼ºæ‚ï¼Œç›®å‰å·²æœ‰æ•°åä¸ªå¤§å‹çš„æ•°æ®å¯è§†åŒ–ä½œå“ã€‚è¾“å…¥ä½œè€… @è¯¸å²³(dengfuping) Road Suffixes in the USAç¾å›½é“è·¯å‘½åå¤šç§å¤šæ ·ï¼Œä¾‹å¦‚è‘—åçš„çº½çº¦ç¬¬äº”å¤§é“ï¼ˆFifth Avenueï¼‰ï¼Œåˆæˆ–è€…å‡¤å‡°åŸï¼ˆPhoenixï¼‰çš„ Washington Streetï¼ŒThomas Roadï¼ŒUnion Hill Drive ç­‰ã€‚ä¸åŒçš„é“è·¯ï¼Œæœ‰ä¸åŒçš„å«æ³•ï¼ŒAvenue, Street, Road, Drive ç­‰ç­‰ã€‚æƒ³äº†è§£æ›´å¤šå…³äºç¾å›½é“è·¯å‘½åå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ã€‚ä½œè€…ç”¨ R è¯­è¨€ç»Ÿè®¡äº†ç¾å›½æ¯ä¸ªå¿çš„æ¯ç§é“è·¯åç¼€ï¼ˆä¾‹å¦‚ Avenueï¼‰çš„æ€»é‡Œç¨‹ï¼Œå¹¶æŠŠæ¯ä¸ªå¿æ€»é‡Œç¨‹æœ€å¤§çš„é“è·¯åç¼€é€šè¿‡é¢œè‰²æ˜ å°„åˆ°åœ°å›¾ä¸Šã€‚å¯ä»¥çœ‹å‡ºç¾å›½å¤§éƒ¨åˆ†å¿çš„é“è·¯éƒ½æ˜¯ä»¥ Rd(Road çš„ç¼©å†™)ç»“å°¾çš„ã€‚æ’å…¥å›¾ç‰‡ï¼Œç‚¹å‡»å›¾ç‰‡ï¼Œè®¾ç½®å›¾ç‰‡å¤§å° å¦å¤–è¿˜ä»¥æŸ±çŠ¶å›¾çš„æ–¹å¼å±•ç¤ºäº†æ¯ç§é“è·¯åç¼€çš„æ€»é‡Œç¨‹ï¼ˆè‹±é‡Œï¼‰ï¼šby @é•¿å“²(changzhe) ã€ŒåŠ é¤ã€Hello World å›¾å¯è§†åŒ–å›¾å¯è§†åŒ–æ˜¯ä¿¡æ¯å¯è§†åŒ–çš„å­é¢†åŸŸï¼Œå®ƒé€šè¿‡å±•ç¤ºå…ƒç´ ã€å…³ç³»ï¼Œå¸®åŠ©ç”¨æˆ·è·å–æ•°æ®çš„æ´æ‚‰èƒ½åŠ›ã€‚å®ƒå·²è¢«å¹¿æ³›åœ°åº”ç”¨åœ¨æµç¨‹å›¾ã€ç¤¾äº¤ç½‘ç»œã€è‹±ç‰¹ç½‘ã€è›‹ç™½è´¨ç½‘ç»œç­‰å…³ç³»æ•°æ®çš„å‘ˆç°ã€‚æœ¬æ–‡ç”± AntV å›¢é˜Ÿ @åå¾(shiwu-5wap2) ğŸ‘† æ’°å†™ï¼Œå‚è€ƒè‡ª[1][2]ä¸¤ç¯‡å›¾å¯è§†åŒ–å­¦æœ¯è®ºæ–‡ï¼Œç®€è¦ä»‹ç»å›¾å¯è§†åŒ–çš„å†å²ã€èƒŒæ™¯ã€æœºé‡ä¸æŒ‘æˆ˜ã€‚","link":"/2020/04/22/ny150b/"},{"title":"æµ‹è¯•ä¸€ä¸‹font-formatter","text":"æµ‹è¯•è¯­é›€ front-matter æ²¡æœ‰å†…å®¹äº†","link":"/2020/04/22/wvwguf/"},{"title":"é¢è¯•å®˜é—®åˆ†å¸ƒå¼æŠ€æœ¯é¢è¯•é¢˜ï¼Œä¸€è„¸æ‡µé€¼æ€ä¹ˆåŠ?","text":"åˆ†å¸ƒå¼ç¼“å­˜ï¼Œåˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—ï¼Œåˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶** è½¬è½½äºï¼šhttps://my.oschina.net/u/3728792/blog/3042368 1.åˆ†å¸ƒå¼ç¼“å­˜1.1 Redis æœ‰ä»€ä¹ˆæ•°æ®ç±»å‹ï¼Ÿåˆ†åˆ«ç”¨äºä»€ä¹ˆåœºæ™¯ï¼Ÿ æ•°æ®ç±»å‹ å¯ä»¥å­˜å‚¨çš„å€¼ æ“ä½œ STRING å­—ç¬¦ä¸²ã€æ•´æ•°æˆ–è€…æµ®ç‚¹æ•° å¯¹æ•´ä¸ªå­—ç¬¦ä¸²æˆ–è€…å­—ç¬¦ä¸²çš„å…¶ä¸­ä¸€éƒ¨åˆ†æ‰§è¡Œæ“ä½œ å¯¹æ•´æ•°å’Œæµ®ç‚¹æ•°æ‰§è¡Œè‡ªå¢æˆ–è€…è‡ªå‡æ“ä½œ LIST åˆ—è¡¨ ä»ä¸¤ç«¯å‹å…¥æˆ–è€…å¼¹å‡ºå…ƒç´  è¯»å–å•ä¸ªæˆ–è€…å¤šä¸ªå…ƒç´ è¿›è¡Œä¿®å‰ªï¼Œåªä¿ç•™ä¸€ä¸ªèŒƒå›´å†…çš„å…ƒç´  || SET | æ— åºé›†åˆ | æ·»åŠ ã€è·å–ã€ç§»é™¤å•ä¸ªå…ƒç´ æ£€æŸ¥ä¸€ä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨äºé›†åˆä¸­è®¡ç®—äº¤é›†ã€å¹¶é›†ã€å·®é›†ä»é›†åˆé‡Œé¢éšæœºè·å–å…ƒç´  || HASH | åŒ…å«é”®å€¼å¯¹çš„æ— åºæ•£åˆ—è¡¨ | æ·»åŠ ã€è·å–ã€ç§»é™¤å•ä¸ªé”®å€¼å¯¹è·å–æ‰€æœ‰é”®å€¼å¯¹æ£€æŸ¥æŸä¸ªé”®æ˜¯å¦å­˜åœ¨ || ZSET | æœ‰åºé›†åˆ | æ·»åŠ ã€è·å–ã€åˆ é™¤å…ƒç´ æ ¹æ®åˆ†å€¼èŒƒå›´æˆ–è€…æˆå‘˜æ¥è·å–å…ƒç´ è®¡ç®—ä¸€ä¸ªé”®çš„æ’å | è¯¦ç»†æ–‡æ¡£ï¼šhttps://redislabs.com/ebook/part-1-getting-started/chapter-1-getting-to-know-redis/1-2-what-redis-data-structures-look-like/ 1.2. Redis çš„ä¸»ä»å¤åˆ¶æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ ä»æœåŠ¡å™¨è¿æ¥ä¸»æœåŠ¡å™¨ï¼Œå‘é€ SYNC å‘½ä»¤ï¼› ä¸»æœåŠ¡å™¨æ¥æ”¶åˆ° SYNC å‘½ååï¼Œå¼€å§‹æ‰§è¡Œ BGSAVE å‘½ä»¤ç”Ÿæˆ RDB æ–‡ä»¶å¹¶ä½¿ç”¨ç¼“å†²åŒºè®°å½•æ­¤åæ‰§è¡Œçš„æ‰€æœ‰å†™å‘½ä»¤ï¼› ä¸»æœåŠ¡å™¨ BGSAVE æ‰§è¡Œå®Œåï¼Œå‘æ‰€æœ‰ä»æœåŠ¡å™¨å‘é€å¿«ç…§æ–‡ä»¶ï¼Œå¹¶åœ¨å‘é€æœŸé—´ç»§ç»­è®°å½•è¢«æ‰§è¡Œçš„å†™å‘½ä»¤ï¼› ä»æœåŠ¡å™¨æ”¶åˆ°å¿«ç…§æ–‡ä»¶åä¸¢å¼ƒæ‰€æœ‰æ—§æ•°æ®ï¼Œè½½å…¥æ”¶åˆ°çš„å¿«ç…§ï¼› ä¸»æœåŠ¡å™¨å¿«ç…§å‘é€å®Œæ¯•åå¼€å§‹å‘ä»æœåŠ¡å™¨å‘é€ç¼“å†²åŒºä¸­çš„å†™å‘½ä»¤ï¼› ä»æœåŠ¡å™¨å®Œæˆå¯¹å¿«ç…§çš„è½½å…¥ï¼Œå¼€å§‹æ¥æ”¶å‘½ä»¤è¯·æ±‚ï¼Œå¹¶æ‰§è¡Œæ¥è‡ªä¸»æœåŠ¡å™¨ç¼“å†²åŒºçš„å†™å‘½ä»¤ï¼› 1.3. Redis çš„ key æ˜¯å¦‚ä½•å¯»å€çš„ï¼ŸèƒŒæ™¯ ï¼ˆ1ï¼‰redis ä¸­çš„æ¯ä¸€ä¸ªæ•°æ®åº“ï¼Œéƒ½ç”±ä¸€ä¸ª redisDb çš„ç»“æ„å­˜å‚¨ã€‚å…¶ä¸­ï¼š redisDb.id å­˜å‚¨ç€ redis æ•°æ®åº“ä»¥æ•´æ•°è¡¨ç¤ºçš„å·ç ã€‚ redisDb.dict å­˜å‚¨ç€è¯¥åº“æ‰€æœ‰çš„é”®å€¼å¯¹æ•°æ®ã€‚ redisDb.expires ä¿å­˜ç€æ¯ä¸€ä¸ªé”®çš„è¿‡æœŸæ—¶é—´ã€‚ ï¼ˆ2ï¼‰å½“ redis æœåŠ¡å™¨åˆå§‹åŒ–æ—¶ï¼Œä¼šé¢„å…ˆåˆ†é… 16 ä¸ªæ•°æ®åº“ï¼ˆè¯¥æ•°é‡å¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶é…ç½®ï¼‰ï¼Œæ‰€æœ‰æ•°æ®åº“ä¿å­˜åˆ°ç»“æ„ redisServerçš„ä¸€ä¸ªæˆå‘˜ redisServer.db æ•°ç»„ä¸­ã€‚å½“æˆ‘ä»¬é€‰æ‹©æ•°æ®åº“ select number æ—¶ï¼Œç¨‹åºç›´æ¥é€šè¿‡redisServer.db[number] æ¥åˆ‡æ¢æ•°æ®åº“ã€‚æœ‰æ—¶å€™å½“ç¨‹åºéœ€è¦çŸ¥é“è‡ªå·±æ˜¯åœ¨å“ªä¸ªæ•°æ®åº“æ—¶ï¼Œç›´æ¥è¯»å– redisDb.id å³å¯ã€‚ï¼ˆ3ï¼‰redis çš„å­—å…¸ä½¿ç”¨å“ˆå¸Œè¡¨ä½œä¸ºå…¶åº•å±‚å®ç°ã€‚dict ç±»å‹ä½¿ç”¨çš„ä¸¤ä¸ªæŒ‡å‘å“ˆå¸Œè¡¨çš„æŒ‡é’ˆï¼Œå…¶ä¸­ 0å·å“ˆå¸Œè¡¨ï¼ˆht[0]ï¼‰ä¸»è¦ç”¨äºå­˜å‚¨æ•°æ®åº“çš„æ‰€æœ‰é”®å€¼ï¼Œè€Œ 1 å·å“ˆå¸Œè¡¨ä¸»è¦ç”¨äºç¨‹åºå¯¹ 0 å·å“ˆå¸Œè¡¨è¿›è¡Œ rehash æ—¶ä½¿ç”¨ï¼Œrehashä¸€èˆ¬æ˜¯åœ¨æ·»åŠ æ–°å€¼æ—¶ä¼šè§¦å‘ï¼Œè¿™é‡Œä¸åšè¿‡å¤šçš„èµ˜è¿°ã€‚æ‰€ä»¥ redis ä¸­æŸ¥æ‰¾ä¸€ä¸ª keyï¼Œå…¶å®å°±æ˜¯å¯¹è¿›è¡Œè¯¥ dict ç»“æ„ä¸­çš„ ht[0]è¿›è¡ŒæŸ¥æ‰¾æ“ä½œã€‚ï¼ˆ4ï¼‰æ—¢ç„¶æ˜¯å“ˆå¸Œï¼Œé‚£ä¹ˆæˆ‘ä»¬çŸ¥é“å°±ä¼šæœ‰å“ˆå¸Œç¢°æ’ï¼Œé‚£ä¹ˆå½“å¤šä¸ªé”®å“ˆå¸Œä¹‹åä¸ºåŒä¸€ä¸ªå€¼æ€ä¹ˆåŠå‘¢ï¼Ÿredisé‡‡å–é“¾è¡¨çš„æ–¹å¼æ¥å­˜å‚¨å¤šä¸ªå“ˆå¸Œç¢°æ’çš„é”®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æ ¹æ® key çš„å“ˆå¸Œå€¼æ‰¾åˆ°è¯¥åˆ—è¡¨åï¼Œå¦‚æœåˆ—è¡¨çš„é•¿åº¦å¤§äº1ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦éå†è¯¥é“¾è¡¨æ¥æ‰¾åˆ°æˆ‘ä»¬æ‰€æŸ¥æ‰¾çš„ keyã€‚å½“ç„¶ï¼Œä¸€èˆ¬æƒ…å†µä¸‹é“¾è¡¨é•¿åº¦éƒ½ä¸ºæ˜¯ 1ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦å¯çœ‹ä½œ o(1)ã€‚ å¯»å€ key çš„æ­¥éª¤ å½“æ‹¿åˆ°ä¸€ä¸ª key åï¼Œredis å…ˆåˆ¤æ–­å½“å‰åº“çš„ 0 å·å“ˆå¸Œè¡¨æ˜¯å¦ä¸ºç©ºï¼Œå³ï¼šif (dict-&gt;ht[0].size == 0)ã€‚å¦‚æœä¸º true ç›´æ¥è¿”å› NULLã€‚ åˆ¤æ–­è¯¥ 0 å·å“ˆå¸Œè¡¨æ˜¯å¦éœ€è¦ rehashï¼Œå› ä¸ºå¦‚æœåœ¨è¿›è¡Œ rehashï¼Œé‚£ä¹ˆä¸¤ä¸ªè¡¨ä¸­è€…æœ‰å¯èƒ½å­˜å‚¨è¯¥ keyã€‚å¦‚æœæ­£åœ¨è¿›è¡Œrehashï¼Œå°†è°ƒç”¨ä¸€æ¬¡_dictRehashStep æ–¹æ³•ï¼Œ_dictRehashStep ç”¨äºå¯¹æ•°æ®åº“å­—å…¸ã€ä»¥åŠå“ˆå¸Œé”®çš„å­—å…¸è¿›è¡Œè¢«åŠ¨rehashï¼Œè¿™é‡Œä¸ä½œèµ˜è¿°ã€‚ è®¡ç®—å“ˆå¸Œè¡¨ï¼Œæ ¹æ®å½“å‰å­—å…¸ä¸ key è¿›è¡Œå“ˆå¸Œå€¼çš„è®¡ç®—ã€‚ æ ¹æ®å“ˆå¸Œå€¼ä¸å½“å‰å­—å…¸è®¡ç®—å“ˆå¸Œè¡¨çš„ç´¢å¼•å€¼ã€‚ æ ¹æ®ç´¢å¼•å€¼åœ¨å“ˆå¸Œè¡¨ä¸­å–å‡ºé“¾è¡¨ï¼Œéå†è¯¥é“¾è¡¨æ‰¾åˆ° key çš„ä½ç½®ã€‚ä¸€èˆ¬æƒ…å†µï¼Œè¯¥é“¾è¡¨é•¿åº¦ä¸º 1ã€‚ å½“ ht[0] æŸ¥æ‰¾å®Œäº†ä¹‹åï¼Œå†è¿›è¡Œäº†æ¬¡ rehash åˆ¤æ–­ï¼Œå¦‚æœæœªåœ¨ rehashingï¼Œåˆ™ç›´æ¥ç»“æŸï¼Œå¦åˆ™å¯¹ ht[1]é‡å¤ 345 æ­¥éª¤ã€‚ 1.4. Redis çš„é›†ç¾¤æ¨¡å¼æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ Redis Cluster æ˜¯ Redis çš„åˆ†å¸ƒå¼è§£å†³æ–¹æ¡ˆï¼Œåœ¨ Redis 3.0 ç‰ˆæœ¬æ­£å¼æ¨å‡ºçš„ã€‚Redis Cluster å»ä¸­å¿ƒåŒ–ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¿å­˜æ•°æ®å’Œæ•´ä¸ªé›†ç¾¤çŠ¶æ€ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½å’Œå…¶ä»–æ‰€æœ‰èŠ‚ç‚¹è¿æ¥ã€‚ Redis Cluster èŠ‚ç‚¹åˆ†é… Redis Cluster ç‰¹ç‚¹ï¼š æ‰€æœ‰çš„ redis èŠ‚ç‚¹å½¼æ­¤äº’è”(PING-PONG æœºåˆ¶)ï¼Œå†…éƒ¨ä½¿ç”¨äºŒè¿›åˆ¶åè®®ä¼˜åŒ–ä¼ è¾“é€Ÿåº¦å’Œå¸¦å®½ã€‚ èŠ‚ç‚¹çš„ fail æ˜¯é€šè¿‡é›†ç¾¤ä¸­è¶…è¿‡åŠæ•°çš„èŠ‚ç‚¹æ£€æµ‹å¤±æ•ˆæ—¶æ‰ç”Ÿæ•ˆã€‚ å®¢æˆ·ç«¯ä¸ redis èŠ‚ç‚¹ç›´è¿,ä¸éœ€è¦ä¸­é—´ proxy å±‚ã€‚å®¢æˆ·ç«¯ä¸éœ€è¦è¿æ¥é›†ç¾¤æ‰€æœ‰èŠ‚ç‚¹ï¼Œè¿æ¥é›†ç¾¤ä¸­ä»»ä½•ä¸€ä¸ªå¯ç”¨èŠ‚ç‚¹å³å¯ã€‚ redis-cluster æŠŠæ‰€æœ‰çš„ç‰©ç†èŠ‚ç‚¹æ˜ å°„åˆ°[0-16383] å“ˆå¸Œæ§½ (hash slot)ä¸Šï¼ˆä¸ä¸€å®šæ˜¯å¹³å‡åˆ†é…ï¼‰,cluster è´Ÿè´£ç»´æŠ¤ nodeã€slotã€valueã€‚ Redis é›†ç¾¤é¢„åˆ†å¥½ 16384 ä¸ªæ¡¶ï¼Œå½“éœ€è¦åœ¨ Redis é›†ç¾¤ä¸­æ”¾ç½®ä¸€ä¸ª key-value æ—¶ï¼Œæ ¹æ® CRC16(key) mod 16384 çš„å€¼ï¼Œå†³å®šå°†ä¸€ä¸ª key æ”¾åˆ°å“ªä¸ªæ¡¶ä¸­ã€‚ Redis Cluster ä¸»ä»æ¨¡å¼ Redis Cluster ä¸ºäº†ä¿è¯æ•°æ®çš„é«˜å¯ç”¨æ€§ï¼ŒåŠ å…¥äº†ä¸»ä»æ¨¡å¼ã€‚ä¸€ä¸ªä¸»èŠ‚ç‚¹å¯¹åº”ä¸€ä¸ªæˆ–å¤šä¸ªä»èŠ‚ç‚¹ï¼Œä¸»èŠ‚ç‚¹æä¾›æ•°æ®å­˜å–ï¼Œä»èŠ‚ç‚¹åˆ™æ˜¯ä»ä¸»èŠ‚ç‚¹æ‹‰å–æ•°æ®å¤‡ä»½ã€‚å½“è¿™ä¸ªä¸»èŠ‚ç‚¹æŒ‚æ‰åï¼Œå°±ä¼šæœ‰è¿™ä¸ªä»èŠ‚ç‚¹é€‰å–ä¸€ä¸ªæ¥å……å½“ä¸»èŠ‚ç‚¹ï¼Œä»è€Œä¿è¯é›†ç¾¤ä¸ä¼šæŒ‚æ‰ã€‚æ‰€ä»¥ï¼Œåœ¨é›†ç¾¤å»ºç«‹çš„æ—¶å€™ï¼Œä¸€å®šè¦ä¸ºæ¯ä¸ªä¸»èŠ‚ç‚¹éƒ½æ·»åŠ äº†ä»èŠ‚ç‚¹ã€‚ Redis Sentinel Redis Sentinel ç”¨äºç®¡ç†å¤šä¸ª Redis æœåŠ¡å™¨ï¼Œå®ƒæœ‰ä¸‰ä¸ªåŠŸèƒ½ï¼š ç›‘æ§ï¼ˆMonitoringï¼‰ - Sentinel ä¼šä¸æ–­åœ°æ£€æŸ¥ä½ çš„ä¸»æœåŠ¡å™¨å’Œä»æœåŠ¡å™¨æ˜¯å¦è¿ä½œæ­£å¸¸ã€‚ æé†’ï¼ˆNotificationï¼‰ - å½“è¢«ç›‘æ§çš„æŸä¸ª Redis æœåŠ¡å™¨å‡ºç°é—®é¢˜æ—¶ï¼Œ Sentinel å¯ä»¥é€šè¿‡ API å‘ç®¡ç†å‘˜æˆ–è€…å…¶ä»–åº”ç”¨ç¨‹åºå‘é€é€šçŸ¥ã€‚ è‡ªåŠ¨æ•…éšœè¿ç§»ï¼ˆAutomatic failoverï¼‰ - å½“ä¸€ä¸ªä¸»æœåŠ¡å™¨ä¸èƒ½æ­£å¸¸å·¥ä½œæ—¶ï¼ŒSentinel ä¼šå¼€å§‹ä¸€æ¬¡è‡ªåŠ¨æ•…éšœè¿ç§»æ“ä½œï¼Œ å®ƒä¼šå°†å¤±æ•ˆä¸»æœåŠ¡å™¨çš„å…¶ä¸­ä¸€ä¸ªä»æœåŠ¡å™¨å‡çº§ä¸ºæ–°çš„ä¸»æœåŠ¡å™¨ï¼Œå¹¶è®©å¤±æ•ˆä¸»æœåŠ¡å™¨çš„å…¶ä»–ä»æœåŠ¡å™¨æ”¹ä¸ºå¤åˆ¶æ–°çš„ä¸»æœåŠ¡å™¨ï¼› å½“å®¢æˆ·ç«¯è¯•å›¾è¿æ¥å¤±æ•ˆçš„ä¸»æœåŠ¡å™¨æ—¶ï¼Œ é›†ç¾¤ä¹Ÿä¼šå‘å®¢æˆ·ç«¯è¿”å›æ–°ä¸»æœåŠ¡å™¨çš„åœ°å€ï¼Œä½¿å¾—é›†ç¾¤å¯ä»¥ä½¿ç”¨æ–°ä¸»æœåŠ¡å™¨ä»£æ›¿å¤±æ•ˆæœåŠ¡å™¨ã€‚ 12345678910Redis é›†ç¾¤ä¸­åº”è¯¥æœ‰å¥‡æ•°ä¸ªèŠ‚ç‚¹ï¼Œæ‰€ä»¥è‡³å°‘æœ‰ä¸‰ä¸ªèŠ‚ç‚¹ã€‚å“¨å…µç›‘æ§é›†ç¾¤ä¸­çš„ä¸»æœåŠ¡å™¨å‡ºç°æ•…éšœæ—¶ï¼Œéœ€è¦æ ¹æ® quorum é€‰ä¸¾å‡ºä¸€ä¸ªå“¨å…µæ¥æ‰§è¡Œæ•…éšœè½¬ç§»ã€‚é€‰ä¸¾éœ€è¦majorityï¼Œå³å¤§å¤šæ•°å“¨å…µæ˜¯è¿è¡Œçš„ï¼ˆ2 ä¸ªå“¨å…µçš„ majority=2ï¼Œ3 ä¸ªå“¨å…µçš„ majority=2ï¼Œ5 ä¸ªå“¨å…µçš„majority=3ï¼Œ4 ä¸ªå“¨å…µçš„ majority=2ï¼‰ã€‚å‡è®¾é›†ç¾¤ä»…ä»…éƒ¨ç½² 2 ä¸ªèŠ‚ç‚¹+----+ +----+| M1 |---------| R1 || S1 | | S2 |+----+ +----+å¦‚æœ M1 å’Œ S1 æ‰€åœ¨æœåŠ¡å™¨å®•æœºï¼Œåˆ™å“¨å…µåªæœ‰ 1 ä¸ªï¼Œæ— æ³•æ»¡è¶³ majority æ¥è¿›è¡Œé€‰ä¸¾ï¼Œå°±ä¸èƒ½æ‰§è¡Œæ•…éšœè½¬ç§»ã€‚ 1.5. Redis å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”ï¼ŸZooKeeper å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”ï¼Ÿæ¯”è¾ƒäºŒè€…ä¼˜åŠ£ï¼Ÿ åˆ†å¸ƒå¼é”çš„ä¸‰ç§å®ç°ï¼š åŸºäºæ•°æ®åº“å®ç°åˆ†å¸ƒå¼é”ï¼› åŸºäºç¼“å­˜ï¼ˆRedis ç­‰ï¼‰å®ç°åˆ†å¸ƒå¼é”ï¼› åŸºäº Zookeeper å®ç°åˆ†å¸ƒå¼é”ï¼› æ•°æ®åº“å®ç°Redis å®ç° è·å–é”çš„æ—¶å€™ï¼Œä½¿ç”¨ setnx åŠ é”ï¼Œå¹¶ä½¿ç”¨ expire å‘½ä»¤ä¸ºé”æ·»åŠ ä¸€ä¸ªè¶…æ—¶æ—¶é—´ï¼Œè¶…è¿‡è¯¥æ—¶é—´åˆ™è‡ªåŠ¨é‡Šæ”¾é”ï¼Œé”çš„ value å€¼ä¸ºä¸€ä¸ªéšæœºç”Ÿæˆçš„ UUIDï¼Œé€šè¿‡æ­¤åœ¨é‡Šæ”¾é”çš„æ—¶å€™è¿›è¡Œåˆ¤æ–­ã€‚ è·å–é”çš„æ—¶å€™è¿˜è®¾ç½®ä¸€ä¸ªè·å–çš„è¶…æ—¶æ—¶é—´ï¼Œè‹¥è¶…è¿‡è¿™ä¸ªæ—¶é—´åˆ™æ”¾å¼ƒè·å–é”ã€‚ é‡Šæ”¾é”çš„æ—¶å€™ï¼Œé€šè¿‡ UUID åˆ¤æ–­æ˜¯ä¸æ˜¯è¯¥é”ï¼Œè‹¥æ˜¯è¯¥é”ï¼Œåˆ™æ‰§è¡Œ delete è¿›è¡Œé”é‡Šæ”¾ã€‚ ZooKeeper å®ç° åˆ›å»ºä¸€ä¸ªç›®å½• mylockï¼› çº¿ç¨‹ A æƒ³è·å–é”å°±åœ¨ mylock ç›®å½•ä¸‹åˆ›å»ºä¸´æ—¶é¡ºåºèŠ‚ç‚¹ï¼› è·å– mylock ç›®å½•ä¸‹æ‰€æœ‰çš„å­èŠ‚ç‚¹ï¼Œç„¶åè·å–æ¯”è‡ªå·±å°çš„å…„å¼ŸèŠ‚ç‚¹ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¯´æ˜å½“å‰çº¿ç¨‹é¡ºåºå·æœ€å°ï¼Œè·å¾—é”ï¼› çº¿ç¨‹ B è·å–æ‰€æœ‰èŠ‚ç‚¹ï¼Œåˆ¤æ–­è‡ªå·±ä¸æ˜¯æœ€å°èŠ‚ç‚¹ï¼Œè®¾ç½®ç›‘å¬æ¯”è‡ªå·±æ¬¡å°çš„èŠ‚ç‚¹ï¼› çº¿ç¨‹ A å¤„ç†å®Œï¼Œåˆ é™¤è‡ªå·±çš„èŠ‚ç‚¹ï¼Œçº¿ç¨‹ B ç›‘å¬åˆ°å˜æ›´äº‹ä»¶ï¼Œåˆ¤æ–­è‡ªå·±æ˜¯ä¸æ˜¯æœ€å°çš„èŠ‚ç‚¹ï¼Œå¦‚æœæ˜¯åˆ™è·å¾—é”ã€‚ å®ç°å¯¹æ¯” ZooKeeper å…·å¤‡é«˜å¯ç”¨ã€å¯é‡å…¥ã€é˜»å¡é”ç‰¹æ€§ï¼Œå¯è§£å†³å¤±æ•ˆæ­»é”é—®é¢˜ã€‚ ä½† ZooKeeper å› ä¸ºéœ€è¦é¢‘ç¹çš„åˆ›å»ºå’Œåˆ é™¤èŠ‚ç‚¹ï¼Œæ€§èƒ½ä¸Šä¸å¦‚ Redis æ–¹å¼ã€‚ 1.6. Redis çš„æŒä¹…åŒ–æ–¹å¼ï¼Ÿæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼ŸæŒä¹…åŒ–å®ç°åŸç†ï¼ŸRDB å¿«ç…§ï¼ˆsnapshotï¼‰ å°†å­˜åœ¨äºæŸä¸€æ—¶åˆ»çš„æ‰€æœ‰æ•°æ®éƒ½å†™å…¥åˆ°ç¡¬ç›˜ä¸­ã€‚å¿«ç…§çš„åŸç†åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒRedis å°†æ•°æ®åº“å¿«ç…§ä¿å­˜åœ¨åå­—ä¸º dump.rdb çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ã€‚ä½ å¯ä»¥å¯¹ Redis è¿›è¡Œè®¾ç½®ï¼Œ è®©å®ƒåœ¨â€œNç§’å†…æ•°æ®é›†è‡³å°‘æœ‰ M ä¸ªæ”¹åŠ¨â€è¿™ä¸€æ¡ä»¶è¢«æ»¡è¶³æ—¶ï¼Œ è‡ªåŠ¨ä¿å­˜ä¸€æ¬¡æ•°æ®é›†ã€‚ä½ ä¹Ÿå¯ä»¥é€šè¿‡è°ƒç”¨ SAVE æˆ–è€… BGSAVEï¼Œæ‰‹åŠ¨è®© Redisè¿›è¡Œæ•°æ®é›†ä¿å­˜æ“ä½œã€‚è¿™ç§æŒä¹…åŒ–æ–¹å¼è¢«ç§°ä¸ºå¿«ç…§ã€‚å½“ Redis éœ€è¦ä¿å­˜ dump.rdb æ–‡ä»¶æ—¶ï¼Œ æœåŠ¡å™¨æ‰§è¡Œä»¥ä¸‹æ“ä½œ: Redis åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ã€‚ å­è¿›ç¨‹å°†æ•°æ®é›†å†™å…¥åˆ°ä¸€ä¸ªä¸´æ—¶å¿«ç…§æ–‡ä»¶ä¸­ã€‚ å½“å­è¿›ç¨‹å®Œæˆå¯¹æ–°å¿«ç…§æ–‡ä»¶çš„å†™å…¥æ—¶ï¼ŒRedis ç”¨æ–°å¿«ç…§æ–‡ä»¶æ›¿æ¢åŸæ¥çš„å¿«ç…§æ–‡ä»¶ï¼Œå¹¶åˆ é™¤æ—§çš„å¿«ç…§æ–‡ä»¶ã€‚ è¿™ç§å·¥ä½œæ–¹å¼ä½¿å¾— Redis å¯ä»¥ä»å†™æ—¶å¤åˆ¶ï¼ˆcopy-on-writeï¼‰æœºåˆ¶ä¸­è·ç›Šã€‚å¿«ç…§çš„ä¼˜ç‚¹ å®ƒä¿å­˜äº†æŸä¸ªæ—¶é—´ç‚¹çš„æ•°æ®é›†ï¼Œéå¸¸é€‚ç”¨äºæ•°æ®é›†çš„å¤‡ä»½ã€‚ å¾ˆæ–¹ä¾¿ä¼ é€åˆ°å¦ä¸€ä¸ªè¿œç«¯æ•°æ®ä¸­å¿ƒæˆ–è€…äºšé©¬é€Šçš„ S3ï¼ˆå¯èƒ½åŠ å¯†ï¼‰ï¼Œéå¸¸é€‚ç”¨äºç¾éš¾æ¢å¤ã€‚ å¿«ç…§åœ¨ä¿å­˜ RDB æ–‡ä»¶æ—¶çˆ¶è¿›ç¨‹å”¯ä¸€éœ€è¦åšçš„å°±æ˜¯ fork å‡ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œæ¥ä¸‹æ¥çš„å·¥ä½œå…¨éƒ¨ç”±å­è¿›ç¨‹æ¥åšï¼Œçˆ¶è¿›ç¨‹ä¸éœ€è¦å†åšå…¶ä»– IO æ“ä½œï¼Œæ‰€ä»¥å¿«ç…§æŒä¹…åŒ–æ–¹å¼å¯ä»¥æœ€å¤§åŒ– redis çš„æ€§èƒ½ã€‚ ä¸ AOF ç›¸æ¯”ï¼Œåœ¨æ¢å¤å¤§çš„æ•°æ®é›†çš„æ—¶å€™ï¼ŒDB æ–¹å¼ä¼šæ›´å¿«ä¸€äº›ã€‚ å¿«ç…§çš„ç¼ºç‚¹ å¦‚æœä½ å¸Œæœ›åœ¨ redis æ„å¤–åœæ­¢å·¥ä½œï¼ˆä¾‹å¦‚ç”µæºä¸­æ–­ï¼‰çš„æƒ…å†µä¸‹ä¸¢å¤±çš„æ•°æ®æœ€å°‘çš„è¯ï¼Œé‚£ä¹ˆå¿«ç…§ä¸é€‚åˆä½ ã€‚ å¿«ç…§éœ€è¦ç»å¸¸ fork å­è¿›ç¨‹æ¥ä¿å­˜æ•°æ®é›†åˆ°ç¡¬ç›˜ä¸Šã€‚å½“æ•°æ®é›†æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œfork çš„è¿‡ç¨‹æ˜¯éå¸¸è€—æ—¶çš„ï¼Œå¯èƒ½ä¼šå¯¼è‡´ Redis åœ¨ä¸€äº›æ¯«ç§’çº§å†…ä¸èƒ½å“åº”å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚ AOF AOF æŒä¹…åŒ–æ–¹å¼è®°å½•æ¯æ¬¡å¯¹æœåŠ¡å™¨æ‰§è¡Œçš„å†™æ“ä½œã€‚å½“æœåŠ¡å™¨é‡å¯çš„æ—¶å€™ä¼šé‡æ–°æ‰§è¡Œè¿™äº›å‘½ä»¤æ¥æ¢å¤åŸå§‹çš„æ•°æ®ã€‚ AOF çš„åŸç† Redis åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ã€‚ å­è¿›ç¨‹å¼€å§‹å°†æ–° AOF æ–‡ä»¶çš„å†…å®¹å†™å…¥åˆ°ä¸´æ—¶æ–‡ä»¶ã€‚ å¯¹äºæ‰€æœ‰æ–°æ‰§è¡Œçš„å†™å…¥å‘½ä»¤ï¼Œçˆ¶è¿›ç¨‹ä¸€è¾¹å°†å®ƒä»¬ç´¯ç§¯åˆ°ä¸€ä¸ªå†…å­˜ç¼“å­˜ä¸­ï¼Œä¸€è¾¹å°†è¿™äº›æ”¹åŠ¨è¿½åŠ åˆ°ç°æœ‰ AOF æ–‡ä»¶çš„æœ«å°¾ï¼Œè¿™æ ·æ ·å³ä½¿åœ¨é‡å†™çš„ä¸­é€”å‘ç”Ÿåœæœºï¼Œç°æœ‰çš„ AOF æ–‡ä»¶ä¹Ÿè¿˜æ˜¯å®‰å…¨çš„ã€‚ å½“å­è¿›ç¨‹å®Œæˆé‡å†™å·¥ä½œæ—¶ï¼Œå®ƒç»™çˆ¶è¿›ç¨‹å‘é€ä¸€ä¸ªä¿¡å·ï¼Œçˆ¶è¿›ç¨‹åœ¨æ¥æ”¶åˆ°ä¿¡å·ä¹‹åï¼Œå°†å†…å­˜ç¼“å­˜ä¸­çš„æ‰€æœ‰æ•°æ®è¿½åŠ åˆ°æ–° AOF æ–‡ä»¶çš„æœ«å°¾ã€‚ æå®šï¼ç°åœ¨ Redis åŸå­åœ°ç”¨æ–°æ–‡ä»¶æ›¿æ¢æ—§æ–‡ä»¶ï¼Œä¹‹åæ‰€æœ‰å‘½ä»¤éƒ½ä¼šç›´æ¥è¿½åŠ åˆ°æ–° AOF æ–‡ä»¶çš„æœ«å°¾ã€‚ AOF çš„ä¼˜ç‚¹ ä½¿ç”¨é»˜è®¤çš„æ¯ç§’ fsync ç­–ç•¥ï¼ŒRedis çš„æ€§èƒ½ä¾ç„¶å¾ˆå¥½(fsync æ˜¯ç”±åå°çº¿ç¨‹è¿›è¡Œå¤„ç†çš„,ä¸»çº¿ç¨‹ä¼šå°½åŠ›å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚)ï¼Œä¸€æ—¦å‡ºç°æ•…éšœï¼Œä½¿ç”¨ AOF ï¼Œä½ æœ€å¤šä¸¢å¤± 1 ç§’çš„æ•°æ®ã€‚ AOF æ–‡ä»¶æ˜¯ä¸€ä¸ªåªè¿›è¡Œè¿½åŠ çš„æ—¥å¿—æ–‡ä»¶ï¼Œæ‰€ä»¥ä¸éœ€è¦å†™å…¥ seekï¼Œå³ä½¿ç”±äºæŸäº›åŸå› (ç£ç›˜ç©ºé—´å·²æ»¡ï¼Œå†™çš„è¿‡ç¨‹ä¸­å®•æœºç­‰ç­‰)æœªæ‰§è¡Œå®Œæ•´çš„å†™å…¥å‘½ä»¤ï¼Œä½ ä¹Ÿä¹Ÿå¯ä½¿ç”¨ redis-check-aof å·¥å…·ä¿®å¤è¿™äº›é—®é¢˜ã€‚ Redis å¯ä»¥åœ¨ AOF æ–‡ä»¶ä½“ç§¯å˜å¾—è¿‡å¤§æ—¶ï¼Œè‡ªåŠ¨åœ°åœ¨åå°å¯¹ AOF è¿›è¡Œé‡å†™ï¼šé‡å†™åçš„æ–° AOF æ–‡ä»¶åŒ…å«äº†æ¢å¤å½“å‰æ•°æ®é›†æ‰€éœ€çš„æœ€å°å‘½ä»¤é›†åˆã€‚æ•´ä¸ªé‡å†™æ“ä½œæ˜¯ç»å¯¹å®‰å…¨çš„ã€‚ AOF æ–‡ä»¶æœ‰åºåœ°ä¿å­˜äº†å¯¹æ•°æ®åº“æ‰§è¡Œçš„æ‰€æœ‰å†™å…¥æ“ä½œï¼Œè¿™äº›å†™å…¥æ“ä½œä»¥ Redis åè®®çš„æ ¼å¼ä¿å­˜ã€‚å› æ­¤ AOF æ–‡ä»¶çš„å†…å®¹éå¸¸å®¹æ˜“è¢«äººè¯»æ‡‚ï¼Œå¯¹æ–‡ä»¶è¿›è¡Œåˆ†æï¼ˆparseï¼‰ä¹Ÿå¾ˆè½»æ¾ã€‚ AOF çš„ç¼ºç‚¹ å¯¹äºç›¸åŒçš„æ•°æ®é›†æ¥è¯´ï¼ŒAOF æ–‡ä»¶çš„ä½“ç§¯é€šå¸¸è¦å¤§äº RDB æ–‡ä»¶çš„ä½“ç§¯ã€‚ æ ¹æ®æ‰€ä½¿ç”¨çš„ fsync ç­–ç•¥ï¼ŒAOF çš„é€Ÿåº¦å¯èƒ½ä¼šæ…¢äºå¿«ç…§ã€‚åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ¯ç§’ fsync çš„æ€§èƒ½ä¾ç„¶éå¸¸é«˜ï¼Œè€Œå…³é—­ fsyncå¯ä»¥è®© AOF çš„é€Ÿåº¦å’Œå¿«ç…§ä¸€æ ·å¿«ï¼Œå³ä½¿åœ¨é«˜è´Ÿè·ä¹‹ä¸‹ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ä¸è¿‡åœ¨å¤„ç†å·¨å¤§çš„å†™å…¥è½½å…¥æ—¶ï¼Œå¿«ç…§å¯ä»¥æä¾›æ›´æœ‰ä¿è¯çš„æœ€å¤§å»¶è¿Ÿæ—¶é—´ï¼ˆlatencyï¼‰ã€‚ 1.7. Redis è¿‡æœŸç­–ç•¥æœ‰å“ªäº›ï¼Ÿ noeviction - å½“å†…å­˜ä½¿ç”¨è¾¾åˆ°é˜ˆå€¼çš„æ—¶å€™ï¼Œæ‰€æœ‰å¼•èµ·ç”³è¯·å†…å­˜çš„å‘½ä»¤ä¼šæŠ¥é”™ã€‚ allkeys-lru - åœ¨ä¸»é”®ç©ºé—´ä¸­ï¼Œä¼˜å…ˆç§»é™¤æœ€è¿‘æœªä½¿ç”¨çš„ keyã€‚ allkeys-random - åœ¨ä¸»é”®ç©ºé—´ä¸­ï¼Œéšæœºç§»é™¤æŸä¸ª keyã€‚ volatile-lru - åœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ç©ºé—´ä¸­ï¼Œä¼˜å…ˆç§»é™¤æœ€è¿‘æœªä½¿ç”¨çš„ keyã€‚ volatile-random - åœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ç©ºé—´ä¸­ï¼Œéšæœºç§»é™¤æŸä¸ª keyã€‚ volatile-ttl - åœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ç©ºé—´ä¸­ï¼Œå…·æœ‰æ›´æ—©è¿‡æœŸæ—¶é—´çš„ key ä¼˜å…ˆç§»é™¤ã€‚ 1.8. Redis å’Œ Memcached æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ ä¸¤è€…éƒ½æ˜¯éå…³ç³»å‹å†…å­˜é”®å€¼æ•°æ®åº“ã€‚æœ‰ä»¥ä¸‹ä¸»è¦ä¸åŒï¼šæ•°æ®ç±»å‹ Memcached ä»…æ”¯æŒå­—ç¬¦ä¸²ç±»å‹ï¼› è€Œ Redis æ”¯æŒäº”ç§ä¸åŒç§ç±»çš„æ•°æ®ç±»å‹ï¼Œä½¿å¾—å®ƒå¯ä»¥æ›´çµæ´»åœ°è§£å†³é—®é¢˜ã€‚ æ•°æ®æŒä¹…åŒ– Memcached ä¸æ”¯æŒæŒä¹…åŒ–ï¼› Redis æ”¯æŒä¸¤ç§æŒä¹…åŒ–ç­–ç•¥ï¼šRDB å¿«ç…§å’Œ AOF æ—¥å¿—ã€‚ åˆ†å¸ƒå¼ Memcached ä¸æ”¯æŒåˆ†å¸ƒå¼ï¼Œåªèƒ½é€šè¿‡åœ¨å®¢æˆ·ç«¯ä½¿ç”¨åƒä¸€è‡´æ€§å“ˆå¸Œè¿™æ ·çš„åˆ†å¸ƒå¼ç®—æ³•æ¥å®ç°åˆ†å¸ƒå¼å­˜å‚¨ï¼Œè¿™ç§æ–¹å¼åœ¨å­˜å‚¨å’ŒæŸ¥è¯¢æ—¶éƒ½éœ€è¦å…ˆåœ¨å®¢æˆ·ç«¯è®¡ç®—ä¸€æ¬¡æ•°æ®æ‰€åœ¨çš„èŠ‚ç‚¹ã€‚ Redis Cluster å®ç°äº†åˆ†å¸ƒå¼çš„æ”¯æŒã€‚ å†…å­˜ç®¡ç†æœºåˆ¶ Memcached å°†å†…å­˜åˆ†å‰²æˆç‰¹å®šé•¿åº¦çš„å—æ¥å­˜å‚¨æ•°æ®ï¼Œä»¥å®Œå…¨è§£å†³å†…å­˜ç¢ç‰‡çš„é—®é¢˜ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼ä¼šä½¿å¾—å†…å­˜çš„åˆ©ç”¨ç‡ä¸é«˜ï¼Œä¾‹å¦‚å—çš„å¤§å°ä¸º 128 bytesï¼Œåªå­˜å‚¨ 100 bytes çš„æ•°æ®ï¼Œé‚£ä¹ˆå‰©ä¸‹çš„ 28 bytes å°±æµªè´¹æ‰äº†ã€‚ åœ¨ Redis ä¸­ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰æ•°æ®éƒ½ä¸€ç›´å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œå¯ä»¥å°†ä¸€äº›å¾ˆä¹…æ²¡ç”¨çš„ value äº¤æ¢åˆ°ç£ç›˜ã€‚è€Œ Memcached çš„æ•°æ®åˆ™ä¼šä¸€ç›´åœ¨å†…å­˜ä¸­ã€‚ 1.9. ä¸ºä»€ä¹ˆå•çº¿ç¨‹çš„ Redis æ€§èƒ½åè€Œä¼˜äºå¤šçº¿ç¨‹çš„ Memcachedï¼Ÿ Redis å¿«é€Ÿçš„åŸå› ï¼š ç»å¤§éƒ¨åˆ†è¯·æ±‚æ˜¯çº¯ç²¹çš„å†…å­˜æ“ä½œï¼ˆéå¸¸å¿«é€Ÿï¼‰ é‡‡ç”¨å•çº¿ç¨‹,é¿å…äº†ä¸å¿…è¦çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œç«äº‰æ¡ä»¶ éé˜»å¡ IO å†…éƒ¨å®ç°é‡‡ç”¨ epollï¼Œé‡‡ç”¨äº† epoll+è‡ªå·±å®ç°çš„ç®€å•çš„äº‹ä»¶æ¡†æ¶ã€‚epoll ä¸­çš„è¯»ã€å†™ã€å…³é—­ã€è¿æ¥éƒ½è½¬åŒ–æˆäº†äº‹ä»¶ï¼Œç„¶ååˆ©ç”¨ epoll çš„å¤šè·¯å¤ç”¨ç‰¹æ€§ï¼Œç»ä¸åœ¨ io ä¸Šæµªè´¹ä¸€ç‚¹æ—¶é—´ã€‚ 2. åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰2.1. ä¸ºä»€ä¹ˆä½¿ç”¨ MQï¼Ÿ å¼‚æ­¥å¤„ç† - ç›¸æ¯”äºä¼ ç»Ÿçš„ä¸²è¡Œã€å¹¶è¡Œæ–¹å¼ï¼Œæé«˜äº†ç³»ç»Ÿååé‡ã€‚ åº”ç”¨è§£è€¦ - ç³»ç»Ÿé—´é€šè¿‡æ¶ˆæ¯é€šä¿¡ï¼Œä¸ç”¨å…³å¿ƒå…¶ä»–ç³»ç»Ÿçš„å¤„ç†ã€‚ æµé‡å‰Šé”‹ - å¯ä»¥é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—é•¿åº¦æ§åˆ¶è¯·æ±‚é‡ï¼›å¯ä»¥ç¼“è§£çŸ­æ—¶é—´å†…çš„é«˜å¹¶å‘è¯·æ±‚ã€‚ æ—¥å¿—å¤„ç† - è§£å†³å¤§é‡æ—¥å¿—ä¼ è¾“ã€‚ æ¶ˆæ¯é€šè®¯ - æ¶ˆæ¯é˜Ÿåˆ—ä¸€èˆ¬éƒ½å†…ç½®äº†é«˜æ•ˆçš„é€šä¿¡æœºåˆ¶ï¼Œå› æ­¤ä¹Ÿå¯ä»¥ç”¨åœ¨çº¯çš„æ¶ˆæ¯é€šè®¯ã€‚æ¯”å¦‚å®ç°ç‚¹å¯¹ç‚¹æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæˆ–è€…èŠå¤©å®¤ç­‰ã€‚ 2.2. å¦‚ä½•ä¿è¯ MQ çš„é«˜å¯ç”¨ï¼Ÿæ•°æ®å¤åˆ¶ å°†æ‰€æœ‰ Broker å’Œå¾…åˆ†é…çš„ Partition æ’åº å°†ç¬¬ i ä¸ª Partition åˆ†é…åˆ°ç¬¬ï¼ˆi mod nï¼‰ä¸ª Broker ä¸Š å°†ç¬¬ i ä¸ª Partition çš„ç¬¬ j ä¸ª Replica åˆ†é…åˆ°ç¬¬ï¼ˆ(i + j) mode nï¼‰ä¸ª Broker ä¸Š é€‰ä¸¾ä¸»æœåŠ¡å™¨2.3. MQ æœ‰å“ªäº›å¸¸è§é—®é¢˜ï¼Ÿå¦‚ä½•è§£å†³è¿™äº›é—®é¢˜ï¼Ÿ MQ çš„å¸¸è§é—®é¢˜æœ‰ï¼š æ¶ˆæ¯çš„é¡ºåºé—®é¢˜ æ¶ˆæ¯çš„é‡å¤é—®é¢˜ æ¶ˆæ¯çš„é¡ºåºé—®é¢˜ æ¶ˆæ¯æœ‰åºæŒ‡çš„æ˜¯å¯ä»¥æŒ‰ç…§æ¶ˆæ¯çš„å‘é€é¡ºåºæ¥æ¶ˆè´¹ã€‚å‡å¦‚ç”Ÿäº§è€…äº§ç”Ÿäº† 2 æ¡æ¶ˆæ¯ï¼šM1ã€M2ï¼Œå‡å®š M1 å‘é€åˆ° S1ï¼ŒM2 å‘é€åˆ° S2ï¼Œå¦‚æœè¦ä¿è¯ M1 å…ˆäº M2 è¢«æ¶ˆè´¹ï¼Œæ€ä¹ˆåšï¼Ÿ è§£å†³æ–¹æ¡ˆï¼šï¼ˆ1ï¼‰ä¿è¯ç”Ÿäº§è€… - MQServer - æ¶ˆè´¹è€…æ˜¯ä¸€å¯¹ä¸€å¯¹ä¸€çš„å…³ç³» ç¼ºé™·ï¼š å¹¶è¡Œåº¦å°±ä¼šæˆä¸ºæ¶ˆæ¯ç³»ç»Ÿçš„ç“¶é¢ˆï¼ˆååé‡ä¸å¤Ÿï¼‰ æ›´å¤šçš„å¼‚å¸¸å¤„ç†ï¼Œæ¯”å¦‚ï¼šåªè¦æ¶ˆè´¹ç«¯å‡ºç°é—®é¢˜ï¼Œå°±ä¼šå¯¼è‡´æ•´ä¸ªå¤„ç†æµç¨‹é˜»å¡ï¼Œæˆ‘ä»¬ä¸å¾—ä¸èŠ±è´¹æ›´å¤šçš„ç²¾åŠ›æ¥è§£å†³é˜»å¡çš„é—®é¢˜ã€‚ ï¼ˆ2ï¼‰é€šè¿‡åˆç†çš„è®¾è®¡æˆ–è€…å°†é—®é¢˜åˆ†è§£æ¥è§„é¿ã€‚ ä¸å…³æ³¨ä¹±åºçš„åº”ç”¨å®é™…å¤§é‡å­˜åœ¨ é˜Ÿåˆ—æ— åºå¹¶ä¸æ„å‘³ç€æ¶ˆæ¯æ— åº æ‰€ä»¥ä»ä¸šåŠ¡å±‚é¢æ¥ä¿è¯æ¶ˆæ¯çš„é¡ºåºè€Œä¸ä»…ä»…æ˜¯ä¾èµ–äºæ¶ˆæ¯ç³»ç»Ÿï¼Œæ˜¯ä¸€ç§æ›´åˆç†çš„æ–¹å¼ã€‚ æ¶ˆæ¯çš„é‡å¤é—®é¢˜ é€ æˆæ¶ˆæ¯é‡å¤çš„æ ¹æœ¬åŸå› æ˜¯ï¼šç½‘ç»œä¸å¯è¾¾ã€‚æ‰€ä»¥è§£å†³è¿™ä¸ªé—®é¢˜çš„åŠæ³•å°±æ˜¯ç»•è¿‡è¿™ä¸ªé—®é¢˜ã€‚é‚£ä¹ˆé—®é¢˜å°±å˜æˆäº†ï¼šå¦‚æœæ¶ˆè´¹ç«¯æ”¶åˆ°ä¸¤æ¡ä¸€æ ·çš„æ¶ˆæ¯ï¼Œåº”è¯¥æ€æ ·å¤„ç†ï¼Ÿæ¶ˆè´¹ç«¯å¤„ç†æ¶ˆæ¯çš„ä¸šåŠ¡é€»è¾‘ä¿æŒå¹‚ç­‰æ€§ã€‚åªè¦ä¿æŒå¹‚ç­‰æ€§ï¼Œä¸ç®¡æ¥å¤šå°‘æ¡é‡å¤æ¶ˆæ¯ï¼Œæœ€åå¤„ç†çš„ç»“æœéƒ½ä¸€æ ·ã€‚ä¿è¯æ¯æ¡æ¶ˆæ¯éƒ½æœ‰å”¯ä¸€ç¼–å·ä¸”ä¿è¯æ¶ˆæ¯å¤„ç†æˆåŠŸä¸å»é‡è¡¨çš„æ—¥å¿—åŒæ—¶å‡ºç°ã€‚åˆ©ç”¨ä¸€å¼ æ—¥å¿—è¡¨æ¥è®°å½•å·²ç»å¤„ç†æˆåŠŸçš„æ¶ˆæ¯çš„ IDï¼Œå¦‚æœæ–°åˆ°çš„æ¶ˆæ¯ IDå·²ç»åœ¨æ—¥å¿—è¡¨ä¸­ï¼Œé‚£ä¹ˆå°±ä¸å†å¤„ç†è¿™æ¡æ¶ˆæ¯ã€‚ 2.4. Kafka, ActiveMQ, RabbitMQ, RocketMQ å„æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ 3. åˆ†å¸ƒå¼æœåŠ¡ï¼ˆRPCï¼‰3.1. Dubbo çš„å®ç°è¿‡ç¨‹ï¼ŸèŠ‚ç‚¹è§’è‰²ï¼š èŠ‚ç‚¹ è§’è‰²è¯´æ˜ Provider æš´éœ²æœåŠ¡çš„æœåŠ¡æä¾›æ–¹ Consumer è°ƒç”¨è¿œç¨‹æœåŠ¡çš„æœåŠ¡æ¶ˆè´¹æ–¹ Registry æœåŠ¡æ³¨å†Œä¸å‘ç°çš„æ³¨å†Œä¸­å¿ƒ Monitor ç»Ÿè®¡æœåŠ¡çš„è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´çš„ç›‘æ§ä¸­å¿ƒ Container æœåŠ¡è¿è¡Œå®¹å™¨ è°ƒç”¨å…³ç³»ï¼š åŠ¡å®¹å™¨è´Ÿè´£å¯åŠ¨ï¼ŒåŠ è½½ï¼Œè¿è¡ŒæœåŠ¡æä¾›è€…ã€‚ æœåŠ¡æä¾›è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±æä¾›çš„æœåŠ¡ã€‚ æœåŠ¡æ¶ˆè´¹è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒè®¢é˜…è‡ªå·±æ‰€éœ€çš„æœåŠ¡ã€‚ æ³¨å†Œä¸­å¿ƒè¿”å›æœåŠ¡æä¾›è€…åœ°å€åˆ—è¡¨ç»™æ¶ˆè´¹è€…ï¼Œå¦‚æœæœ‰å˜æ›´ï¼Œæ³¨å†Œä¸­å¿ƒå°†åŸºäºé•¿è¿æ¥æ¨é€å˜æ›´æ•°æ®ç»™æ¶ˆè´¹è€…ã€‚ æœåŠ¡æ¶ˆè´¹è€…ï¼Œä»æä¾›è€…åœ°å€åˆ—è¡¨ä¸­ï¼ŒåŸºäºè½¯è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œé€‰ä¸€å°æä¾›è€…è¿›è¡Œè°ƒç”¨ï¼Œå¦‚æœè°ƒç”¨å¤±è´¥ï¼Œå†é€‰å¦ä¸€å°è°ƒç”¨ã€‚ æœåŠ¡æ¶ˆè´¹è€…å’Œæä¾›è€…ï¼Œåœ¨å†…å­˜ä¸­ç´¯è®¡è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´ï¼Œå®šæ—¶æ¯åˆ†é’Ÿå‘é€ä¸€æ¬¡ç»Ÿè®¡æ•°æ®åˆ°ç›‘æ§ä¸­å¿ƒã€‚ 3.2. Dubbo è´Ÿè½½å‡è¡¡ç­–ç•¥æœ‰å“ªäº›ï¼ŸRandom éšæœºï¼ŒæŒ‰æƒé‡è®¾ç½®éšæœºæ¦‚ç‡ã€‚ åœ¨ä¸€ä¸ªæˆªé¢ä¸Šç¢°æ’çš„æ¦‚ç‡é«˜ï¼Œä½†è°ƒç”¨é‡è¶Šå¤§åˆ†å¸ƒè¶Šå‡åŒ€ï¼Œè€Œä¸”æŒ‰æ¦‚ç‡ä½¿ç”¨æƒé‡åä¹Ÿæ¯”è¾ƒå‡åŒ€ï¼Œæœ‰åˆ©äºåŠ¨æ€è°ƒæ•´æä¾›è€…æƒé‡ã€‚ RoundRobin è½®å¾ªï¼ŒæŒ‰å…¬çº¦åçš„æƒé‡è®¾ç½®è½®å¾ªæ¯”ç‡ã€‚ å­˜åœ¨æ…¢çš„æä¾›è€…ç´¯ç§¯è¯·æ±‚çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼šç¬¬äºŒå°æœºå™¨å¾ˆæ…¢ï¼Œä½†æ²¡æŒ‚ï¼Œå½“è¯·æ±‚è°ƒåˆ°ç¬¬äºŒå°æ—¶å°±å¡åœ¨é‚£ï¼Œä¹…è€Œä¹…ä¹‹ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½å¡åœ¨è°ƒåˆ°ç¬¬äºŒå°ä¸Šã€‚ LeastActive æœ€å°‘æ´»è·ƒè°ƒç”¨æ•°ï¼Œç›¸åŒæ´»è·ƒæ•°çš„éšæœºï¼Œæ´»è·ƒæ•°æŒ‡è°ƒç”¨å‰åè®¡æ•°å·®ã€‚ ä½¿æ…¢çš„æä¾›è€…æ”¶åˆ°æ›´å°‘è¯·æ±‚ï¼Œå› ä¸ºè¶Šæ…¢çš„æä¾›è€…çš„è°ƒç”¨å‰åè®¡æ•°å·®ä¼šè¶Šå¤§ã€‚ ConsistentHash ä¸€è‡´æ€§ Hashï¼Œç›¸åŒå‚æ•°çš„è¯·æ±‚æ€»æ˜¯å‘åˆ°åŒä¸€æä¾›è€…ã€‚ å½“æŸä¸€å°æä¾›è€…æŒ‚æ—¶ï¼ŒåŸæœ¬å‘å¾€è¯¥æä¾›è€…çš„è¯·æ±‚ï¼ŒåŸºäºè™šæ‹ŸèŠ‚ç‚¹ï¼Œå¹³æ‘Šåˆ°å…¶å®ƒæä¾›è€…ï¼Œä¸ä¼šå¼•èµ·å‰§çƒˆå˜åŠ¨ã€‚ ç¼ºçœåªå¯¹ç¬¬ä¸€ä¸ªå‚æ•° Hashï¼Œå¦‚æœè¦ä¿®æ”¹ï¼Œè¯·é…ç½® &lt;dubbo:parameter key=&quot;hash.arguments&quot; value=&quot;0,1&quot; /&gt; ç¼ºçœç”¨ 160 ä»½è™šæ‹ŸèŠ‚ç‚¹ï¼Œå¦‚æœè¦ä¿®æ”¹ï¼Œè¯·é…ç½® &lt;dubbo:parameter key=&quot;hash.nodes&quot; value=&quot;320&quot; /&gt; 3.3. Dubbo é›†ç¾¤å®¹é”™ç­–ç•¥ ï¼Ÿ Failover - å¤±è´¥è‡ªåŠ¨åˆ‡æ¢ï¼Œå½“å‡ºç°å¤±è´¥ï¼Œé‡è¯•å…¶å®ƒæœåŠ¡å™¨ã€‚é€šå¸¸ç”¨äºè¯»æ“ä½œï¼Œä½†é‡è¯•ä¼šå¸¦æ¥æ›´é•¿å»¶è¿Ÿã€‚å¯é€šè¿‡ retries=â€2â€ æ¥è®¾ç½®é‡è¯•æ¬¡æ•°(ä¸å«ç¬¬ä¸€æ¬¡)ã€‚ Failfast - å¿«é€Ÿå¤±è´¥ï¼Œåªå‘èµ·ä¸€æ¬¡è°ƒç”¨ï¼Œå¤±è´¥ç«‹å³æŠ¥é”™ã€‚é€šå¸¸ç”¨äºéå¹‚ç­‰æ€§çš„å†™æ“ä½œï¼Œæ¯”å¦‚æ–°å¢è®°å½•ã€‚ Failsafe - å¤±è´¥å®‰å…¨ï¼Œå‡ºç°å¼‚å¸¸æ—¶ï¼Œç›´æ¥å¿½ç•¥ã€‚é€šå¸¸ç”¨äºå†™å…¥å®¡è®¡æ—¥å¿—ç­‰æ“ä½œã€‚ Failback - å¤±è´¥è‡ªåŠ¨æ¢å¤ï¼Œåå°è®°å½•å¤±è´¥è¯·æ±‚ï¼Œå®šæ—¶é‡å‘ã€‚é€šå¸¸ç”¨äºæ¶ˆæ¯é€šçŸ¥æ“ä½œã€‚ Forking - å¹¶è¡Œè°ƒç”¨å¤šä¸ªæœåŠ¡å™¨ï¼Œåªè¦ä¸€ä¸ªæˆåŠŸå³è¿”å›ã€‚é€šå¸¸ç”¨äºå®æ—¶æ€§è¦æ±‚è¾ƒé«˜çš„è¯»æ“ä½œï¼Œä½†éœ€è¦æµªè´¹æ›´å¤šæœåŠ¡èµ„æºã€‚å¯é€šè¿‡ forks=â€2â€ æ¥è®¾ç½®æœ€å¤§å¹¶è¡Œæ•°ã€‚ Broadcast - æ’­è°ƒç”¨æ‰€æœ‰æä¾›è€…ï¼Œé€ä¸ªè°ƒç”¨ï¼Œä»»æ„ä¸€å°æŠ¥é”™åˆ™æŠ¥é”™ã€‚é€šå¸¸ç”¨äºé€šçŸ¥æ‰€æœ‰æä¾›è€…æ›´æ–°ç¼“å­˜æˆ–æ—¥å¿—ç­‰æœ¬åœ°èµ„æºä¿¡æ¯ã€‚ 3.4. åŠ¨æ€ä»£ç†ç­–ç•¥ï¼Ÿ Dubbo ä½œä¸º RPC æ¡†æ¶ï¼Œé¦–å…ˆè¦å®Œæˆçš„å°±æ˜¯è·¨ç³»ç»Ÿï¼Œè·¨ç½‘ç»œçš„æœåŠ¡è°ƒç”¨ã€‚æ¶ˆè´¹æ–¹ä¸æä¾›æ–¹éµå¾ªç»Ÿä¸€çš„æ¥å£å®šä¹‰ï¼Œæ¶ˆè´¹æ–¹è°ƒç”¨æ¥å£æ—¶ï¼ŒDubboå°†å…¶è½¬æ¢æˆç»Ÿä¸€æ ¼å¼çš„æ•°æ®ç»“æ„ï¼Œé€šè¿‡ç½‘ç»œä¼ è¾“ï¼Œæä¾›æ–¹æ ¹æ®è§„åˆ™æ‰¾åˆ°æ¥å£å®ç°ï¼Œé€šè¿‡åå°„å®Œæˆè°ƒç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¶ˆè´¹æ–¹è·å–çš„æ˜¯å¯¹è¿œç¨‹æœåŠ¡çš„ä¸€ä¸ªä»£ç†(Proxy)ï¼Œè€Œæä¾›æ–¹å› ä¸ºè¦æ”¯æŒä¸åŒçš„æ¥å£å®ç°ï¼Œéœ€è¦ä¸€ä¸ªåŒ…è£…å±‚(Wrapper)ã€‚è°ƒç”¨çš„è¿‡ç¨‹å¤§æ¦‚æ˜¯è¿™æ ·ï¼š æ¶ˆè´¹æ–¹çš„ Proxy å’Œæä¾›æ–¹çš„ Wrapper å¾—ä»¥è®© Dubbo æ„å»ºå‡ºå¤æ‚ã€ç»Ÿä¸€çš„ä½“ç³»ã€‚è€Œè¿™ç§åŠ¨æ€ä»£ç†ä¸åŒ…è£…ä¹Ÿæ˜¯é€šè¿‡åŸºäº SPI çš„æ’ä»¶æ–¹å¼å®ç°çš„ï¼Œå®ƒçš„æ¥å£å°±æ˜¯ProxyFactoryã€‚ 1234567@SPI(\"javassist\")public interface ProxyFactory { @Adaptive({Constants.PROXY_KEY}) &lt;T&gt; T getProxy(Invoker&lt;T&gt; invoker) throws RpcException; @Adaptive({Constants.PROXY_KEY}) &lt;T&gt; Invoker&lt;T&gt; getInvoker(T proxy, Class&lt;T&gt; type, URL url) throws RpcException;} ProxyFactory æœ‰ä¸¤ç§å®ç°æ–¹å¼ï¼Œä¸€ç§æ˜¯åŸºäº JDK çš„ä»£ç†å®ç°ï¼Œä¸€ç§æ˜¯åŸºäº javassist çš„å®ç°ã€‚ProxyFactory æ¥å£ä¸Šå®šä¹‰äº†@SPI(â€œjavassistâ€)ï¼Œé»˜è®¤ä¸º javassist çš„å®ç°ã€‚ 3.5. Dubbo æ”¯æŒå“ªäº›åºåˆ—åŒ–åè®®ï¼ŸHessianï¼ŸHessian çš„æ•°æ®ç»“æ„ï¼Ÿ dubbo åºåˆ—åŒ–ï¼Œé˜¿é‡Œå°šä¸æˆç†Ÿçš„ java åºåˆ—åŒ–å®ç°ã€‚ hessian2 åºåˆ—åŒ–ï¼šhessian æ˜¯ä¸€ç§è·¨è¯­è¨€çš„é«˜æ•ˆäºŒè¿›åˆ¶çš„åºåˆ—åŒ–æ–¹å¼ï¼Œä½†è¿™é‡Œå®é™…ä¸æ˜¯åŸç”Ÿçš„ hessian2 åºåˆ—åŒ–ï¼Œè€Œæ˜¯é˜¿é‡Œä¿®æ”¹è¿‡çš„ hessian liteï¼Œå®ƒæ˜¯ dubbo RPC é»˜è®¤å¯ç”¨çš„åºåˆ—åŒ–æ–¹å¼ã€‚ json åºåˆ—åŒ–ï¼šç›®å‰æœ‰ä¸¤ç§å®ç°ï¼Œä¸€ç§æ˜¯é‡‡ç”¨çš„é˜¿é‡Œçš„ fastjson åº“ï¼Œå¦ä¸€ç§æ˜¯é‡‡ç”¨ dubbo ä¸­è‡ªå·²å®ç°çš„ç®€å• json åº“ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œjson è¿™ç§æ–‡æœ¬åºåˆ—åŒ–æ€§èƒ½ä¸å¦‚äºŒè¿›åˆ¶åºåˆ—åŒ–ã€‚ java åºåˆ—åŒ–ï¼šä¸»è¦æ˜¯é‡‡ç”¨ JDK è‡ªå¸¦çš„ java åºåˆ—åŒ–å®ç°ï¼Œæ€§èƒ½å¾ˆä¸ç†æƒ³ã€‚ Kryo å’Œ FSTï¼šKryo å’Œ FST çš„æ€§èƒ½ä¾ç„¶æ™®éä¼˜äº hessian å’Œ dubbo åºåˆ—åŒ–ã€‚ Hessian åºåˆ—åŒ–ä¸ Java é»˜è®¤çš„åºåˆ—åŒ–åŒºåˆ«ï¼ŸHessian æ˜¯ä¸€ä¸ªè½»é‡çº§çš„ remoting on http å·¥å…·ï¼Œé‡‡ç”¨çš„æ˜¯ Binary RPC åè®®ï¼Œæ‰€ä»¥å®ƒå¾ˆé€‚åˆäºå‘é€äºŒè¿›åˆ¶æ•°æ®ï¼ŒåŒæ—¶åˆå…·æœ‰é˜²ç«å¢™ç©¿é€èƒ½åŠ›ã€‚ Hessian æ”¯æŒè·¨è¯­è¨€ä¸²è¡Œ æ¯” java åºåˆ—åŒ–å…·æœ‰æ›´å¥½çš„æ€§èƒ½å’Œæ˜“ç”¨æ€§ æ”¯æŒçš„è¯­è¨€æ¯”è¾ƒå¤š 3.6. Protoco Buffer æ˜¯ä»€ä¹ˆï¼Ÿ Protocol Buffer æ˜¯ Google å‡ºå“çš„ä¸€ç§è½»é‡ &amp; é«˜æ•ˆçš„ç»“æ„åŒ–æ•°æ®å­˜å‚¨æ ¼å¼ï¼Œæ€§èƒ½æ¯” Jsonã€XML çœŸçš„å¼ºï¼å¤ªï¼å¤šï¼Protocol Buffer çš„åºåˆ—åŒ– &amp; ååºåˆ—åŒ–ç®€å• &amp; é€Ÿåº¦å¿«çš„åŸå› æ˜¯ï¼š ç¼–ç  / è§£ç  æ–¹å¼ç®€å•ï¼ˆåªéœ€è¦ç®€å•çš„æ•°å­¦è¿ç®— = ä½ç§»ç­‰ç­‰ï¼‰ é‡‡ç”¨ Protocol Buffer è‡ªèº«çš„æ¡†æ¶ä»£ç  å’Œ ç¼–è¯‘å™¨ å…±åŒå®Œæˆ Protocol Buffer çš„æ•°æ®å‹ç¼©æ•ˆæœå¥½ï¼ˆå³åºåˆ—åŒ–åçš„æ•°æ®é‡ä½“ç§¯å°ï¼‰çš„åŸå› æ˜¯ï¼š é‡‡ç”¨äº†ç‹¬ç‰¹çš„ç¼–ç æ–¹å¼ï¼Œå¦‚ Varintã€Zigzag ç¼–ç æ–¹å¼ç­‰ç­‰ é‡‡ç”¨ T - L - V çš„æ•°æ®å­˜å‚¨æ–¹å¼ï¼šå‡å°‘äº†åˆ†éš”ç¬¦çš„ä½¿ç”¨ &amp; æ•°æ®å­˜å‚¨å¾—ç´§å‡‘ 3.7. æ³¨å†Œä¸­å¿ƒæŒ‚äº†å¯ä»¥ç»§ç»­é€šä¿¡å—ï¼Ÿ å¯ä»¥ã€‚Dubbo æ¶ˆè´¹è€…åœ¨åº”ç”¨å¯åŠ¨æ—¶ä¼šä»æ³¨å†Œä¸­å¿ƒæ‹‰å–å·²æ³¨å†Œçš„ç”Ÿäº§è€…çš„åœ°å€æ¥å£ï¼Œå¹¶ç¼“å­˜åœ¨æœ¬åœ°ã€‚æ¯æ¬¡è°ƒç”¨æ—¶ï¼ŒæŒ‰ç…§æœ¬åœ°å­˜å‚¨çš„åœ°å€è¿›è¡Œè°ƒç”¨ã€‚ 3.8. ZooKeeper åŸç†æ˜¯ä»€ä¹ˆï¼ŸZooKeeper æœ‰ä»€ä¹ˆç”¨ï¼Ÿ ZooKeeper æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼åº”ç”¨åè°ƒç³»ç»Ÿï¼Œå·²ç»ç”¨åˆ°äº†è®¸å¤šåˆ†å¸ƒå¼é¡¹ç›®ä¸­ï¼Œç”¨æ¥å®Œæˆç»Ÿä¸€å‘½åæœåŠ¡ã€çŠ¶æ€åŒæ­¥æœåŠ¡ã€é›†ç¾¤ç®¡ç†ã€åˆ†å¸ƒå¼åº”ç”¨é…ç½®é¡¹çš„ç®¡ç†ç­‰å·¥ä½œã€‚ æ¯ä¸ª Server åœ¨å†…å­˜ä¸­å­˜å‚¨äº†ä¸€ä»½æ•°æ®ï¼› Zookeeper å¯åŠ¨æ—¶ï¼Œå°†ä»å®ä¾‹ä¸­é€‰ä¸¾ä¸€ä¸ª leaderï¼ˆPaxos åè®®ï¼‰ï¼› Leader è´Ÿè´£å¤„ç†æ•°æ®æ›´æ–°ç­‰æ“ä½œï¼ˆZab åè®®ï¼‰ï¼› ä¸€ä¸ªæ›´æ–°æ“ä½œæˆåŠŸï¼Œå½“ä¸”ä»…å½“å¤§å¤šæ•° Server åœ¨å†…å­˜ä¸­æˆåŠŸä¿®æ”¹æ•°æ®ã€‚ 3.9. Netty æœ‰ä»€ä¹ˆç”¨ï¼ŸNIO/BIO/AIO æœ‰ä»€ä¹ˆç”¨ï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ Netty æ˜¯ä¸€ä¸ªâ€œç½‘ç»œé€šè®¯æ¡†æ¶â€ã€‚Netty è¿›è¡Œäº‹ä»¶å¤„ç†çš„æµç¨‹ã€‚Channelæ˜¯è¿æ¥çš„é€šé“ï¼Œæ˜¯ ChannelEvent çš„äº§ç”Ÿè€…ï¼Œè€ŒChannelPipelineå¯ä»¥ç†è§£ä¸º ChannelHandler çš„é›†åˆã€‚ IO çš„æ–¹å¼é€šå¸¸åˆ†ä¸ºå‡ ç§ï¼š åŒæ­¥é˜»å¡çš„ BIO åŒæ­¥éé˜»å¡çš„ NIO å¼‚æ­¥éé˜»å¡çš„ AIO åœ¨ä½¿ç”¨åŒæ­¥ I/O çš„ç½‘ç»œåº”ç”¨ä¸­ï¼Œå¦‚æœè¦åŒæ—¶å¤„ç†å¤šä¸ªå®¢æˆ·ç«¯è¯·æ±‚ï¼Œæˆ–æ˜¯åœ¨å®¢æˆ·ç«¯è¦åŒæ—¶å’Œå¤šä¸ªæœåŠ¡å™¨è¿›è¡Œé€šè®¯ï¼Œå°±å¿…é¡»ä½¿ç”¨å¤šçº¿ç¨‹æ¥å¤„ç†ã€‚NIO åŸºäº Reactorï¼Œå½“ socket æœ‰æµå¯è¯»æˆ–å¯å†™å…¥ socketæ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šç›¸åº”çš„é€šçŸ¥å¼•ç”¨ç¨‹åºè¿›è¡Œå¤„ç†ï¼Œåº”ç”¨å†å°†æµè¯»å–åˆ°ç¼“å†²åŒºæˆ–å†™å…¥æ“ä½œç³»ç»Ÿã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå·²ç»ä¸æ˜¯ä¸€ä¸ªè¿æ¥å°±è¦å¯¹åº”ä¸€ä¸ªå¤„ç†çº¿ç¨‹äº†ï¼Œè€Œæ˜¯æœ‰æ•ˆçš„è¯·æ±‚ï¼Œå¯¹åº”ä¸€ä¸ªçº¿ç¨‹ï¼Œå½“è¿æ¥æ²¡æœ‰æ•°æ®æ—¶ï¼Œæ˜¯æ²¡æœ‰å·¥ä½œçº¿ç¨‹æ¥å¤„ç†çš„ã€‚ä¸ NIO ä¸åŒï¼Œå½“è¿›è¡Œè¯»å†™æ“ä½œæ—¶ï¼Œåªé¡»ç›´æ¥è°ƒç”¨ API çš„ read æˆ– writeæ–¹æ³•å³å¯ã€‚è¿™ä¸¤ç§æ–¹æ³•å‡ä¸ºå¼‚æ­¥çš„ï¼Œå¯¹äºè¯»æ“ä½œè€Œè¨€ï¼Œå½“æœ‰æµå¯è¯»å–æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šå°†å¯è¯»çš„æµä¼ å…¥ readæ–¹æ³•çš„ç¼“å†²åŒºï¼Œå¹¶é€šçŸ¥åº”ç”¨ç¨‹åºï¼›å¯¹äºå†™æ“ä½œè€Œè¨€ï¼Œå½“æ“ä½œç³»ç»Ÿå°† write æ–¹æ³•ä¼ é€’çš„æµå†™å…¥å®Œæ¯•æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¸»åŠ¨é€šçŸ¥åº”ç”¨ç¨‹åºã€‚å³å¯ä»¥ç†è§£ä¸ºï¼Œread/write æ–¹æ³•éƒ½æ˜¯å¼‚æ­¥çš„ï¼Œå®Œæˆåä¼šä¸»åŠ¨è°ƒç”¨å›è°ƒå‡½æ•°ã€‚ 3.10. ä¸ºä»€ä¹ˆè¦è¿›è¡Œç³»ç»Ÿæ‹†åˆ†ï¼Ÿæ‹†åˆ†ä¸ç”¨ Dubbo å¯ä»¥å—ï¼Ÿ ç³»ç»Ÿæ‹†åˆ†ä»èµ„æºè§’åº¦åˆ†ä¸ºï¼šåº”ç”¨æ‹†åˆ†å’Œæ•°æ®åº“æ‹†åˆ†ã€‚ä»é‡‡ç”¨çš„å…ˆåé¡ºåºå¯åˆ†ä¸ºï¼šæ°´å¹³æ‰©å±•ã€å‚ç›´æ‹†åˆ†ã€ä¸šåŠ¡æ‹†åˆ†ã€æ°´å¹³æ‹†åˆ†ã€‚ æ˜¯å¦ä½¿ç”¨æœåŠ¡ä¾æ®å®é™…ä¸šåŠ¡åœºæ™¯æ¥å†³å®šã€‚å½“å‚ç›´åº”ç”¨è¶Šæ¥è¶Šå¤šï¼Œåº”ç”¨ä¹‹é—´äº¤äº’ä¸å¯é¿å…ï¼Œå°†æ ¸å¿ƒä¸šåŠ¡æŠ½å–å‡ºæ¥ï¼Œä½œä¸ºç‹¬ç«‹çš„æœåŠ¡ï¼Œé€æ¸å½¢æˆç¨³å®šçš„æœåŠ¡ä¸­å¿ƒï¼Œä½¿å‰ç«¯åº”ç”¨èƒ½æ›´å¿«é€Ÿçš„å“åº”å¤šå˜çš„å¸‚åœºéœ€æ±‚ã€‚æ­¤æ—¶ï¼Œç”¨äºæé«˜ä¸šåŠ¡å¤ç”¨åŠæ•´åˆçš„åˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶(RPC)æ˜¯å…³é”®ã€‚å½“æœåŠ¡è¶Šæ¥è¶Šå¤šï¼Œå®¹é‡çš„è¯„ä¼°ï¼Œå°æœåŠ¡èµ„æºçš„æµªè´¹ç­‰é—®é¢˜é€æ¸æ˜¾ç°ï¼Œæ­¤æ—¶éœ€å¢åŠ ä¸€ä¸ªè°ƒåº¦ä¸­å¿ƒåŸºäºè®¿é—®å‹åŠ›å®æ—¶ç®¡ç†é›†ç¾¤å®¹é‡ï¼Œæé«˜é›†ç¾¤åˆ©ç”¨ç‡ã€‚æ­¤æ—¶ï¼Œç”¨äºæé«˜æœºå™¨åˆ©ç”¨ç‡çš„èµ„æºè°ƒåº¦å’Œæ²»ç†ä¸­å¿ƒ(SOA)æ˜¯å…³é”®ã€‚ 3.11. Dubbo å’Œ Thrift æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ Thrift æ˜¯è·¨è¯­è¨€çš„ RPC æ¡†æ¶ã€‚ Dubbo æ”¯æŒæœåŠ¡æ²»ç†ï¼Œè€Œ Thrift ä¸æ”¯æŒã€‚ è½¬è½½é¢è¯•","link":"/2020/04/21/idl9gm/"}],"tags":[{"name":"æµ‹è¯•","slug":"æµ‹è¯•","link":"/tags/%E6%B5%8B%E8%AF%95/"},{"name":"hexo","slug":"hexo","link":"/tags/hexo/"},{"name":"Java","slug":"Java","link":"/tags/Java/"},{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","link":"/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"},{"name":"linux","slug":"linux","link":"/tags/linux/"},{"name":"å®ç”¨","slug":"å®ç”¨","link":"/tags/%E5%AE%9E%E7%94%A8/"},{"name":"é¢è¯•","slug":"é¢è¯•","link":"/tags/%E9%9D%A2%E8%AF%95/"},{"name":"JavaåŸºç¡€","slug":"JavaåŸºç¡€","link":"/tags/Java%E5%9F%BA%E7%A1%80/"},{"name":"åˆ†å¸ƒå¼","slug":"åˆ†å¸ƒå¼","link":"/tags/%E5%88%86%E5%B8%83%E5%BC%8F/"}],"categories":[{"name":"æµ‹è¯•","slug":"æµ‹è¯•","link":"/categories/%E6%B5%8B%E8%AF%95/"},{"name":"hexo","slug":"hexo","link":"/categories/hexo/"},{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","link":"/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"},{"name":"linux","slug":"linux","link":"/categories/linux/"},{"name":"é¢è¯•","slug":"é¢è¯•","link":"/categories/%E9%9D%A2%E8%AF%95/"},{"name":"JavaåŸºç¡€","slug":"é¢è¯•/JavaåŸºç¡€","link":"/categories/%E9%9D%A2%E8%AF%95/Java%E5%9F%BA%E7%A1%80/"}]}